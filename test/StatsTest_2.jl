@testset "Mean Estimation Weighted" begin
    portfolio = Portfolio(; prices = prices)
    w = eweights(size(portfolio.returns, 1), 1 / size(portfolio.returns, 1); scale = true)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false, mu_type = MuSimple(; w = w))
    mut = mut = [0.0007326728069048121, 0.0008323896049466663, 0.0009245929044292375,
                 0.0011114816832861242, 0.0018085925410211395, -0.000980457436093435,
                 0.0018949745543516653, 0.0003924001711430871, 0.0009993244353928084,
                 0.0004970215768563208, 0.00020941551970085113, -0.0005894040513829562,
                 -0.0016679260173703763, -2.254886106930358e-5, -0.00125601942940821,
                 0.0013473601314726471, 0.001110328217995599, 0.0003746667861093509,
                 0.0009665136651636659, 0.0005177525977811118]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false, mu_type = MuJS(; w = w))
    mut = [0.0006665834087073769, 0.0007421173424579136, 0.0008119599171440185,
           0.0009535252794310195, 0.0014815759828123638, -0.0006310862800682068,
           0.0015470090231854338, 0.00040883214481341666, 0.0008685678971406212,
           0.00048808124309186843, 0.0002702240987186995, -0.00033486938348026616,
           -0.0011518331080194273, 9.451466446447298e-5, -0.0008398202321799435,
           0.001132199559275244, 0.0009526515472961239, 0.0003953993796563488,
           0.0008437142456650503, 0.000503784671118678]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false, mu_type = MuBS(; w = w))
    mut = [0.000629216804834491, 0.0006910778722080954, 0.000748277808762074,
           0.0008642175457699145, 0.0012966825123958631, -0.0004335536356823861,
           0.0013502711118238587, 0.0004181226977271323, 0.0007946388267916507,
           0.0004830264246281009, 0.0003046049547441247, -0.00019095679890773084,
           -0.0008600368467233082, 0.00016070177625381643, -0.0006045033589867292,
           0.0010105488847397355, 0.0008635019733142051, 0.0004071214808020403,
           0.0007742840890986804, 0.0004958872776371779]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false, mu_type = MuBOP(; w = w))
    mut = [0.0003266956329864569, 0.00036906840586197793, 0.0004082484592137591,
           0.00048766332145354433, 0.0007838874343805082, -0.00040126675768600135,
           0.0008205938419593825, 0.00018210319325694745, 0.0004400042140147731,
           0.00022656008667167464, 0.00010434731633825779, -0.0002350959963105115,
           -0.000693393567065478, 5.7784270979602575e-6, -0.0005183616302164239,
           0.0005878954198312194, 0.000487173178130303, 0.00017456772570178912,
           0.0004260618959490966, 0.0002353693430695299]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false,
                      mu_type = MuJS(; w = w, target = VW()))
    mut = [0.0006314353150731434, 0.0007076310010797242, 0.0007780854660656126,
           0.0009208910814841465, 0.001453568033319891, -0.0006776032486108119,
           0.001519574332094009, 0.00037142589419052, 0.0008351893881721094,
           0.0004513692932550054, 0.0002316035039903845, -0.00037879119789992026,
           -0.001202912335815768, 5.435468063310978e-5, -0.0008881659173915241,
           0.0011011307254225333, 0.0009200096945882351, 0.0003578754446735066,
           0.0008101179940328345, 0.00046721029890300285]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false,
                      mu_type = MuBS(; w = w, target = VW()))
    mut = [0.0005686694236730382, 0.0006302823346927553, 0.0006872528130705259,
           0.0008027274565449368, 0.0012334575851886411, -0.0004898377015029457,
           0.0012868312133591303, 0.000358422122903994, 0.000733427853365072,
           0.00042306548778883106, 0.0002453597575986791, -0.0002482140446140337,
           -0.0009146100704401112, 0.00010203384829564958, -0.0006601016581072567,
           0.0009484717857349412, 0.0008020147546160238, 0.00034746503748190325,
           0.0007131547689268008, 0.00043587474934425044]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false,
                      mu_type = MuBOP(; w = w, target = VW()))
    mut = [0.0003180165581460064, 0.00036038933102152743, 0.0003995693843733086,
           0.00047898424661309383, 0.0007752083595400576, -0.00040994583252645163,
           0.0008119147671189319, 0.00017342411841649697, 0.0004313251391743226,
           0.00021788101183122413, 9.566824149780734e-5, -0.0002437750711509619,
           -0.0007020726419059282, -2.9006477424901767e-6, -0.0005270407050568742,
           0.0005792163449907689, 0.00047849410328985246, 0.00016588865086133864,
           0.0004173828211086461, 0.0002266902682290794]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false,
                      mu_type = MuJS(; w = w, target = SE()))
    mut = [0.0005904457073162215, 0.0006705376321945927, 0.0007445947607898815,
           0.0008947026897521978, 0.0014546178850453212, -0.0007855300703204707,
           0.0015239993920568781, 0.00031714079864722804, 0.0008046186713196574,
           0.0004011720745365405, 0.00017016864104690986, -0.0004714383733676827,
           -0.0013377006478871765, -1.614373684656359e-5, -0.0010068597850856561,
           0.001084158822756511, 0.0008937762334558397, 0.0003028974517904117,
           0.0007782652605002389, 0.00041782310428444106]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false,
                      mu_type = MuBS(; w = w, target = SE()))
    mut = [0.0004627320477087477, 0.0005252017024410575, 0.0005829643702860314,
           0.000700044719011553, 0.0011367642632409232, -0.0006104938970980581,
           0.0011908800657316405, 0.0002495612029934384, 0.0006297814866454205,
           0.0003151034508479212, 0.00013492667579862624, -0.00036551039978889734,
           -0.0010411728374071485, -1.0392217923005218e-5, -0.0007831254187449495,
           0.0008478156613839732, 0.0006993221067751015, 0.00023845175642027796,
           0.000609226499642575, 0.0003280908285500853]
    @test isapprox(portfolio.mu, mut)

    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_cov = false,
                      set_skew = false, set_sskew = false,
                      mu_type = MuBOP(; w = w, target = SE()))
    mut = [0.00031134274162377795, 0.00035371551449929896, 0.0003928955678510801,
           0.00047231043009086536, 0.0007685345430178291, -0.0004166196490486801,
           0.0008052409505967035, 0.00016675030189426855, 0.0004246513226520941,
           0.00021120719530899571, 8.89944249755789e-5, -0.00025044888767319034,
           -0.0007087464584281567, -9.57446426471861e-6, -0.0005337145215791026,
           0.0005725425284685405, 0.000471820286767624, 0.00015921483433911022,
           0.0004107090045864176, 0.00022001645170685098]
    @test isapprox(portfolio.mu, mut)
end

@testset "Covariance Estimation" begin
    portfolio = Portfolio(; prices = prices)
    rf = 0.0329 / 252
    c0 = StatsBase.SimpleCovariance(; corrected = true)
    c1 = PortCovCor(; ce = CovFull(; ce = c0))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    @test isapprox(portfolio.cov, cov(c0, portfolio.returns))

    c1 = PortCovCor(; ce = CovSemi(; ce = c0, target = rf))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([9.545295056047611e-5, 6.307911400573214e-5, 8.177683662479986e-5,
                    8.020035699829136e-5, 8.278661505889809e-5, 4.928756573379555e-5,
                    0.00011306987183854583, 3.8119305639128846e-5, 6.837682872000733e-5,
                    6.215263922623088e-5, 3.470328960279329e-5, 6.733035863603471e-5,
                    8.079833062068485e-5, 4.332703277378487e-5, 7.184050539788664e-5,
                    5.749345733565443e-5, 6.240915771333988e-5, 4.290107451946107e-5,
                    5.868221017101273e-5, 5.409682290215357e-5, 6.307911400573214e-5,
                    0.00010585016777349891, 7.282772262662211e-5, 7.6313002367083e-5,
                    7.179810171302329e-5, 4.611901376770728e-5, 0.00012019979975135411,
                    3.603800709172367e-5, 6.75432397505338e-5, 6.011999281651871e-5,
                    3.363995455570329e-5, 7.01619622187316e-5, 9.362073746347488e-5,
                    4.400413609796305e-5, 8.267716233803994e-5, 6.454219282905186e-5,
                    5.979601009534833e-5, 3.551750064837961e-5, 5.6506380291512315e-5,
                    4.788471614250951e-5, 8.177683662479986e-5, 7.282772262662211e-5,
                    0.0001267420996865626, 9.494540994507259e-5, 9.256107782238131e-5,
                    5.460943391306912e-5, 0.000131109874662877, 3.832131387809981e-5,
                    7.509616053278322e-5, 6.825341019755814e-5, 3.606104303932644e-5,
                    8.138744841748734e-5, 9.769641160342731e-5, 4.106407042409599e-5,
                    7.929388309514714e-5, 6.727105903617332e-5, 6.994749627290017e-5,
                    4.608296863761943e-5, 6.185600873777587e-5, 6.045328596035443e-5,
                    8.020035699829136e-5, 7.6313002367083e-5, 9.494540994507259e-5,
                    0.00019003484766033754, 9.74993603491374e-5, 6.256432199246906e-5,
                    0.00017521302711765013, 4.44360010695098e-5, 8.876816740758091e-5,
                    8.184944754509676e-5, 4.318615316800234e-5, 9.227037596079407e-5,
                    0.0001320798986028135, 5.398828081107398e-5, 0.00012434597447963375,
                    7.81022147260696e-5, 7.469226272921367e-5, 4.852720713504898e-5,
                    7.39420588845595e-5, 6.033782407377706e-5, 8.278661505889809e-5,
                    7.179810171302329e-5, 9.256107782238131e-5, 9.74993603491374e-5,
                    0.0001410647652857005, 5.231251746714465e-5, 0.00014104595686848445,
                    4.20293528507549e-5, 7.898070705376363e-5, 6.800929601554662e-5,
                    3.686284738171411e-5, 8.343696278035115e-5, 0.00010140859789357756,
                    4.50101633593726e-5, 9.439074583564873e-5, 6.669675039410489e-5,
                    7.251471100216702e-5, 4.401365451191604e-5, 6.471675590786307e-5,
                    6.547465905905916e-5, 4.928756573379555e-5, 4.611901376770728e-5,
                    5.460943391306912e-5, 6.256432199246906e-5, 5.231251746714465e-5,
                    9.074368319301978e-5, 9.586661751252483e-5, 3.380887799369099e-5,
                    6.540676375665226e-5, 5.8654179170012605e-5, 3.57266931781998e-5,
                    7.647495834904591e-5, 0.00011267184290645661, 4.143128850995927e-5,
                    7.935441978008262e-5, 5.0114071535580406e-5, 4.653374655964466e-5,
                    3.590427515904698e-5, 5.515284783210936e-5, 4.021938798861828e-5,
                    0.00011306987183854583, 0.00012019979975135411, 0.000131109874662877,
                    0.00017521302711765013, 0.00014104595686848445, 9.586661751252483e-5,
                    0.0006607220353538106, 6.726746889924702e-5, 0.00015253978189686476,
                    0.0001375448774402674, 7.722365388942048e-5, 0.00014657331729134909,
                    0.00024534692291446454, 8.647553998512274e-5, 0.00021145271488803285,
                    0.00014398770747145296, 0.00011761419201641538, 7.98179917310677e-5,
                    0.00012205967176471096, 8.789072601492713e-5, 3.8119305639128846e-5,
                    3.603800709172367e-5, 3.832131387809981e-5, 4.44360010695098e-5,
                    4.20293528507549e-5, 3.380887799369099e-5, 6.726746889924702e-5,
                    8.550205186888001e-5, 4.271945135765733e-5, 4.079994472352908e-5,
                    2.9034285089456267e-5, 5.3379780604015114e-5, 9.898601461415311e-5,
                    3.1550500603650656e-5, 5.180349434667779e-5, 5.736474912363394e-5,
                    3.39711270015641e-5, 3.1195931525352035e-5, 4.04096369769398e-5,
                    3.4672137933774716e-5, 6.837682872000733e-5, 6.75432397505338e-5,
                    7.509616053278322e-5, 8.876816740758091e-5, 7.898070705376363e-5,
                    6.540676375665226e-5, 0.00015253978189686476, 4.271945135765733e-5,
                    0.00014265724648466295, 8.398572312695221e-5, 4.024651146923677e-5,
                    9.27174266646299e-5, 0.00012816944145310205, 6.041114508783655e-5,
                    0.00011255718743300553, 8.252808697064051e-5, 7.321424105732342e-5,
                    5.026215279083766e-5, 0.00010496630670935451, 5.5159534089062207e-5,
                    6.215263922623088e-5, 6.011999281651871e-5, 6.825341019755814e-5,
                    8.184944754509676e-5, 6.800929601554662e-5, 5.8654179170012605e-5,
                    0.0001375448774402674, 4.079994472352908e-5, 8.398572312695221e-5,
                    0.00012334468032175347, 4.152058681803945e-5, 9.058189166059256e-5,
                    0.00013500595473760646, 5.0857369290214095e-5, 0.0001028904950515442,
                    7.705916188864535e-5, 5.706753219870596e-5, 4.436371194084665e-5,
                    6.968283575924472e-5, 5.117262777279619e-5, 3.470328960279329e-5,
                    3.363995455570329e-5, 3.606104303932644e-5, 4.318615316800234e-5,
                    3.686284738171411e-5, 3.57266931781998e-5, 7.722365388942048e-5,
                    2.9034285089456267e-5, 4.024651146923677e-5, 4.152058681803945e-5,
                    5.4310043451471086e-5, 4.422745548904965e-5, 7.364793804914346e-5,
                    3.1472709690335666e-5, 5.874388520368082e-5, 3.782656711955608e-5,
                    3.177359835889889e-5, 2.697784014583437e-5, 3.5558524794031596e-5,
                    2.8053275986740274e-5, 6.733035863603471e-5, 7.01619622187316e-5,
                    8.138744841748734e-5, 9.227037596079407e-5, 8.343696278035115e-5,
                    7.647495834904591e-5, 0.00014657331729134909, 5.3379780604015114e-5,
                    9.27174266646299e-5, 9.058189166059256e-5, 4.422745548904965e-5,
                    0.00038174849870592113, 0.0001807946851685135, 5.5935677553992044e-5,
                    0.00013397812637244033, 0.00010383147116962648, 6.961904651334486e-5,
                    5.1625557040975e-5, 7.780418080627433e-5, 6.87401020508241e-5,
                    8.079833062068485e-5, 9.362073746347488e-5, 9.769641160342731e-5,
                    0.0001320798986028135, 0.00010140859789357756, 0.00011267184290645661,
                    0.00024534692291446454, 9.898601461415311e-5, 0.00012816944145310205,
                    0.00013500595473760646, 7.364793804914346e-5, 0.0001807946851685135,
                    0.0008169678142001918, 8.485868999330778e-5, 0.0002570383878912758,
                    0.00016950522952039927, 8.321332252570511e-5, 6.854043054400009e-5,
                    9.405073464710144e-5, 9.076823534492819e-5, 4.332703277378487e-5,
                    4.400413609796305e-5, 4.106407042409599e-5, 5.398828081107398e-5,
                    4.50101633593726e-5, 4.143128850995927e-5, 8.647553998512274e-5,
                    3.1550500603650656e-5, 6.041114508783655e-5, 5.0857369290214095e-5,
                    3.1472709690335666e-5, 5.5935677553992044e-5, 8.485868999330778e-5,
                    7.153104613736411e-5, 9.51805418669602e-5, 4.7600314378947095e-5,
                    4.357843508438186e-5, 3.331617182393216e-5, 5.1924809707193214e-5,
                    3.4204446525355645e-5, 7.184050539788664e-5, 8.267716233803994e-5,
                    7.929388309514714e-5, 0.00012434597447963375, 9.439074583564873e-5,
                    7.935441978008262e-5, 0.00021145271488803285, 5.180349434667779e-5,
                    0.00011255718743300553, 0.0001028904950515442, 5.874388520368082e-5,
                    0.00013397812637244033, 0.0002570383878912758, 9.51805418669602e-5,
                    0.0004660622959060958, 0.00011460579509992922, 7.639241125853398e-5,
                    5.4802750322892456e-5, 8.95350677372051e-5, 6.424815934969141e-5,
                    5.749345733565443e-5, 6.454219282905186e-5, 6.727105903617332e-5,
                    7.81022147260696e-5, 6.669675039410489e-5, 5.0114071535580406e-5,
                    0.00014398770747145296, 5.736474912363394e-5, 8.252808697064051e-5,
                    7.705916188864535e-5, 3.782656711955608e-5, 0.00010383147116962648,
                    0.00016950522952039927, 4.7600314378947095e-5, 0.00011460579509992922,
                    0.00022844218186937918, 5.734288522677275e-5, 4.425809940725018e-5,
                    6.570245959480812e-5, 5.430540480745536e-5, 6.240915771333988e-5,
                    5.979601009534833e-5, 6.994749627290017e-5, 7.469226272921367e-5,
                    7.251471100216702e-5, 4.653374655964466e-5, 0.00011761419201641538,
                    3.39711270015641e-5, 7.321424105732342e-5, 5.706753219870596e-5,
                    3.177359835889889e-5, 6.961904651334486e-5, 8.321332252570511e-5,
                    4.357843508438186e-5, 7.639241125853398e-5, 5.734288522677275e-5,
                    8.30829221836891e-5, 3.980398622200994e-5, 6.1015413396672665e-5,
                    4.819871461683668e-5, 4.290107451946107e-5, 3.551750064837961e-5,
                    4.608296863761943e-5, 4.852720713504898e-5, 4.401365451191604e-5,
                    3.590427515904698e-5, 7.98179917310677e-5, 3.1195931525352035e-5,
                    5.026215279083766e-5, 4.436371194084665e-5, 2.697784014583437e-5,
                    5.1625557040975e-5, 6.854043054400009e-5, 3.331617182393216e-5,
                    5.4802750322892456e-5, 4.425809940725018e-5, 3.980398622200994e-5,
                    5.632860151158614e-5, 4.319761041123871e-5, 3.4218273072520945e-5,
                    5.868221017101273e-5, 5.6506380291512315e-5, 6.185600873777587e-5,
                    7.39420588845595e-5, 6.471675590786307e-5, 5.515284783210936e-5,
                    0.00012205967176471096, 4.04096369769398e-5, 0.00010496630670935451,
                    6.968283575924472e-5, 3.5558524794031596e-5, 7.780418080627433e-5,
                    9.405073464710144e-5, 5.1924809707193214e-5, 8.95350677372051e-5,
                    6.570245959480812e-5, 6.1015413396672665e-5, 4.319761041123871e-5,
                    9.294920808411245e-5, 4.674225644276263e-5, 5.409682290215357e-5,
                    4.788471614250951e-5, 6.045328596035443e-5, 6.033782407377706e-5,
                    6.547465905905916e-5, 4.021938798861828e-5, 8.789072601492713e-5,
                    3.4672137933774716e-5, 5.5159534089062207e-5, 5.117262777279619e-5,
                    2.8053275986740274e-5, 6.87401020508241e-5, 9.076823534492819e-5,
                    3.4204446525355645e-5, 6.424815934969141e-5, 5.430540480745536e-5,
                    4.819871461683668e-5, 3.4218273072520945e-5, 4.674225644276263e-5,
                    8.538083648463816e-5], (20, 20))
    @test isapprox(portfolio.cov, covt)

    normalise = false
    c1 = PortCovCor(; ce = CorGerber0(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.0001429324238121688, 0.00020259807595929947,
                    0.0002031958940004113, 0.0002366171526652066, 9.684278778698481e-5,
                    0.0002896321664855674, 8.65232606459581e-5, 0.0001354653715333508,
                    0.00011852739193561749, 6.587838545396265e-5, 0.00019767375075355084,
                    5.9870695731977015e-5, 7.418610054669832e-5, 6.461734481227253e-5,
                    0.00012804486141337892, 0.00014721629279815175, 9.708784867486076e-5,
                    0.00012697031350016635, 0.0001339855168760242, 0.0001429324238121688,
                    0.0002115234468410606, 0.00015692803909126196, 0.00015537948654810102,
                    0.00018456568717636099, 9.851686745848349e-5, 0.00031380210455963733,
                    8.481466100558899e-5, 0.00014297466287782303, 0.00011385802240462623,
                    6.410289854739459e-5, 0.00018310629530944873, 7.953664216328306e-5,
                    8.158560601310358e-5, 9.040382081681717e-5, 0.00016562159498448786,
                    0.0001340874048113183, 8.21972351750306e-5, 0.00012949109795714443,
                    0.00010374538377154136, 0.00020259807595929947, 0.00015692803909126196,
                    0.0002572414426920628, 0.0001988433077295612, 0.0002407633515553521,
                    9.392356077434072e-5, 0.00028670526920984355, 5.5936241376419504e-5,
                    0.00014223064701668198, 0.00011457804174172803, 5.5636520505283915e-5,
                    0.0002270626284561867, 9.412146645651317e-5, 5.17105334494616e-5,
                    4.967263427720082e-5, 0.00010443291357110115, 0.0001566043506335036,
                    8.578279570150134e-5, 0.00012700026961054312, 0.00013157624602437167,
                    0.0002031958940004113, 0.00015537948654810102, 0.0001988433077295612,
                    0.00040062774321407494, 0.0002453357854121558, 0.00011263332172448675,
                    0.00038023653713068606, 8.462812404743941e-5, 0.0001440916164758612,
                    0.0001260638807027712, 5.610276773959794e-5, 0.0002531091657124362,
                    0.0002196486956740693, 8.260353983592891e-5, 0.0001304990437629876,
                    0.00015768962195097976, 0.00016887498269566414, 8.637141047213282e-5,
                    0.0001382228507235165, 0.00011728231381526873, 0.0002366171526652066,
                    0.00018456568717636099, 0.0002407633515553521, 0.0002453357854121558,
                    0.0003311044630153933, 0.0001204012741634339, 0.00031986171997473874,
                    0.00010096606150092257, 0.00015333966972427558, 0.00011894522418954355,
                    6.530810567640539e-5, 0.00022354584622639475, 6.680710165255577e-5,
                    7.727664231426953e-5, 0.00011967258091171051, 0.0001495810048082186,
                    0.00017839910133965838, 9.870476639193098e-5, 0.0001482220204438704,
                    0.0001647615134203207, 9.684278778698481e-5, 9.851686745848349e-5,
                    9.392356077434072e-5, 0.00011263332172448675, 0.0001204012741634339,
                    0.00017908772525119756, 0.00019113128165043974, 8.219856304231038e-5,
                    0.00015855084182437378, 0.00014359375294773594, 7.305661670177264e-5,
                    0.0001978277219358505, 0.00022937117467014485, 0.00010567369423704371,
                    0.0001335069772290357, 0.00012027665416941231, 9.45928823372354e-5,
                    8.42201123827951e-5, 0.0001326007483649948, 0.0001041699727917702,
                    0.0002896321664855674, 0.00031380210455963733, 0.00028670526920984355,
                    0.00038023653713068606, 0.00031986171997473874, 0.00019113128165043974,
                    0.0016481856234771104, 0.0001814933134664943, 0.00029399686488519133,
                    0.00029825398312533375, 0.00012696748142348264, 0.000310160524546976,
                    0.00038819283599128383, 0.00018764827729834802, 0.0004120888974495931,
                    0.00031574042202267333, 0.00029040880849952143, 0.00017010550829090176,
                    0.00027909033420949413, 0.00017628477896725766, 8.65232606459581e-5,
                    8.481466100558899e-5, 5.5936241376419504e-5, 8.462812404743941e-5,
                    0.00010096606150092257, 8.219856304231038e-5, 0.0001814933134664943,
                    0.00016353541427233863, 6.864124818705036e-5, 9.441862180025833e-5,
                    7.229291045646172e-5, 0.0001317214598905501, 0.00016551171215364763,
                    4.8163058021431626e-5, 4.402090940968334e-5, 0.00015289036300401588,
                    8.605914215667602e-5, 7.930692009636535e-5, 7.457329244252743e-5,
                    8.735934735938626e-5, 0.0001354653715333508, 0.00014297466287782303,
                    0.00014223064701668198, 0.0001440916164758612, 0.00015333966972427558,
                    0.00015855084182437378, 0.00029399686488519133, 6.864124818705036e-5,
                    0.00027619979891424485, 0.00018038309305482686, 6.762252327948337e-5,
                    0.0002719865600481255, 0.00027418510197538065, 0.00013321830472037214,
                    0.0001963465388903426, 0.0002112156485200594, 0.0001407338639214735,
                    0.00010119913129758308, 0.00021543074542997202, 0.0001100881326494424,
                    0.00011852739193561749, 0.00011385802240462623, 0.00011457804174172803,
                    0.0001260638807027712, 0.00011894522418954355, 0.00014359375294773594,
                    0.00029825398312533375, 9.441862180025833e-5, 0.00018038309305482686,
                    0.000243322112701978, 7.041658642272345e-5, 0.00026302672951810334,
                    0.0002604338661363769, 0.00010656877747918196, 0.0001384227694260424,
                    0.0002054991949217031, 0.00012105830805214921, 8.421280820013629e-5,
                    0.0001535716236929251, 0.00010987474265936445, 6.587838545396265e-5,
                    6.410289854739459e-5, 5.5636520505283915e-5, 5.610276773959794e-5,
                    6.530810567640539e-5, 7.305661670177264e-5, 0.00012696748142348264,
                    7.229291045646172e-5, 6.762252327948337e-5, 7.041658642272345e-5,
                    0.00010534978848760108, 0.00010371423975259612, 9.035032711711362e-5,
                    6.61419219092414e-5, 7.747749341038655e-5, 8.71709421312189e-5,
                    6.144259148584304e-5, 5.819635388693711e-5, 8.101796084867616e-5,
                    5.278311868167982e-5, 0.00019767375075355084, 0.00018310629530944873,
                    0.0002270626284561867, 0.0002531091657124362, 0.00022354584622639475,
                    0.0001978277219358505, 0.000310160524546976, 0.0001317214598905501,
                    0.0002719865600481255, 0.00026302672951810334, 0.00010371423975259612,
                    0.0007066882567333455, 0.0005213202765126071, 0.00014941230711216748,
                    0.00029026841543067423, 0.0003461092889432716, 0.00017846632953503932,
                    0.00015381004312449846, 0.00023578773427629122, 0.00021686430796530732,
                    5.9870695731977015e-5, 7.953664216328306e-5, 9.412146645651317e-5,
                    0.0002196486956740693, 6.680710165255577e-5, 0.00022937117467014485,
                    0.00038819283599128383, 0.00016551171215364763, 0.00027418510197538065,
                    0.0002604338661363769, 9.035032711711362e-5, 0.0005213202765126071,
                    0.0019439677607081577, 0.00013889797546942547, 0.0003525998410590465,
                    0.0003782463680001078, 0.00011837504856826958, 9.741101110141354e-5,
                    0.00018813075193278245, 0.00015608947154337828, 7.418610054669832e-5,
                    8.158560601310358e-5, 5.17105334494616e-5, 8.260353983592891e-5,
                    7.727664231426953e-5, 0.00010567369423704371, 0.00018764827729834802,
                    4.8163058021431626e-5, 0.00013321830472037214, 0.00010656877747918196,
                    6.61419219092414e-5, 0.00014941230711216748, 0.00013889797546942547,
                    0.0001436352172851801, 0.0002313730272990423, 0.00012144924511621175,
                    8.921117036928702e-5, 6.836753641899049e-5, 0.00012061441188442455,
                    5.065351558880593e-5, 6.461734481227253e-5, 9.040382081681717e-5,
                    4.967263427720082e-5, 0.0001304990437629876, 0.00011967258091171051,
                    0.0001335069772290357, 0.0004120888974495931, 4.402090940968334e-5,
                    0.0001963465388903426, 0.0001384227694260424, 7.747749341038655e-5,
                    0.00029026841543067423, 0.0003525998410590465, 0.0002313730272990423,
                    0.0009937022125140937, 0.00020740927584996977, 8.031474190503075e-5,
                    4.588971542348439e-5, 0.0001605176276099768, 5.3302028306294245e-5,
                    0.00012804486141337892, 0.00016562159498448786, 0.00010443291357110115,
                    0.00015768962195097976, 0.0001495810048082186, 0.00012027665416941231,
                    0.00031574042202267333, 0.00015289036300401588, 0.0002112156485200594,
                    0.0002054991949217031, 8.71709421312189e-5, 0.0003461092889432716,
                    0.0003782463680001078, 0.00012144924511621175, 0.00020740927584996977,
                    0.0005054585590745467, 0.00014609109039812973, 9.001916282742592e-5,
                    0.00016693718613034332, 0.00013240151075404104, 0.00014721629279815175,
                    0.0001340874048113183, 0.0001566043506335036, 0.00016887498269566414,
                    0.00017839910133965838, 9.45928823372354e-5, 0.00029040880849952143,
                    8.605914215667602e-5, 0.0001407338639214735, 0.00012105830805214921,
                    6.144259148584304e-5, 0.00017846632953503932, 0.00011837504856826958,
                    8.921117036928702e-5, 8.031474190503075e-5, 0.00014609109039812973,
                    0.0001624387273643113, 9.632086090638387e-5, 0.00013457093720946589,
                    0.00011781752501925472, 9.708784867486076e-5, 8.21972351750306e-5,
                    8.578279570150134e-5, 8.637141047213282e-5, 9.870476639193098e-5,
                    8.42201123827951e-5, 0.00017010550829090176, 7.930692009636535e-5,
                    0.00010119913129758308, 8.421280820013629e-5, 5.819635388693711e-5,
                    0.00015381004312449846, 9.741101110141354e-5, 6.836753641899049e-5,
                    4.588971542348439e-5, 9.001916282742592e-5, 9.632086090638387e-5,
                    0.00012202561764009547, 9.509403050818369e-5, 7.31918413136932e-5,
                    0.00012697031350016635, 0.00012949109795714443, 0.00012700026961054312,
                    0.0001382228507235165, 0.0001482220204438704, 0.0001326007483649948,
                    0.00027909033420949413, 7.457329244252743e-5, 0.00021543074542997202,
                    0.0001535716236929251, 8.101796084867616e-5, 0.00023578773427629122,
                    0.00018813075193278245, 0.00012061441188442455, 0.0001605176276099768,
                    0.00016693718613034332, 0.00013457093720946589, 9.509403050818369e-5,
                    0.0001849011455817157, 0.00010176184721448902, 0.0001339855168760242,
                    0.00010374538377154136, 0.00013157624602437167, 0.00011728231381526873,
                    0.0001647615134203207, 0.0001041699727917702, 0.00017628477896725766,
                    8.735934735938626e-5, 0.0001100881326494424, 0.00010987474265936445,
                    5.278311868167982e-5, 0.00021686430796530732, 0.00015608947154337828,
                    5.065351558880593e-5, 5.3302028306294245e-5, 0.00013240151075404104,
                    0.00011781752501925472, 7.31918413136932e-5, 0.00010176184721448902,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorGerber1(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 6.23291286349971e-5, 0.00010356100488017669,
                    8.371764200660421e-5, 0.00011625833863559511, 3.878354928069673e-5,
                    9.694935263980535e-5, 3.172446547449766e-5, 5.7429751617745726e-5,
                    4.846130932087038e-5, 2.4862494456841716e-5, 6.969890517140166e-5,
                    2.1136360613123227e-5, 2.807281254579438e-5, 2.5001599955449118e-5,
                    4.646573805208194e-5, 7.18046792224904e-5, 3.8333934187503925e-5,
                    5.46794148415412e-5, 5.3886885554264445e-5, 6.23291286349971e-5,
                    0.0002115234468410606, 6.90464630970388e-5, 6.320629936566816e-5,
                    7.783642087964002e-5, 3.8865009016165474e-5, 0.00010937671940346848,
                    3.1676098815047114e-5, 5.6569945933470774e-5, 4.3811012950088326e-5,
                    2.5577931029183886e-5, 6.586090472834022e-5, 2.8124767407570352e-5,
                    3.203735875572509e-5, 3.5879968648990764e-5, 6.0703113485767365e-5,
                    5.853581857850475e-5, 3.371537934403154e-5, 5.261349131615019e-5,
                    4.344534251589312e-5, 0.00010356100488017669, 6.90464630970388e-5,
                    0.0002572414426920628, 8.223828799418188e-5, 0.00011875092331823086,
                    3.83401546385896e-5, 9.813079783387287e-5, 2.006462549703895e-5,
                    5.72351186241448e-5, 4.5557206830042884e-5, 2.291890098574253e-5,
                    7.54750465495313e-5, 3.1816871159754565e-5, 2.0091747395231243e-5,
                    1.992837052417016e-5, 3.6954838950491304e-5, 7.201391312979528e-5,
                    3.425519522704017e-5, 5.135610710942737e-5, 5.3148694050142445e-5,
                    8.371764200660421e-5, 6.320629936566816e-5, 8.223828799418188e-5,
                    0.00040062774321407494, 0.00010017249372088215, 4.5336088869824823e-5,
                    0.00013796376606005313, 3.082475759114199e-5, 5.659945351603518e-5,
                    5.203673619181459e-5, 2.23954693975337e-5, 8.718766442879165e-5,
                    8.06930938312194e-5, 3.1257590255295517e-5, 5.35631174648205e-5,
                    5.514381991356544e-5, 7.266565844746464e-5, 3.417367909494866e-5,
                    5.65276229286371e-5, 4.6202799215639757e-5, 0.00011625833863559511,
                    7.783642087964002e-5, 0.00011875092331823086, 0.00010017249372088215,
                    0.0003311044630153933, 4.4558671302697854e-5, 0.00011262600820473651,
                    3.6840358840933536e-5, 6.0865130581821866e-5, 4.84276452254427e-5,
                    2.688746028598994e-5, 7.489899635210519e-5, 2.2922342750385083e-5,
                    2.8960833729428676e-5, 4.6093016671100726e-5, 5.336035540848532e-5,
                    8.00611356027069e-5, 3.515200200483462e-5, 5.682602389019117e-5,
                    6.174835976161468e-5, 3.878354928069673e-5, 3.8865009016165474e-5,
                    3.83401546385896e-5, 4.5336088869824823e-5, 4.4558671302697854e-5,
                    0.00017908772525119756, 6.478084204530219e-5, 3.010457062502961e-5,
                    6.256215449711642e-5, 5.8579081746917784e-5, 3.0570233819363645e-5,
                    7.807749373461247e-5, 8.315329418996303e-5, 4.009621578899653e-5,
                    5.2887162916618235e-5, 4.469761010882706e-5, 4.069882348037152e-5,
                    3.4151029936064484e-5, 5.331640893115566e-5, 3.787300852162773e-5,
                    9.694935263980535e-5, 0.00010937671940346848, 9.813079783387287e-5,
                    0.00013796376606005313, 0.00011262600820473651, 6.478084204530219e-5,
                    0.0016481856234771104, 5.9522590120173766e-5, 0.00011370248584872404,
                    0.00010120868442546815, 4.3405889630035846e-5, 9.265313368486734e-5,
                    0.00012307768072883138, 5.968631307333361e-5, 0.00014491488671995885,
                    0.00010548489819610742, 0.00010652878480079501, 5.404038508627184e-5,
                    9.186406656875938e-5, 5.874252132000712e-5, 3.172446547449766e-5,
                    3.1676098815047114e-5, 2.006462549703895e-5, 3.082475759114199e-5,
                    3.6840358840933536e-5, 3.010457062502961e-5, 5.9522590120173766e-5,
                    0.00016353541427233863, 2.5022492261024385e-5, 3.491637650431821e-5,
                    2.9457696033683187e-5, 4.753824893150628e-5, 5.841512339005507e-5,
                    1.857729283796686e-5, 1.572865932117173e-5, 5.834155307887324e-5,
                    3.294666399703886e-5, 2.8520171108481586e-5, 2.7485030567397214e-5,
                    3.194270233378447e-5, 5.7429751617745726e-5, 5.6569945933470774e-5,
                    5.72351186241448e-5, 5.659945351603518e-5, 6.0865130581821866e-5,
                    6.256215449711642e-5, 0.00011370248584872404, 2.5022492261024385e-5,
                    0.00027619979891424485, 7.964370873978646e-5, 2.7926840070999543e-5,
                    9.82540997627517e-5, 0.00010132650810939896, 5.231873908974915e-5,
                    7.761327948783436e-5, 8.290158366101161e-5, 6.662721610469417e-5,
                    4.172386291189174e-5, 0.00013906829003659528, 4.432551306871021e-5,
                    4.846130932087038e-5, 4.3811012950088326e-5, 4.5557206830042884e-5,
                    5.203673619181459e-5, 4.84276452254427e-5, 5.8579081746917784e-5,
                    0.00010120868442546815, 3.491637650431821e-5, 7.964370873978646e-5,
                    0.000243322112701978, 2.9946189605690155e-5, 0.0001015523300936059,
                    0.00010069655543909088, 4.026143178451097e-5, 5.611654013506868e-5,
                    8.436608224374908e-5, 4.838266973224113e-5, 3.489190013860559e-5,
                    6.630490769248985e-5, 4.456018872765859e-5, 2.4862494456841716e-5,
                    2.5577931029183886e-5, 2.291890098574253e-5, 2.23954693975337e-5,
                    2.688746028598994e-5, 3.0570233819363645e-5, 4.3405889630035846e-5,
                    2.9457696033683187e-5, 2.7926840070999543e-5, 2.9946189605690155e-5,
                    0.00010534978848760108, 3.844764861238624e-5, 3.3190857409283884e-5,
                    2.7007134813651197e-5, 3.2950199243565726e-5, 3.281759524150385e-5,
                    2.6665641797101405e-5, 2.2948287166758534e-5, 3.368888807811426e-5,
                    2.2670181248671028e-5, 6.969890517140166e-5, 6.586090472834022e-5,
                    7.54750465495313e-5, 8.718766442879165e-5, 7.489899635210519e-5,
                    7.807749373461247e-5, 9.265313368486734e-5, 4.753824893150628e-5,
                    9.82540997627517e-5, 0.0001015523300936059, 3.844764861238624e-5,
                    0.0007066882567333455, 0.00018018327260879973, 4.7913337632311256e-5,
                    0.00010865226848625855, 0.00011953269476814119, 6.818524529820282e-5,
                    5.08696095739792e-5, 8.171594322070954e-5, 7.547692847890165e-5,
                    2.1136360613123227e-5, 2.8124767407570352e-5, 3.1816871159754565e-5,
                    8.06930938312194e-5, 2.2922342750385083e-5, 8.315329418996303e-5,
                    0.00012307768072883138, 5.841512339005507e-5, 0.00010132650810939896,
                    0.00010069655543909088, 3.3190857409283884e-5, 0.00018018327260879973,
                    0.0019439677607081577, 5.1340753209496936e-5, 0.00014255026920053198,
                    0.00013476335877480604, 4.48572645077975e-5, 3.299575678896017e-5,
                    7.090305676788268e-5, 5.878395695448129e-5, 2.807281254579438e-5,
                    3.203735875572509e-5, 2.0091747395231243e-5, 3.1257590255295517e-5,
                    2.8960833729428676e-5, 4.009621578899653e-5, 5.968631307333361e-5,
                    1.857729283796686e-5, 5.231873908974915e-5, 4.026143178451097e-5,
                    2.7007134813651197e-5, 4.7913337632311256e-5, 5.1340753209496936e-5,
                    0.0001436352172851801, 9.570859345070106e-5, 4.294310502324222e-5,
                    3.7949789589292765e-5, 2.6352559964285286e-5, 4.958749141178232e-5,
                    1.9022516708616725e-5, 2.5001599955449118e-5, 3.5879968648990764e-5,
                    1.992837052417016e-5, 5.35631174648205e-5, 4.6093016671100726e-5,
                    5.2887162916618235e-5, 0.00014491488671995885, 1.572865932117173e-5,
                    7.761327948783436e-5, 5.611654013506868e-5, 3.2950199243565726e-5,
                    0.00010865226848625855, 0.00014255026920053198, 9.570859345070106e-5,
                    0.0009937022125140937, 7.96778858682503e-5, 3.420516538281106e-5,
                    1.7183567404046265e-5, 5.870176296448434e-5, 2.1410966186828013e-5,
                    4.646573805208194e-5, 6.0703113485767365e-5, 3.6954838950491304e-5,
                    5.514381991356544e-5, 5.336035540848532e-5, 4.469761010882706e-5,
                    0.00010548489819610742, 5.834155307887324e-5, 8.290158366101161e-5,
                    8.436608224374908e-5, 3.281759524150385e-5, 0.00011953269476814119,
                    0.00013476335877480604, 4.294310502324222e-5, 7.96778858682503e-5,
                    0.0005054585590745467, 5.589980578971235e-5, 3.2719437412734705e-5,
                    6.495160484003335e-5, 4.866281715671634e-5, 7.18046792224904e-5,
                    5.853581857850475e-5, 7.201391312979528e-5, 7.266565844746464e-5,
                    8.00611356027069e-5, 4.069882348037152e-5, 0.00010652878480079501,
                    3.294666399703886e-5, 6.662721610469417e-5, 4.838266973224113e-5,
                    2.6665641797101405e-5, 6.818524529820282e-5, 4.48572645077975e-5,
                    3.7949789589292765e-5, 3.420516538281106e-5, 5.589980578971235e-5,
                    0.0001624387273643113, 3.972665234317898e-5, 6.113485453186529e-5,
                    4.931349204480187e-5, 3.8333934187503925e-5, 3.371537934403154e-5,
                    3.425519522704017e-5, 3.417367909494866e-5, 3.515200200483462e-5,
                    3.4151029936064484e-5, 5.404038508627184e-5, 2.8520171108481586e-5,
                    4.172386291189174e-5, 3.489190013860559e-5, 2.2948287166758534e-5,
                    5.08696095739792e-5, 3.299575678896017e-5, 2.6352559964285286e-5,
                    1.7183567404046265e-5, 3.2719437412734705e-5, 3.972665234317898e-5,
                    0.00012202561764009547, 4.127688325661089e-5, 3.179579330594049e-5,
                    5.46794148415412e-5, 5.261349131615019e-5, 5.135610710942737e-5,
                    5.65276229286371e-5, 5.682602389019117e-5, 5.331640893115566e-5,
                    9.186406656875938e-5, 2.7485030567397214e-5, 0.00013906829003659528,
                    6.630490769248985e-5, 3.368888807811426e-5, 8.171594322070954e-5,
                    7.090305676788268e-5, 4.958749141178232e-5, 5.870176296448434e-5,
                    6.495160484003335e-5, 6.113485453186529e-5, 4.127688325661089e-5,
                    0.0001849011455817157, 4.192972880861213e-5, 5.3886885554264445e-5,
                    4.344534251589312e-5, 5.3148694050142445e-5, 4.6202799215639757e-5,
                    6.174835976161468e-5, 3.787300852162773e-5, 5.874252132000712e-5,
                    3.194270233378447e-5, 4.432551306871021e-5, 4.456018872765859e-5,
                    2.2670181248671028e-5, 7.547692847890165e-5, 5.878395695448129e-5,
                    1.9022516708616725e-5, 2.1410966186828013e-5, 4.866281715671634e-5,
                    4.931349204480187e-5, 3.179579330594049e-5, 4.192972880861213e-5,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorGerber2(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 8.682790505764035e-5, 0.00013709508181508756,
                    0.00011873243685537483, 0.00015602891660814822, 5.534317884299013e-5,
                    0.00014534958252690353, 4.643510754463943e-5, 8.098054356627528e-5,
                    6.890512008798055e-5, 3.62328891246217e-5, 0.00010311236295842173,
                    3.124271354353602e-5, 4.0774647269456776e-5, 3.614644407563322e-5,
                    6.814289238858544e-5, 9.667719106668856e-5, 5.496842609155534e-5,
                    7.622079106355414e-5, 7.697923733232906e-5, 8.682790505764035e-5,
                    0.00021152344684106057, 9.58988125659973e-5, 8.987646202956476e-5,
                    0.00010959151270332064, 5.574450232920425e-5, 0.00016244184125665173,
                    4.614540990807589e-5, 8.110534603143283e-5, 6.329362494876886e-5,
                    3.6608527762017566e-5, 9.699644212144745e-5, 4.1561063582434975e-5,
                    4.6016266599058864e-5, 5.146321901208992e-5, 8.888262056039405e-5,
                    8.152325663402626e-5, 4.7826087052044236e-5, 7.479541923346365e-5,
                    6.12619805994732e-5, 0.00013709508181508756, 9.58988125659973e-5,
                    0.00025724144269206276, 0.00011638235290806589, 0.00015916143303658592,
                    5.4455000398148406e-5, 0.0001463890358818815, 2.9543638525123338e-5,
                    8.167294533750665e-5, 6.521881841225654e-5, 3.2510873959047634e-5,
                    0.00011341182042287638, 4.75716826866987e-5, 2.8941803940665544e-5,
                    2.850285564900592e-5, 5.460535640083732e-5, 9.87137469697536e-5,
                    4.8963468020893774e-5, 7.310359921499752e-5, 7.574027186772931e-5,
                    0.00011873243685537483, 8.987646202956476e-5, 0.00011638235290806589,
                    0.0004006277432140749, 0.00014245840034421, 6.470865357012305e-5,
                    0.00020294573923606567, 4.523417202063769e-5, 8.120282825861423e-5,
                    7.365984175626092e-5, 3.2012757270441874e-5, 0.0001299730679534252,
                    0.00011804388422284525, 4.535919810863228e-5, 7.604886614886922e-5,
                    8.182621295981143e-5, 0.00010161240858148992, 4.900365374975593e-5,
                    8.033362999462939e-5, 6.628550421549307e-5, 0.00015602891660814822,
                    0.00010959151270332064, 0.00015916143303658592, 0.00014245840034421,
                    0.0003311044630153933, 6.510097746942449e-5, 0.0001665647821859373,
                    5.397745728246299e-5, 8.701954699389301e-5, 6.894112259714654e-5,
                    3.8184891380809557e-5, 0.00011217281492637898, 3.4245486137226925e-5,
                    4.211063613379569e-5, 6.695473326070301e-5, 7.871169134374905e-5,
                    0.0001107427471603515, 5.185228989660419e-5, 8.242764802704734e-5,
                    8.998740341096623e-5, 5.534317884299013e-5, 5.574450232920425e-5,
                    5.4455000398148406e-5, 6.470865357012305e-5, 6.510097746942449e-5,
                    0.00017908772525119756, 9.684013834202441e-5, 4.4076107192598496e-5,
                    8.990387072357744e-5, 8.329656177280179e-5, 4.321707520986598e-5,
                    0.00011203711872540402, 0.00012214381864720082, 5.815736739131664e-5,
                    7.598018649694057e-5, 6.515249916494239e-5, 5.697353705432511e-5,
                    4.8596523058445786e-5, 7.593152879427692e-5, 5.560691938646277e-5,
                    0.00014534958252690353, 0.00016244184125665173, 0.0001463890358818815,
                    0.00020294573923606567, 0.0001665647821859373, 9.684013834202441e-5,
                    0.0016481856234771101, 8.966652163820124e-5, 0.0001642216616485298,
                    0.00015154980232830488, 6.498574929074802e-5, 0.0001426663745144631,
                    0.00018746450357630192, 9.062588917428876e-5, 0.00021586872641818166,
                    0.0001581969848515738, 0.00015635033279006038, 8.20686822524473e-5,
                    0.00013848593682854257, 8.836265240748542e-5, 4.643510754463943e-5,
                    4.614540990807589e-5, 2.9543638525123338e-5, 4.523417202063769e-5,
                    5.397745728246299e-5, 4.4076107192598496e-5, 8.966652163820124e-5,
                    0.00016353541427233863, 3.6686089063378784e-5, 5.104462640117984e-5,
                    4.1968508906730804e-5, 6.987348914689465e-5, 8.647616454271725e-5,
                    2.6811733603679324e-5, 2.3278172507074943e-5, 8.446209168198146e-5,
                    4.7720744902617234e-5, 4.195491240143995e-5, 4.020030826651275e-5,
                    4.683953350818281e-5, 8.098054356627528e-5, 8.110534603143283e-5,
                    8.167294533750665e-5, 8.120282825861423e-5, 8.701954699389301e-5,
                    8.990387072357744e-5, 0.0001642216616485298, 3.6686089063378784e-5,
                    0.0002761997989142449, 0.00011043555938042438, 3.942356861659221e-5,
                    0.00014453624478607893, 0.00014811453662831053, 7.50471431199773e-5,
                    0.00011154374149926653, 0.0001193622273317817, 9.039743150970439e-5,
                    5.9124516426893855e-5, 0.00017033080645058798, 6.316207082799163e-5,
                    6.890512008798055e-5, 6.329362494876886e-5, 6.521881841225654e-5,
                    7.365984175626092e-5, 6.894112259714654e-5, 8.329656177280179e-5,
                    0.00015154980232830488, 5.104462640117984e-5, 0.00011043555938042438,
                    0.00024332211270197798, 4.20221408850229e-5, 0.0001468949366417708,
                    0.00014524981142477917, 5.846764341610984e-5, 7.993617329399042e-5,
                    0.00011981508466545653, 6.913301156477217e-5, 4.9383793741284394e-5,
                    9.271976362149261e-5, 6.340170616007236e-5, 3.62328891246217e-5,
                    3.6608527762017566e-5, 3.2510873959047634e-5, 3.2012757270441874e-5,
                    3.8184891380809557e-5, 4.321707520986598e-5, 6.498574929074802e-5,
                    4.1968508906730804e-5, 3.942356861659221e-5, 4.20221408850229e-5,
                    0.00010534978848760108, 5.632733343683808e-5, 4.8581725572152864e-5,
                    3.8396038944493006e-5, 4.627430224345485e-5, 4.785173500472502e-5,
                    3.719072406785219e-5, 3.2985941302310366e-5, 4.7770099948706685e-5,
                    3.171834299656958e-5, 0.00010311236295842173, 9.699644212144745e-5,
                    0.00011341182042287638, 0.0001299730679534252, 0.00011217281492637898,
                    0.00011203711872540402, 0.0001426663745144631, 6.987348914689465e-5,
                    0.00014453624478607893, 0.0001468949366417708, 5.632733343683808e-5,
                    0.0007066882567333455, 0.00026853366607507335, 7.259606425546071e-5,
                    0.00015912353176872912, 0.000177747517245804, 9.893570025983697e-5,
                    7.648839938660821e-5, 0.0001215907508687377, 0.00011226206319162686,
                    3.124271354353602e-5, 4.1561063582434975e-5, 4.75716826866987e-5,
                    0.00011804388422284525, 3.4245486137226925e-5, 0.00012214381864720082,
                    0.00018746450357630192, 8.647616454271725e-5, 0.00014811453662831053,
                    0.00014524981142477917, 4.8581725572152864e-5, 0.00026853366607507335,
                    0.0019439677607081581, 7.503917455600048e-5, 0.0002031332432631881,
                    0.0001990021263461964, 6.506678681537456e-5, 4.933942327363524e-5,
                    0.0001028959992170588, 8.541369574061993e-5, 4.0774647269456776e-5,
                    4.6016266599058864e-5, 2.8941803940665544e-5, 4.535919810863228e-5,
                    4.211063613379569e-5, 5.815736739131664e-5, 9.062588917428876e-5,
                    2.6811733603679324e-5, 7.50471431199773e-5, 5.846764341610984e-5,
                    3.8396038944493006e-5, 7.259606425546071e-5, 7.503917455600048e-5,
                    0.00014363521728518009, 0.0001358027584437802, 6.348620310008259e-5,
                    5.328201354917446e-5, 3.8042649597176776e-5, 7.039415518962876e-5,
                    2.7666098224082384e-5, 3.614644407563322e-5, 5.146321901208992e-5,
                    2.850285564900592e-5, 7.604886614886922e-5, 6.695473326070301e-5,
                    7.598018649694057e-5, 0.00021586872641818166, 2.3278172507074943e-5,
                    0.00011154374149926653, 7.993617329399042e-5, 4.627430224345485e-5,
                    0.00015912353176872912, 0.0002031332432631881, 0.0001358027584437802,
                    0.0009937022125140935, 0.00011560233049814136, 4.80160546473063e-5,
                    2.5087243418683633e-5, 8.601623324104299e-5, 3.058623632461464e-5,
                    6.814289238858544e-5, 8.888262056039405e-5, 5.460535640083732e-5,
                    8.182621295981143e-5, 7.871169134374905e-5, 6.515249916494239e-5,
                    0.0001581969848515738, 8.446209168198146e-5, 0.0001193622273317817,
                    0.00011981508466545653, 4.785173500472502e-5, 0.000177747517245804,
                    0.0001990021263461964, 6.348620310008259e-5, 0.00011560233049814136,
                    0.0005054585590745466, 8.100370492061112e-5, 4.799752244394757e-5,
                    9.339583936620131e-5, 7.128326571894983e-5, 9.667719106668856e-5,
                    8.152325663402626e-5, 9.87137469697536e-5, 0.00010161240858148992,
                    0.0001107427471603515, 5.697353705432511e-5, 0.00015635033279006038,
                    4.7720744902617234e-5, 9.039743150970439e-5, 6.913301156477217e-5,
                    3.719072406785219e-5, 9.893570025983697e-5, 6.506678681537456e-5,
                    5.328201354917446e-5, 4.80160546473063e-5, 8.100370492061112e-5,
                    0.00016243872736431132, 5.631104405163727e-5, 8.415993095656244e-5,
                    6.952769446314014e-5, 5.496842609155534e-5, 4.7826087052044236e-5,
                    4.8963468020893774e-5, 4.900365374975593e-5, 5.185228989660419e-5,
                    4.8596523058445786e-5, 8.20686822524473e-5, 4.195491240143995e-5,
                    5.9124516426893855e-5, 4.9383793741284394e-5, 3.2985941302310366e-5,
                    7.648839938660821e-5, 4.933942327363524e-5, 3.8042649597176776e-5,
                    2.5087243418683633e-5, 4.799752244394757e-5, 5.631104405163727e-5,
                    0.00012202561764009547, 5.756832888724226e-5, 4.437089371051247e-5,
                    7.622079106355414e-5, 7.479541923346365e-5, 7.310359921499752e-5,
                    8.033362999462939e-5, 8.242764802704734e-5, 7.593152879427692e-5,
                    0.00013848593682854257, 4.020030826651275e-5, 0.00017033080645058798,
                    9.271976362149261e-5, 4.7770099948706685e-5, 0.0001215907508687377,
                    0.0001028959992170588, 7.039415518962876e-5, 8.601623324104299e-5,
                    9.339583936620131e-5, 8.415993095656244e-5, 5.756832888724226e-5,
                    0.0001849011455817157, 5.945458024494737e-5, 7.697923733232906e-5,
                    6.12619805994732e-5, 7.574027186772931e-5, 6.628550421549307e-5,
                    8.998740341096623e-5, 5.560691938646277e-5, 8.836265240748542e-5,
                    4.683953350818281e-5, 6.316207082799163e-5, 6.340170616007236e-5,
                    3.171834299656958e-5, 0.00011226206319162686, 8.541369574061993e-5,
                    2.7666098224082384e-5, 3.058623632461464e-5, 7.128326571894983e-5,
                    6.952769446314014e-5, 4.437089371051247e-5, 5.945458024494737e-5,
                    0.00015789185651061684], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorSB0(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.00015171917684594493, 0.00020901458234134094,
                    0.0002035930792565737, 0.00024295791387468884, 0.0001044154040543535,
                    0.00031248060517603143, 9.000015945812259e-5, 0.00014281859164296976,
                    0.00012773652850304196, 7.970999113532004e-5, 0.00019685813200462008,
                    5.1480799578064364e-5, 7.790676257401166e-5, 5.1996679052246224e-5,
                    0.00014325660277128124, 0.00015522125913117145, 0.00010117514765699439,
                    0.0001324527662246249, 0.00013997417980781923, 0.00015171917684594493,
                    0.0002115234468410606, 0.00016895224373280658, 0.00016822335171767693,
                    0.000195024170647193, 0.00010480166927892961, 0.0003247699726947943,
                    8.789480646870549e-5, 0.0001503093256121966, 0.0001203869147914532,
                    7.187755055502308e-5, 0.00019859439356572267, 9.675315449196071e-5,
                    8.601790999002299e-5, 8.618756781520614e-5, 0.00016999085519975963,
                    0.0001411416368818429, 8.170385407265044e-5, 0.00013537668869838108,
                    0.00011367434981687041, 0.00020901458234134094, 0.00016895224373280658,
                    0.0002572414426920628, 0.00021338567010403692, 0.00024892326047198075,
                    0.00010004168545282478, 0.0003065666125270082, 6.202215115083353e-5,
                    0.00015055210279442006, 0.00012288544807236362, 6.722168452836373e-5,
                    0.0002320448954205074, 8.093089970484792e-5, 5.496516062563186e-5,
                    4.750366315109427e-5, 0.00010915511498243779, 0.0001632796562141103,
                    9.307746412009905e-5, 0.00013178283695592825, 0.0001432009220906687,
                    0.0002035930792565737, 0.00016822335171767693, 0.00021338567010403692,
                    0.00040062774321407494, 0.00024971395484633344, 0.00011847026822152929,
                    0.00038734807977047433, 8.781659601589175e-5, 0.00015540772661375323,
                    0.00014178182334057487, 5.590801593619838e-5, 0.00027334109988358136,
                    0.00021645281460265986, 8.433028309486706e-5, 0.00014345481083735014,
                    0.00017111761799426715, 0.000173305005746987, 8.861019727227993e-5,
                    0.00014532455664746652, 0.00012303926468759977, 0.00024295791387468884,
                    0.000195024170647193, 0.00024892326047198075, 0.00024971395484633344,
                    0.0003311044630153933, 0.00013520126187862653, 0.0003397301059550499,
                    0.00011132433472099752, 0.0001644343025267074, 0.00013100221267961832,
                    7.759500190973952e-5, 0.00023397333812248482, 4.942676924742433e-5,
                    8.700516394740265e-5, 0.0001158636847172581, 0.00016953522137142231,
                    0.00018239537189463216, 0.00011499607440590414, 0.00015343797950964755,
                    0.00017497627368280962, 0.0001044154040543535, 0.00010480166927892961,
                    0.00010004168545282478, 0.00011847026822152929, 0.00013520126187862653,
                    0.00017908772525119756, 0.0002055588313908254, 8.863233976854152e-5,
                    0.00016049633997361682, 0.00014848258694213535, 7.81063115292148e-5,
                    0.000201643540030183, 0.000233148824906612, 0.00010641666773812156,
                    0.0001347303463380103, 0.0001316104216168032, 0.00010368949258956979,
                    8.53974373418592e-5, 0.00013753235468608118, 0.00010342044243142224,
                    0.00031248060517603143, 0.0003247699726947943, 0.0003065666125270082,
                    0.00038734807977047433, 0.0003397301059550499, 0.0002055588313908254,
                    0.0016481856234771104, 0.00018196170547761346, 0.0002808902098612185,
                    0.0003162374699736255, 0.00012527698113225894, 0.0003012398620611084,
                    0.00038252547549070246, 0.00019596224949154916, 0.0004193195638600682,
                    0.0003191830335731955, 0.00029985536616429763, 0.00017286371044999122,
                    0.00026800574694353993, 0.00018683198591124757, 9.000015945812259e-5,
                    8.789480646870549e-5, 6.202215115083353e-5, 8.781659601589175e-5,
                    0.00011132433472099752, 8.863233976854152e-5, 0.00018196170547761346,
                    0.00016353541427233863, 7.63424640704622e-5, 0.000101459057577146,
                    7.601386674812415e-5, 0.0001299719165554861, 0.0001589283513455729,
                    5.28057393828308e-5, 4.510803827117976e-5, 0.00017614687334031512,
                    8.988214610831593e-5, 8.2016345483186e-5, 8.319717881514705e-5,
                    8.778689490383852e-5, 0.00014281859164296976, 0.0001503093256121966,
                    0.00015055210279442006, 0.00015540772661375323, 0.0001644343025267074,
                    0.00016049633997361682, 0.0002808902098612185, 7.63424640704622e-5,
                    0.00027619979891424485, 0.00018475639043095577, 7.643539182477476e-5,
                    0.0002783824083258346, 0.000257966245608963, 0.000132849766559161,
                    0.00019829711659373443, 0.00021677991935265225, 0.00014571311832662146,
                    0.00010337654106752722, 0.00021508714705077668, 0.00011334056341986459,
                    0.00012773652850304196, 0.0001203869147914532, 0.00012288544807236362,
                    0.00014178182334057487, 0.00013100221267961832, 0.00014848258694213535,
                    0.0003162374699736255, 0.000101459057577146, 0.00018475639043095577,
                    0.000243322112701978, 7.490303591286055e-5, 0.0002615075807483206,
                    0.00026561984881571203, 0.00011579204957172905, 0.00012759922926531037,
                    0.0002127748410071772, 0.00012507579682467297, 8.573312465695285e-5,
                    0.00015986786609348467, 0.00011039343543086504, 7.970999113532004e-5,
                    7.187755055502308e-5, 6.722168452836373e-5, 5.590801593619838e-5,
                    7.759500190973952e-5, 7.81063115292148e-5, 0.00012527698113225894,
                    7.601386674812415e-5, 7.643539182477476e-5, 7.490303591286055e-5,
                    0.00010534978848760108, 0.00010592750107296607, 8.42717126936138e-5,
                    6.693553167117217e-5, 6.856120673910334e-5, 9.23396277812674e-5,
                    6.635080485479108e-5, 6.436837688841065e-5, 8.714022422364076e-5,
                    5.627273793576809e-5, 0.00019685813200462008, 0.00019859439356572267,
                    0.0002320448954205074, 0.00027334109988358136, 0.00023397333812248482,
                    0.000201643540030183, 0.0003012398620611084, 0.0001299719165554861,
                    0.0002783824083258346, 0.0002615075807483206, 0.00010592750107296607,
                    0.0007066882567333455, 0.0005146538949292687, 0.00015502332039462273,
                    0.00027591056131041154, 0.000375455600318967, 0.00018262758571373423,
                    0.0001653746243126439, 0.00023683804760606683, 0.00022216581404420327,
                    5.1480799578064364e-5, 9.675315449196071e-5, 8.093089970484792e-5,
                    0.00021645281460265986, 4.942676924742433e-5, 0.000233148824906612,
                    0.00038252547549070246, 0.0001589283513455729, 0.000257966245608963,
                    0.00026561984881571203, 8.42717126936138e-5, 0.0005146538949292687,
                    0.0019439677607081577, 0.0001366845277314272, 0.00031568093710236265,
                    0.00040882836134845064, 0.00011027043542380369, 9.030467230474938e-5,
                    0.0001714607708223151, 0.00013911706362883784, 7.790676257401166e-5,
                    8.601790999002299e-5, 5.496516062563186e-5, 8.433028309486706e-5,
                    8.700516394740265e-5, 0.00010641666773812156, 0.00019596224949154916,
                    5.28057393828308e-5, 0.000132849766559161, 0.00011579204957172905,
                    6.693553167117217e-5, 0.00015502332039462273, 0.0001366845277314272,
                    0.0001436352172851801, 0.00023735176739157822, 0.00012453923992959516,
                    8.899958154385431e-5, 7.369814989009736e-5, 0.0001226191517173754,
                    5.341644192282571e-5, 5.1996679052246224e-5, 8.618756781520614e-5,
                    4.750366315109427e-5, 0.00014345481083735014, 0.0001158636847172581,
                    0.0001347303463380103, 0.0004193195638600682, 4.510803827117976e-5,
                    0.00019829711659373443, 0.00012759922926531037, 6.856120673910334e-5,
                    0.00027591056131041154, 0.00031568093710236265, 0.00023735176739157822,
                    0.0009937022125140937, 0.00018337851194591756, 8.089573878208514e-5,
                    4.34338140742378e-5, 0.00016606370973067152, 5.542001393778329e-5,
                    0.00014325660277128124, 0.00016999085519975963, 0.00010915511498243779,
                    0.00017111761799426715, 0.00016953522137142231, 0.0001316104216168032,
                    0.0003191830335731955, 0.00017614687334031512, 0.00021677991935265225,
                    0.0002127748410071772, 9.23396277812674e-5, 0.000375455600318967,
                    0.00040882836134845064, 0.00012453923992959516, 0.00018337851194591756,
                    0.0005054585590745467, 0.0001499453673847894, 9.674155293567803e-5,
                    0.0001784934477516111, 0.0001393689487786375, 0.00015522125913117145,
                    0.0001411416368818429, 0.0001632796562141103, 0.000173305005746987,
                    0.00018239537189463216, 0.00010368949258956979, 0.00029985536616429763,
                    8.988214610831593e-5, 0.00014571311832662146, 0.00012507579682467297,
                    6.635080485479108e-5, 0.00018262758571373423, 0.00011027043542380369,
                    8.899958154385431e-5, 8.089573878208514e-5, 0.0001499453673847894,
                    0.0001624387273643113, 0.00010286722457476836, 0.000136622038264165,
                    0.0001232689027484105, 0.00010117514765699439, 8.170385407265044e-5,
                    9.307746412009905e-5, 8.861019727227993e-5, 0.00011499607440590414,
                    8.53974373418592e-5, 0.00017286371044999122, 8.2016345483186e-5,
                    0.00010337654106752722, 8.573312465695285e-5, 6.436837688841065e-5,
                    0.0001653746243126439, 9.030467230474938e-5, 7.369814989009736e-5,
                    4.34338140742378e-5, 9.674155293567803e-5, 0.00010286722457476836,
                    0.00012202561764009547, 0.00010060272031673383, 7.873675826568531e-5,
                    0.0001324527662246249, 0.00013537668869838108, 0.00013178283695592825,
                    0.00014532455664746652, 0.00015343797950964755, 0.00013753235468608118,
                    0.00026800574694353993, 8.319717881514705e-5, 0.00021508714705077668,
                    0.00015986786609348467, 8.714022422364076e-5, 0.00023683804760606683,
                    0.0001714607708223151, 0.0001226191517173754, 0.00016606370973067152,
                    0.0001784934477516111, 0.000136622038264165, 0.00010060272031673383,
                    0.0001849011455817157, 0.00010358427734459658, 0.00013997417980781923,
                    0.00011367434981687041, 0.0001432009220906687, 0.00012303926468759977,
                    0.00017497627368280962, 0.00010342044243142224, 0.00018683198591124757,
                    8.778689490383852e-5, 0.00011334056341986459, 0.00011039343543086504,
                    5.627273793576809e-5, 0.00022216581404420327, 0.00013911706362883784,
                    5.341644192282571e-5, 5.542001393778329e-5, 0.0001393689487786375,
                    0.0001232689027484105, 7.873675826568531e-5, 0.00010358427734459658,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorSB1(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.00015171917684594493, 0.00020901458234134094,
                    0.0002035930792565737, 0.00024295791387468884, 0.0001044154040543535,
                    0.00031248060517603143, 9.000015945812259e-5, 0.00014281859164296976,
                    0.00012773652850304196, 7.970999113532004e-5, 0.00019685813200462008,
                    5.1480799578064364e-5, 7.790676257401166e-5, 5.1996679052246224e-5,
                    0.00014325660277128124, 0.00015522125913117145, 0.00010117514765699439,
                    0.0001324527662246249, 0.00013997417980781923, 0.00015171917684594493,
                    0.0002115234468410606, 0.00016895224373280658, 0.00016822335171767693,
                    0.000195024170647193, 0.00010480166927892961, 0.0003247699726947943,
                    8.789480646870549e-5, 0.0001503093256121966, 0.0001203869147914532,
                    7.187755055502308e-5, 0.00019859439356572267, 9.675315449196071e-5,
                    8.601790999002299e-5, 8.618756781520614e-5, 0.00016999085519975963,
                    0.0001411416368818429, 8.170385407265044e-5, 0.00013537668869838108,
                    0.00011367434981687041, 0.00020901458234134094, 0.00016895224373280658,
                    0.0002572414426920628, 0.00021338567010403692, 0.00024892326047198075,
                    0.00010004168545282478, 0.0003065666125270082, 6.202215115083353e-5,
                    0.00015055210279442006, 0.00012288544807236362, 6.722168452836373e-5,
                    0.0002320448954205074, 8.093089970484792e-5, 5.496516062563186e-5,
                    4.750366315109427e-5, 0.00010915511498243779, 0.0001632796562141103,
                    9.307746412009905e-5, 0.00013178283695592825, 0.0001432009220906687,
                    0.0002035930792565737, 0.00016822335171767693, 0.00021338567010403692,
                    0.00040062774321407494, 0.00024971395484633344, 0.00011847026822152929,
                    0.00038734807977047433, 8.781659601589175e-5, 0.00015540772661375323,
                    0.00014178182334057487, 5.590801593619838e-5, 0.00027334109988358136,
                    0.00021645281460265986, 8.433028309486706e-5, 0.00014345481083735014,
                    0.00017111761799426715, 0.000173305005746987, 8.861019727227993e-5,
                    0.00014532455664746652, 0.00012303926468759977, 0.00024295791387468884,
                    0.000195024170647193, 0.00024892326047198075, 0.00024971395484633344,
                    0.0003311044630153933, 0.00013520126187862653, 0.0003397301059550499,
                    0.00011132433472099752, 0.0001644343025267074, 0.00013100221267961832,
                    7.759500190973952e-5, 0.00023397333812248482, 4.942676924742433e-5,
                    8.700516394740265e-5, 0.0001158636847172581, 0.00016953522137142231,
                    0.00018239537189463216, 0.00011499607440590414, 0.00015343797950964755,
                    0.00017497627368280962, 0.0001044154040543535, 0.00010480166927892961,
                    0.00010004168545282478, 0.00011847026822152929, 0.00013520126187862653,
                    0.00017908772525119756, 0.0002055588313908254, 8.863233976854152e-5,
                    0.00016049633997361682, 0.00014848258694213535, 7.81063115292148e-5,
                    0.000201643540030183, 0.000233148824906612, 0.00010641666773812156,
                    0.0001347303463380103, 0.0001316104216168032, 0.00010368949258956979,
                    8.53974373418592e-5, 0.00013753235468608118, 0.00010342044243142224,
                    0.00031248060517603143, 0.0003247699726947943, 0.0003065666125270082,
                    0.00038734807977047433, 0.0003397301059550499, 0.0002055588313908254,
                    0.0016481856234771104, 0.00018196170547761346, 0.0002808902098612185,
                    0.0003162374699736255, 0.00012527698113225894, 0.0003012398620611084,
                    0.00038252547549070246, 0.00019596224949154916, 0.0004193195638600682,
                    0.0003191830335731955, 0.00029985536616429763, 0.00017286371044999122,
                    0.00026800574694353993, 0.00018683198591124757, 9.000015945812259e-5,
                    8.789480646870549e-5, 6.202215115083353e-5, 8.781659601589175e-5,
                    0.00011132433472099752, 8.863233976854152e-5, 0.00018196170547761346,
                    0.00016353541427233863, 7.63424640704622e-5, 0.000101459057577146,
                    7.601386674812415e-5, 0.0001299719165554861, 0.0001589283513455729,
                    5.28057393828308e-5, 4.510803827117976e-5, 0.00017614687334031512,
                    8.988214610831593e-5, 8.2016345483186e-5, 8.319717881514705e-5,
                    8.778689490383852e-5, 0.00014281859164296976, 0.0001503093256121966,
                    0.00015055210279442006, 0.00015540772661375323, 0.0001644343025267074,
                    0.00016049633997361682, 0.0002808902098612185, 7.63424640704622e-5,
                    0.00027619979891424485, 0.00018475639043095577, 7.643539182477476e-5,
                    0.0002783824083258346, 0.000257966245608963, 0.000132849766559161,
                    0.00019829711659373443, 0.00021677991935265225, 0.00014571311832662146,
                    0.00010337654106752722, 0.00021508714705077668, 0.00011334056341986459,
                    0.00012773652850304196, 0.0001203869147914532, 0.00012288544807236362,
                    0.00014178182334057487, 0.00013100221267961832, 0.00014848258694213535,
                    0.0003162374699736255, 0.000101459057577146, 0.00018475639043095577,
                    0.000243322112701978, 7.490303591286055e-5, 0.0002615075807483206,
                    0.00026561984881571203, 0.00011579204957172905, 0.00012759922926531037,
                    0.0002127748410071772, 0.00012507579682467297, 8.573312465695285e-5,
                    0.00015986786609348467, 0.00011039343543086504, 7.970999113532004e-5,
                    7.187755055502308e-5, 6.722168452836373e-5, 5.590801593619838e-5,
                    7.759500190973952e-5, 7.81063115292148e-5, 0.00012527698113225894,
                    7.601386674812415e-5, 7.643539182477476e-5, 7.490303591286055e-5,
                    0.00010534978848760108, 0.00010592750107296607, 8.42717126936138e-5,
                    6.693553167117217e-5, 6.856120673910334e-5, 9.23396277812674e-5,
                    6.635080485479108e-5, 6.436837688841065e-5, 8.714022422364076e-5,
                    5.627273793576809e-5, 0.00019685813200462008, 0.00019859439356572267,
                    0.0002320448954205074, 0.00027334109988358136, 0.00023397333812248482,
                    0.000201643540030183, 0.0003012398620611084, 0.0001299719165554861,
                    0.0002783824083258346, 0.0002615075807483206, 0.00010592750107296607,
                    0.0007066882567333455, 0.0005146538949292687, 0.00015502332039462273,
                    0.00027591056131041154, 0.000375455600318967, 0.00018262758571373423,
                    0.0001653746243126439, 0.00023683804760606683, 0.00022216581404420327,
                    5.1480799578064364e-5, 9.675315449196071e-5, 8.093089970484792e-5,
                    0.00021645281460265986, 4.942676924742433e-5, 0.000233148824906612,
                    0.00038252547549070246, 0.0001589283513455729, 0.000257966245608963,
                    0.00026561984881571203, 8.42717126936138e-5, 0.0005146538949292687,
                    0.0019439677607081577, 0.0001366845277314272, 0.00031568093710236265,
                    0.00040882836134845064, 0.00011027043542380369, 9.030467230474938e-5,
                    0.0001714607708223151, 0.00013911706362883784, 7.790676257401166e-5,
                    8.601790999002299e-5, 5.496516062563186e-5, 8.433028309486706e-5,
                    8.700516394740265e-5, 0.00010641666773812156, 0.00019596224949154916,
                    5.28057393828308e-5, 0.000132849766559161, 0.00011579204957172905,
                    6.693553167117217e-5, 0.00015502332039462273, 0.0001366845277314272,
                    0.0001436352172851801, 0.00023735176739157822, 0.00012453923992959516,
                    8.899958154385431e-5, 7.369814989009736e-5, 0.0001226191517173754,
                    5.341644192282571e-5, 5.1996679052246224e-5, 8.618756781520614e-5,
                    4.750366315109427e-5, 0.00014345481083735014, 0.0001158636847172581,
                    0.0001347303463380103, 0.0004193195638600682, 4.510803827117976e-5,
                    0.00019829711659373443, 0.00012759922926531037, 6.856120673910334e-5,
                    0.00027591056131041154, 0.00031568093710236265, 0.00023735176739157822,
                    0.0009937022125140937, 0.00018337851194591756, 8.089573878208514e-5,
                    4.34338140742378e-5, 0.00016606370973067152, 5.542001393778329e-5,
                    0.00014325660277128124, 0.00016999085519975963, 0.00010915511498243779,
                    0.00017111761799426715, 0.00016953522137142231, 0.0001316104216168032,
                    0.0003191830335731955, 0.00017614687334031512, 0.00021677991935265225,
                    0.0002127748410071772, 9.23396277812674e-5, 0.000375455600318967,
                    0.00040882836134845064, 0.00012453923992959516, 0.00018337851194591756,
                    0.0005054585590745467, 0.0001499453673847894, 9.674155293567803e-5,
                    0.0001784934477516111, 0.0001393689487786375, 0.00015522125913117145,
                    0.0001411416368818429, 0.0001632796562141103, 0.000173305005746987,
                    0.00018239537189463216, 0.00010368949258956979, 0.00029985536616429763,
                    8.988214610831593e-5, 0.00014571311832662146, 0.00012507579682467297,
                    6.635080485479108e-5, 0.00018262758571373423, 0.00011027043542380369,
                    8.899958154385431e-5, 8.089573878208514e-5, 0.0001499453673847894,
                    0.0001624387273643113, 0.00010286722457476836, 0.000136622038264165,
                    0.0001232689027484105, 0.00010117514765699439, 8.170385407265044e-5,
                    9.307746412009905e-5, 8.861019727227993e-5, 0.00011499607440590414,
                    8.53974373418592e-5, 0.00017286371044999122, 8.2016345483186e-5,
                    0.00010337654106752722, 8.573312465695285e-5, 6.436837688841065e-5,
                    0.0001653746243126439, 9.030467230474938e-5, 7.369814989009736e-5,
                    4.34338140742378e-5, 9.674155293567803e-5, 0.00010286722457476836,
                    0.00012202561764009547, 0.00010060272031673383, 7.873675826568531e-5,
                    0.0001324527662246249, 0.00013537668869838108, 0.00013178283695592825,
                    0.00014532455664746652, 0.00015343797950964755, 0.00013753235468608118,
                    0.00026800574694353993, 8.319717881514705e-5, 0.00021508714705077668,
                    0.00015986786609348467, 8.714022422364076e-5, 0.00023683804760606683,
                    0.0001714607708223151, 0.0001226191517173754, 0.00016606370973067152,
                    0.0001784934477516111, 0.000136622038264165, 0.00010060272031673383,
                    0.0001849011455817157, 0.00010358427734459658, 0.00013997417980781923,
                    0.00011367434981687041, 0.0001432009220906687, 0.00012303926468759977,
                    0.00017497627368280962, 0.00010342044243142224, 0.00018683198591124757,
                    8.778689490383852e-5, 0.00011334056341986459, 0.00011039343543086504,
                    5.627273793576809e-5, 0.00022216581404420327, 0.00013911706362883784,
                    5.341644192282571e-5, 5.542001393778329e-5, 0.0001393689487786375,
                    0.0001232689027484105, 7.873675826568531e-5, 0.00010358427734459658,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorGerberSB0(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.00020336718640442773, 0.00022311963565430497,
                    0.00025357733574058155, 0.00025792826083591535, 0.00015804505098612835,
                    0.0004554615114840393, 0.00014091716963080377, 0.00020098163052255401,
                    0.00018488076573425476, 0.0001134101382487112, 0.00030219644949499913,
                    0.00016162381694367583, 0.00012271231649902572, 0.00013705683425111674,
                    0.0002271027287259588, 0.00018113067530258674, 0.0001432100388860451,
                    0.0001776351989067306, 0.0001682680527201278, 0.00020336718640442773,
                    0.0002115234468410606, 0.00021228918709320454, 0.0002462564557676689,
                    0.0002509138849079012, 0.00015559987818534912, 0.00048147456245521583,
                    0.0001401724592019972, 0.00020983788005820623, 0.0001907888270015767,
                    0.0001126904707457878, 0.0003035275176139294, 0.00018701962411757952,
                    0.0001313590711924799, 0.0001839252787262815, 0.0002572270312419561,
                    0.0001794261700863628, 0.00013371712491497788, 0.0001811237988152389,
                    0.00016206403807904427, 0.00022311963565430497, 0.00021228918709320454,
                    0.0002572414426920628, 0.0002875274782387686, 0.00027578561053603543,
                    0.0001622203431710097, 0.00046874143923818446, 0.00012413485347068575,
                    0.00021521122904476274, 0.00019072279210702122, 0.00010159511352199167,
                    0.00033016908604709166, 0.00017512581093150471, 0.00011411578197908647,
                    0.00011457168709664085, 0.00021214745806779633, 0.00018880610630706696,
                    0.00014314200425585716, 0.00018195924727527606, 0.00018226050201006474,
                    0.00025357733574058155, 0.0002462564557676689, 0.0002875274782387686,
                    0.00040062774321407494, 0.0003264179730763416, 0.00019565143408634624,
                    0.0006432674662701455, 0.00015504017844542733, 0.00026024499666319595,
                    0.00022913034782873456, 0.00010738781741544029, 0.00042304646391379193,
                    0.0003710459697008578, 0.00014745781616573933, 0.0002574557287517324,
                    0.00029351377178350415, 0.00022555598269575393, 0.00015501413041554954,
                    0.00022275684991918422, 0.00020814336216184136, 0.00025792826083591535,
                    0.0002509138849079012, 0.00027578561053603543, 0.0003264179730763416,
                    0.0003311044630153933, 0.00019167151503344035, 0.0005549157485983496,
                    0.00016509314893323396, 0.0002445937889311112, 0.0002148729614262365,
                    0.00012971369785172085, 0.0003755857350140352, 0.00016827009061122053,
                    0.00014946665123258935, 0.000202344870580295, 0.00027475409273921056,
                    0.00022110640020281378, 0.00016694332615814115, 0.0002167820982126273,
                    0.00020859785875400148, 0.00015804505098612835, 0.00015559987818534912,
                    0.0001622203431710097, 0.00019565143408634624, 0.00019167151503344035,
                    0.00017908772525119756, 0.0003669148075742171, 0.00013279632092846368,
                    0.00020583225336226376, 0.00019225752574909323, 0.0001164201862934134,
                    0.00031618915285419315, 0.00037541217343451224, 0.00014127276329521863,
                    0.00024188538257432943, 0.0002295516968658166, 0.0001502739995715203,
                    0.0001286430004086361, 0.00017266567501797366, 0.0001462836461433723,
                    0.0004554615114840393, 0.00048147456245521583, 0.00046874143923818446,
                    0.0006432674662701455, 0.0005549157485983496, 0.0003669148075742171,
                    0.0016481856234771104, 0.0003182258550159473, 0.0005003407291900377,
                    0.00048764964648276814, 0.00023687321981482524, 0.0006245843631610877,
                    0.0006674232559008732, 0.00034360714944003885, 0.0006849166319528075,
                    0.000577081933976138, 0.00042894829690196456, 0.00029084823333423986,
                    0.00043693983442157986, 0.0003259733317965457, 0.00014091716963080377,
                    0.0001401724592019972, 0.00012413485347068575, 0.00015504017844542733,
                    0.00016509314893323396, 0.00013279632092846368, 0.0003182258550159473,
                    0.00016353541427233863, 0.00013986007356393875, 0.00015584805837902372,
                    0.00010862694098591737, 0.00023409823653783044, 0.00028653362122816613,
                    9.649930611345572e-5, 8.952881537867005e-5, 0.00023684109510458708,
                    0.0001321459556739025, 0.00011612724041069287, 0.00013347972004474357,
                    0.00013188386305794503, 0.00020098163052255401, 0.00020983788005820623,
                    0.00021521122904476274, 0.00026024499666319595, 0.0002445937889311112,
                    0.00020583225336226376, 0.0005003407291900377, 0.00013986007356393875,
                    0.00027619979891424485, 0.00024462632260635744, 0.0001251185343792846,
                    0.00041216568424921933, 0.00043963258871038656, 0.0001803536151231309,
                    0.00033926946412515905, 0.00030886617379146135, 0.00019137836739824184,
                    0.00015199381098839046, 0.00021942634319109132, 0.00017608661893444931,
                    0.00018488076573425476, 0.0001907888270015767, 0.00019072279210702122,
                    0.00022913034782873456, 0.0002148729614262365, 0.00019225752574909323,
                    0.00048764964648276814, 0.00015584805837902372, 0.00024462632260635744,
                    0.000243322112701978, 0.00012259467569989828, 0.0003672605655114797,
                    0.0004651659272681236, 0.0001576183256390155, 0.0002610899189537999,
                    0.0003052729046605527, 0.00017803708691959604, 0.00014201883949296234,
                    0.00019905469713880406, 0.00016833429020755966, 0.0001134101382487112,
                    0.0001126904707457878, 0.00010159511352199167, 0.00010738781741544029,
                    0.00012971369785172085, 0.0001164201862934134, 0.00023687321981482524,
                    0.00010862694098591737, 0.0001251185343792846, 0.00012259467569989828,
                    0.00010534978848760108, 0.00018461515764326415, 0.00016533234422046558,
                    0.00010044665411873955, 0.00013751847677329415, 0.00015762434122375954,
                    0.00010381880195027982, 9.663297109933786e-5, 0.0001178025008559761,
                    9.397271640108971e-5, 0.00030219644949499913, 0.0003035275176139294,
                    0.00033016908604709166, 0.00042304646391379193, 0.0003755857350140352,
                    0.00031618915285419315, 0.0006245843631610877, 0.00023409823653783044,
                    0.00041216568424921933, 0.0003672605655114797, 0.00018461515764326415,
                    0.0007066882567333455, 0.0008125746167028926, 0.00025128951498391833,
                    0.0004580073954766259, 0.0005117457797544199, 0.00028751961506558453,
                    0.00023123854423762308, 0.0003285287233288699, 0.0002963874669634183,
                    0.00016162381694367583, 0.00018701962411757952, 0.00017512581093150471,
                    0.0003710459697008578, 0.00016827009061122053, 0.00037541217343451224,
                    0.0006674232559008732, 0.00028653362122816613, 0.00043963258871038656,
                    0.0004651659272681236, 0.00016533234422046558, 0.0008125746167028926,
                    0.0019439677607081577, 0.000268056078515496, 0.0006600201095049302,
                    0.0006681327076224196, 0.00022861674372581223, 0.00018496237064983596,
                    0.0003207532139924447, 0.00026457913056208526, 0.00012271231649902572,
                    0.0001313590711924799, 0.00011411578197908647, 0.00014745781616573933,
                    0.00014946665123258935, 0.00014127276329521863, 0.00034360714944003885,
                    9.649930611345572e-5, 0.0001803536151231309, 0.0001576183256390155,
                    0.00010044665411873955, 0.00025128951498391833, 0.000268056078515496,
                    0.0001436352172851801, 0.00030793877421529, 0.0002022369567723876,
                    0.00012171467214607955, 0.00010264609219354, 0.00015059637829128276,
                    9.801814973152318e-5, 0.00013705683425111674, 0.0001839252787262815,
                    0.00011457168709664085, 0.0002574557287517324, 0.000202344870580295,
                    0.00024188538257432943, 0.0006849166319528075, 8.952881537867005e-5,
                    0.00033926946412515905, 0.0002610899189537999, 0.00013751847677329415,
                    0.0004580073954766259, 0.0006600201095049302, 0.00030793877421529,
                    0.0009937022125140937, 0.00036713698450208565, 0.0001688560135592612,
                    0.00010492106488019839, 0.0002678447681196256, 0.00010387072511800616,
                    0.0002271027287259588, 0.0002572270312419561, 0.00021214745806779633,
                    0.00029351377178350415, 0.00027475409273921056, 0.0002295516968658166,
                    0.000577081933976138, 0.00023684109510458708, 0.00030886617379146135,
                    0.0003052729046605527, 0.00015762434122375954, 0.0005117457797544199,
                    0.0006681327076224196, 0.0002022369567723876, 0.00036713698450208565,
                    0.0005054585590745467, 0.00022654656433144824, 0.00017142468858536293,
                    0.0002548547201008289, 0.00022132795591796978, 0.00018113067530258674,
                    0.0001794261700863628, 0.00018880610630706696, 0.00022555598269575393,
                    0.00022110640020281378, 0.0001502739995715203, 0.00042894829690196456,
                    0.0001321459556739025, 0.00019137836739824184, 0.00017803708691959604,
                    0.00010381880195027982, 0.00028751961506558453, 0.00022861674372581223,
                    0.00012171467214607955, 0.0001688560135592612, 0.00022654656433144824,
                    0.0001624387273643113, 0.00012914111569566902, 0.0001657398695931316,
                    0.00014882579909145463, 0.0001432100388860451, 0.00013371712491497788,
                    0.00014314200425585716, 0.00015501413041554954, 0.00016694332615814115,
                    0.0001286430004086361, 0.00029084823333423986, 0.00011612724041069287,
                    0.00015199381098839046, 0.00014201883949296234, 9.663297109933786e-5,
                    0.00023123854423762308, 0.00018496237064983596, 0.00010264609219354,
                    0.00010492106488019839, 0.00017142468858536293, 0.00012914111569566902,
                    0.00012202561764009547, 0.00013344540604363965, 0.00011935378992016367,
                    0.0001776351989067306, 0.0001811237988152389, 0.00018195924727527606,
                    0.00022275684991918422, 0.0002167820982126273, 0.00017266567501797366,
                    0.00043693983442157986, 0.00013347972004474357, 0.00021942634319109132,
                    0.00019905469713880406, 0.0001178025008559761, 0.0003285287233288699,
                    0.0003207532139924447, 0.00015059637829128276, 0.0002678447681196256,
                    0.0002548547201008289, 0.0001657398695931316, 0.00013344540604363965,
                    0.0001849011455817157, 0.0001502016173286536, 0.0001682680527201278,
                    0.00016206403807904427, 0.00018226050201006474, 0.00020814336216184136,
                    0.00020859785875400148, 0.0001462836461433723, 0.0003259733317965457,
                    0.00013188386305794503, 0.00017608661893444931, 0.00016833429020755966,
                    9.397271640108971e-5, 0.0002963874669634183, 0.00026457913056208526,
                    9.801814973152318e-5, 0.00010387072511800616, 0.00022132795591796978,
                    0.00014882579909145463, 0.00011935378992016367, 0.0001502016173286536,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorGerberSB1(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.00020336718640442773, 0.00022311963565430497,
                    0.00025357733574058155, 0.00025792826083591535, 0.00015804505098612835,
                    0.0004554615114840393, 0.00014091716963080377, 0.00020098163052255401,
                    0.00018488076573425476, 0.0001134101382487112, 0.00030219644949499913,
                    0.00016162381694367583, 0.00012271231649902572, 0.00013705683425111674,
                    0.0002271027287259588, 0.00018113067530258674, 0.0001432100388860451,
                    0.0001776351989067306, 0.0001682680527201278, 0.00020336718640442773,
                    0.0002115234468410606, 0.00021228918709320454, 0.0002462564557676689,
                    0.0002509138849079012, 0.00015559987818534912, 0.00048147456245521583,
                    0.0001401724592019972, 0.00020983788005820623, 0.0001907888270015767,
                    0.0001126904707457878, 0.0003035275176139294, 0.00018701962411757952,
                    0.0001313590711924799, 0.0001839252787262815, 0.0002572270312419561,
                    0.0001794261700863628, 0.00013371712491497788, 0.0001811237988152389,
                    0.00016206403807904427, 0.00022311963565430497, 0.00021228918709320454,
                    0.0002572414426920628, 0.0002875274782387686, 0.00027578561053603543,
                    0.0001622203431710097, 0.00046874143923818446, 0.00012413485347068575,
                    0.00021521122904476274, 0.00019072279210702122, 0.00010159511352199167,
                    0.00033016908604709166, 0.00017512581093150471, 0.00011411578197908647,
                    0.00011457168709664085, 0.00021214745806779633, 0.00018880610630706696,
                    0.00014314200425585716, 0.00018195924727527606, 0.00018226050201006474,
                    0.00025357733574058155, 0.0002462564557676689, 0.0002875274782387686,
                    0.00040062774321407494, 0.0003264179730763416, 0.00019565143408634624,
                    0.0006432674662701455, 0.00015504017844542733, 0.00026024499666319595,
                    0.00022913034782873456, 0.00010738781741544029, 0.00042304646391379193,
                    0.0003710459697008578, 0.00014745781616573933, 0.0002574557287517324,
                    0.00029351377178350415, 0.00022555598269575393, 0.00015501413041554954,
                    0.00022275684991918422, 0.00020814336216184136, 0.00025792826083591535,
                    0.0002509138849079012, 0.00027578561053603543, 0.0003264179730763416,
                    0.0003311044630153933, 0.00019167151503344035, 0.0005549157485983496,
                    0.00016509314893323396, 0.0002445937889311112, 0.0002148729614262365,
                    0.00012971369785172085, 0.0003755857350140352, 0.00016827009061122053,
                    0.00014946665123258935, 0.000202344870580295, 0.00027475409273921056,
                    0.00022110640020281378, 0.00016694332615814115, 0.0002167820982126273,
                    0.00020859785875400148, 0.00015804505098612835, 0.00015559987818534912,
                    0.0001622203431710097, 0.00019565143408634624, 0.00019167151503344035,
                    0.00017908772525119756, 0.0003669148075742171, 0.00013279632092846368,
                    0.00020583225336226376, 0.00019225752574909323, 0.0001164201862934134,
                    0.00031618915285419315, 0.00037541217343451224, 0.00014127276329521863,
                    0.00024188538257432943, 0.0002295516968658166, 0.0001502739995715203,
                    0.0001286430004086361, 0.00017266567501797366, 0.0001462836461433723,
                    0.0004554615114840393, 0.00048147456245521583, 0.00046874143923818446,
                    0.0006432674662701455, 0.0005549157485983496, 0.0003669148075742171,
                    0.0016481856234771104, 0.0003182258550159473, 0.0005003407291900377,
                    0.00048764964648276814, 0.00023687321981482524, 0.0006245843631610877,
                    0.0006674232559008732, 0.00034360714944003885, 0.0006849166319528075,
                    0.000577081933976138, 0.00042894829690196456, 0.00029084823333423986,
                    0.00043693983442157986, 0.0003259733317965457, 0.00014091716963080377,
                    0.0001401724592019972, 0.00012413485347068575, 0.00015504017844542733,
                    0.00016509314893323396, 0.00013279632092846368, 0.0003182258550159473,
                    0.00016353541427233863, 0.00013986007356393875, 0.00015584805837902372,
                    0.00010862694098591737, 0.00023409823653783044, 0.00028653362122816613,
                    9.649930611345572e-5, 8.952881537867005e-5, 0.00023684109510458708,
                    0.0001321459556739025, 0.00011612724041069287, 0.00013347972004474357,
                    0.00013188386305794503, 0.00020098163052255401, 0.00020983788005820623,
                    0.00021521122904476274, 0.00026024499666319595, 0.0002445937889311112,
                    0.00020583225336226376, 0.0005003407291900377, 0.00013986007356393875,
                    0.00027619979891424485, 0.00024462632260635744, 0.0001251185343792846,
                    0.00041216568424921933, 0.00043963258871038656, 0.0001803536151231309,
                    0.00033926946412515905, 0.00030886617379146135, 0.00019137836739824184,
                    0.00015199381098839046, 0.00021942634319109132, 0.00017608661893444931,
                    0.00018488076573425476, 0.0001907888270015767, 0.00019072279210702122,
                    0.00022913034782873456, 0.0002148729614262365, 0.00019225752574909323,
                    0.00048764964648276814, 0.00015584805837902372, 0.00024462632260635744,
                    0.000243322112701978, 0.00012259467569989828, 0.0003672605655114797,
                    0.0004651659272681236, 0.0001576183256390155, 0.0002610899189537999,
                    0.0003052729046605527, 0.00017803708691959604, 0.00014201883949296234,
                    0.00019905469713880406, 0.00016833429020755966, 0.0001134101382487112,
                    0.0001126904707457878, 0.00010159511352199167, 0.00010738781741544029,
                    0.00012971369785172085, 0.0001164201862934134, 0.00023687321981482524,
                    0.00010862694098591737, 0.0001251185343792846, 0.00012259467569989828,
                    0.00010534978848760108, 0.00018461515764326415, 0.00016533234422046558,
                    0.00010044665411873955, 0.00013751847677329415, 0.00015762434122375954,
                    0.00010381880195027982, 9.663297109933786e-5, 0.0001178025008559761,
                    9.397271640108971e-5, 0.00030219644949499913, 0.0003035275176139294,
                    0.00033016908604709166, 0.00042304646391379193, 0.0003755857350140352,
                    0.00031618915285419315, 0.0006245843631610877, 0.00023409823653783044,
                    0.00041216568424921933, 0.0003672605655114797, 0.00018461515764326415,
                    0.0007066882567333455, 0.0008125746167028926, 0.00025128951498391833,
                    0.0004580073954766259, 0.0005117457797544199, 0.00028751961506558453,
                    0.00023123854423762308, 0.0003285287233288699, 0.0002963874669634183,
                    0.00016162381694367583, 0.00018701962411757952, 0.00017512581093150471,
                    0.0003710459697008578, 0.00016827009061122053, 0.00037541217343451224,
                    0.0006674232559008732, 0.00028653362122816613, 0.00043963258871038656,
                    0.0004651659272681236, 0.00016533234422046558, 0.0008125746167028926,
                    0.0019439677607081577, 0.000268056078515496, 0.0006600201095049302,
                    0.0006681327076224196, 0.00022861674372581223, 0.00018496237064983596,
                    0.0003207532139924447, 0.00026457913056208526, 0.00012271231649902572,
                    0.0001313590711924799, 0.00011411578197908647, 0.00014745781616573933,
                    0.00014946665123258935, 0.00014127276329521863, 0.00034360714944003885,
                    9.649930611345572e-5, 0.0001803536151231309, 0.0001576183256390155,
                    0.00010044665411873955, 0.00025128951498391833, 0.000268056078515496,
                    0.0001436352172851801, 0.00030793877421529, 0.0002022369567723876,
                    0.00012171467214607955, 0.00010264609219354, 0.00015059637829128276,
                    9.801814973152318e-5, 0.00013705683425111674, 0.0001839252787262815,
                    0.00011457168709664085, 0.0002574557287517324, 0.000202344870580295,
                    0.00024188538257432943, 0.0006849166319528075, 8.952881537867005e-5,
                    0.00033926946412515905, 0.0002610899189537999, 0.00013751847677329415,
                    0.0004580073954766259, 0.0006600201095049302, 0.00030793877421529,
                    0.0009937022125140937, 0.00036713698450208565, 0.0001688560135592612,
                    0.00010492106488019839, 0.0002678447681196256, 0.00010387072511800616,
                    0.0002271027287259588, 0.0002572270312419561, 0.00021214745806779633,
                    0.00029351377178350415, 0.00027475409273921056, 0.0002295516968658166,
                    0.000577081933976138, 0.00023684109510458708, 0.00030886617379146135,
                    0.0003052729046605527, 0.00015762434122375954, 0.0005117457797544199,
                    0.0006681327076224196, 0.0002022369567723876, 0.00036713698450208565,
                    0.0005054585590745467, 0.00022654656433144824, 0.00017142468858536293,
                    0.0002548547201008289, 0.00022132795591796978, 0.00018113067530258674,
                    0.0001794261700863628, 0.00018880610630706696, 0.00022555598269575393,
                    0.00022110640020281378, 0.0001502739995715203, 0.00042894829690196456,
                    0.0001321459556739025, 0.00019137836739824184, 0.00017803708691959604,
                    0.00010381880195027982, 0.00028751961506558453, 0.00022861674372581223,
                    0.00012171467214607955, 0.0001688560135592612, 0.00022654656433144824,
                    0.0001624387273643113, 0.00012914111569566902, 0.0001657398695931316,
                    0.00014882579909145463, 0.0001432100388860451, 0.00013371712491497788,
                    0.00014314200425585716, 0.00015501413041554954, 0.00016694332615814115,
                    0.0001286430004086361, 0.00029084823333423986, 0.00011612724041069287,
                    0.00015199381098839046, 0.00014201883949296234, 9.663297109933786e-5,
                    0.00023123854423762308, 0.00018496237064983596, 0.00010264609219354,
                    0.00010492106488019839, 0.00017142468858536293, 0.00012914111569566902,
                    0.00012202561764009547, 0.00013344540604363965, 0.00011935378992016367,
                    0.0001776351989067306, 0.0001811237988152389, 0.00018195924727527606,
                    0.00022275684991918422, 0.0002167820982126273, 0.00017266567501797366,
                    0.00043693983442157986, 0.00013347972004474357, 0.00021942634319109132,
                    0.00019905469713880406, 0.0001178025008559761, 0.0003285287233288699,
                    0.0003207532139924447, 0.00015059637829128276, 0.0002678447681196256,
                    0.0002548547201008289, 0.0001657398695931316, 0.00013344540604363965,
                    0.0001849011455817157, 0.0001502016173286536, 0.0001682680527201278,
                    0.00016206403807904427, 0.00018226050201006474, 0.00020814336216184136,
                    0.00020859785875400148, 0.0001462836461433723, 0.0003259733317965457,
                    0.00013188386305794503, 0.00017608661893444931, 0.00016833429020755966,
                    9.397271640108971e-5, 0.0002963874669634183, 0.00026457913056208526,
                    9.801814973152318e-5, 0.00010387072511800616, 0.00022132795591796978,
                    0.00014882579909145463, 0.00011935378992016367, 0.0001502016173286536,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    normalise = true
    c1 = PortCovCor(; ce = CorGerber0(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.0001422907066898958, 0.00019789463183933395,
                    0.00020278969160037992, 0.00023067055091727947, 9.947634991047541e-5,
                    0.00028171911251416237, 8.993708315532105e-5, 0.00013642298908123434,
                    0.00011840628330476878, 6.752497246110296e-5, 0.000200518440117124,
                    5.7729203309252675e-5, 7.506567167986791e-5, 7.032097761145192e-5,
                    0.00011596921643080252, 0.00014802255492478984, 9.195303470054695e-5,
                    0.0001247100838667095, 0.00012762015312529535, 0.0001422907066898958,
                    0.0002115234468410606, 0.00014938103222274888, 0.0001500324208391651,
                    0.00016466994975681832, 0.0001023270213146163, 0.0002755562170100739,
                    8.788080394912214e-5, 0.0001366291275950294, 0.0001134623334397279,
                    6.902053672101994e-5, 0.00018980828268814988, 8.913941255933546e-5,
                    7.816089949506301e-5, 8.683625343213574e-5, 0.00014700222612024945,
                    0.00013428782636342227, 8.130204400938743e-5, 0.0001280028412890248,
                    0.00010428479686266401, 0.00019789463183933395, 0.00014938103222274888,
                    0.0002572414426920628, 0.00020092152616341832, 0.00023675190645477465,
                    9.326171755851005e-5, 0.0002664000205037562, 5.2203614877590157e-5,
                    0.00014291389049617825, 0.0001094511124132458, 5.9765368642462355e-5,
                    0.0002044400177250481, 8.520168584820136e-5, 5.0479308952421754e-5,
                    5.227261395695933e-5, 8.925017663763173e-5, 0.00015022237375205148,
                    8.286520385404205e-5, 0.0001259143103637213, 0.0001273773717499887,
                    0.00020278969160037992, 0.0001500324208391651, 0.00020092152616341832,
                    0.00040062774321407494, 0.0002376624295113324, 0.00010782333427797242,
                    0.000370061138554396, 7.684697604542317e-5, 0.00014428855149909968,
                    0.00012938995590630305, 5.2677130420733563e-5, 0.00025766663074800936,
                    0.0002130954462258189, 8.353433154849577e-5, 0.00015062031883659628,
                    0.00016021138322391896, 0.00016166075022394863, 7.951104593558542e-5,
                    0.00013895141382043525, 0.00011591951776438308, 0.00023067055091727947,
                    0.00016466994975681832, 0.00023675190645477465, 0.0002376624295113324,
                    0.0003311044630153933, 0.00010854014791882233, 0.00031568973273224393,
                    0.00010685879997340012, 0.00014622374664132842, 0.0001082397657435502,
                    6.909600675519659e-5, 0.00019728067899126846, 3.329178149408335e-5,
                    7.424787498499347e-5, 0.00013373928899331757, 0.00012247291990312559,
                    0.00017833535102201008, 8.87205909243229e-5, 0.00014064414424978634,
                    0.0001544752238058908, 9.947634991047541e-5, 0.0001023270213146163,
                    9.326171755851005e-5, 0.00010782333427797242, 0.00010854014791882233,
                    0.00017908772525119756, 0.00020810694920032669, 8.428025488128669e-5,
                    0.00015847874779278422, 0.0001478375253808285, 7.323114571908173e-5,
                    0.0001989308597979147, 0.0002138295662678656, 0.00010962797897326309,
                    0.00014212059794791983, 0.00011189021051455369, 9.44041210109178e-5,
                    8.362433043719506e-5, 0.00013526747676717078, 0.00010711378069148065,
                    0.00028171911251416237, 0.0002755562170100739, 0.0002664000205037562,
                    0.000370061138554396, 0.00031568973273224393, 0.00020810694920032669,
                    0.0016481856234771104, 0.00016452144238695288, 0.00030744882844788206,
                    0.00030090847609089735, 0.00012811275581359684, 0.0003479603062268905,
                    0.0003545382943407243, 0.00019189005676307306, 0.0004122223632246836,
                    0.0002710401163448616, 0.00027652029454353, 0.00016707203331175682,
                    0.0002704699947266547, 0.00015946726047544346, 8.993708315532105e-5,
                    8.788080394912214e-5, 5.2203614877590157e-5, 7.684697604542317e-5,
                    0.00010685879997340012, 8.428025488128669e-5, 0.00016452144238695288,
                    0.00016353541427233863, 7.387202595592946e-5, 9.611538456245509e-5,
                    7.107754652063551e-5, 0.00012789444392685757, 0.00017292110841210452,
                    4.911505263671713e-5, 4.830438886500954e-5, 0.0001479472637103127,
                    9.210038441034675e-5, 7.775262964918079e-5, 7.888489208426052e-5,
                    8.832608729371644e-5, 0.00013642298908123434, 0.0001366291275950294,
                    0.00014291389049617825, 0.00014428855149909968, 0.00014622374664132842,
                    0.00015847874779278422, 0.00030744882844788206, 7.387202595592946e-5,
                    0.00027619979891424485, 0.00017729280039767233, 6.668743090855942e-5,
                    0.00027678602440295, 0.00028802065974027033, 0.00013271617456378498,
                    0.0002041285525953288, 0.000205572970967119, 0.0001370508211805871,
                    9.858171272795948e-5, 0.00021508842583157988, 0.00011117088077450627,
                    0.00011840628330476878, 0.0001134623334397279, 0.0001094511124132458,
                    0.00012938995590630305, 0.0001082397657435502, 0.0001478375253808285,
                    0.00030090847609089735, 9.611538456245509e-5, 0.00017729280039767233,
                    0.000243322112701978, 6.725833220876965e-5, 0.0002713491650489618,
                    0.00025707884452996673, 0.00011026291262998278, 0.000139304263504855,
                    0.00019904420997889836, 0.00012256150992200272, 8.647437357171948e-5,
                    0.0001520952023654184, 0.00010996064402617992, 6.752497246110296e-5,
                    6.902053672101994e-5, 5.9765368642462355e-5, 5.2677130420733563e-5,
                    6.909600675519659e-5, 7.323114571908173e-5, 0.00012811275581359684,
                    7.107754652063551e-5, 6.668743090855942e-5, 6.725833220876965e-5,
                    0.00010534978848760108, 0.00010689328073880039, 9.894869227668554e-5,
                    6.506203346328425e-5, 7.310297795915102e-5, 8.78529093636581e-5,
                    5.961772128830967e-5, 5.938182433344852e-5, 7.967374559734924e-5,
                    5.009070828409618e-5, 0.000200518440117124, 0.00018980828268814988,
                    0.0002044400177250481, 0.00025766663074800936, 0.00019728067899126846,
                    0.0001989308597979147, 0.0003479603062268905, 0.00012789444392685757,
                    0.00027678602440295, 0.0002713491650489618, 0.00010689328073880039,
                    0.0007066882567333455, 0.0004900894263650999, 0.00014852397945073445,
                    0.0002904010067522936, 0.0003516872335891592, 0.0001735824588221088,
                    0.0001554629821742212, 0.00023586868923813865, 0.00021600648320683718,
                    5.7729203309252675e-5, 8.913941255933546e-5, 8.520168584820136e-5,
                    0.0002130954462258189, 3.329178149408335e-5, 0.0002138295662678656,
                    0.0003545382943407243, 0.00017292110841210452, 0.00028802065974027033,
                    0.00025707884452996673, 9.894869227668554e-5, 0.0004900894263650999,
                    0.0019439677607081577, 0.00013167072237007057, 0.00037047013671777607,
                    0.00043024157400854923, 0.0001098458810664705, 9.658773832846556e-5,
                    0.00018830260048468205, 0.00014927051642466953, 7.506567167986791e-5,
                    7.816089949506301e-5, 5.0479308952421754e-5, 8.353433154849577e-5,
                    7.424787498499347e-5, 0.00010962797897326309, 0.00019189005676307306,
                    4.911505263671713e-5, 0.00013271617456378498, 0.00011026291262998278,
                    6.506203346328425e-5, 0.00014852397945073445, 0.00013167072237007057,
                    0.0001436352172851801, 0.00023055100006315598, 0.00011338719586269228,
                    8.517164898980354e-5, 6.808460286572237e-5, 0.00012155402397240526,
                    4.8873766961374304e-5, 7.032097761145192e-5, 8.683625343213574e-5,
                    5.227261395695933e-5, 0.00015062031883659628, 0.00013373928899331757,
                    0.00014212059794791983, 0.0004122223632246836, 4.830438886500954e-5,
                    0.0002041285525953288, 0.000139304263504855, 7.310297795915102e-5,
                    0.0002904010067522936, 0.00037047013671777607, 0.00023055100006315598,
                    0.0009937022125140937, 0.00021305743687991208, 7.89152861907386e-5,
                    5.170896421589945e-5, 0.00015860242815331598, 5.6660819223117176e-5,
                    0.00011596921643080252, 0.00014700222612024945, 8.925017663763173e-5,
                    0.00016021138322391896, 0.00012247291990312559, 0.00011189021051455369,
                    0.0002710401163448616, 0.0001479472637103127, 0.000205572970967119,
                    0.00019904420997889836, 8.78529093636581e-5, 0.0003516872335891592,
                    0.00043024157400854923, 0.00011338719586269228, 0.00021305743687991208,
                    0.0005054585590745467, 0.0001270043412745275, 8.9422843041158e-5,
                    0.00016410849862885752, 0.000133931726070964, 0.00014802255492478984,
                    0.00013428782636342227, 0.00015022237375205148, 0.00016166075022394863,
                    0.00017833535102201008, 9.44041210109178e-5, 0.00027652029454353,
                    9.210038441034675e-5, 0.0001370508211805871, 0.00012256150992200272,
                    5.961772128830967e-5, 0.0001735824588221088, 0.0001098458810664705,
                    8.517164898980354e-5, 7.89152861907386e-5, 0.0001270043412745275,
                    0.0001624387273643113, 9.404461357171387e-5, 0.00013088559480376442,
                    0.00012130473637947547, 9.195303470054695e-5, 8.130204400938743e-5,
                    8.286520385404205e-5, 7.951104593558542e-5, 8.87205909243229e-5,
                    8.362433043719506e-5, 0.00016707203331175682, 7.775262964918079e-5,
                    9.858171272795948e-5, 8.647437357171948e-5, 5.938182433344852e-5,
                    0.0001554629821742212, 9.658773832846556e-5, 6.808460286572237e-5,
                    5.170896421589945e-5, 8.9422843041158e-5, 9.404461357171387e-5,
                    0.00012202561764009547, 9.17861896559567e-5, 7.664190956858138e-5,
                    0.0001247100838667095, 0.0001280028412890248, 0.0001259143103637213,
                    0.00013895141382043525, 0.00014064414424978634, 0.00013526747676717078,
                    0.0002704699947266547, 7.888489208426052e-5, 0.00021508842583157988,
                    0.0001520952023654184, 7.967374559734924e-5, 0.00023586868923813865,
                    0.00018830260048468205, 0.00012155402397240526, 0.00015860242815331598,
                    0.00016410849862885752, 0.00013088559480376442, 9.17861896559567e-5,
                    0.0001849011455817157, 0.00010057683791594954, 0.00012762015312529535,
                    0.00010428479686266401, 0.0001273773717499887, 0.00011591951776438308,
                    0.0001544752238058908, 0.00010711378069148065, 0.00015946726047544346,
                    8.832608729371644e-5, 0.00011117088077450627, 0.00010996064402617992,
                    5.009070828409618e-5, 0.00021600648320683718, 0.00014927051642466953,
                    4.8873766961374304e-5, 5.6660819223117176e-5, 0.000133931726070964,
                    0.00012130473637947547, 7.664190956858138e-5, 0.00010057683791594954,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorGerber1(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 6.0361599739655027e-5, 0.00010213180134457275,
                    8.384989736522444e-5, 0.00011128793835053006, 3.9979795118900033e-5,
                    9.820639448926798e-5, 3.2824010133967134e-5, 5.615413407790034e-5,
                    4.853726748595011e-5, 2.530646757214246e-5, 7.066369028327967e-5,
                    2.0390251171750888e-5, 2.8898483503023622e-5, 2.812045874382062e-5,
                    4.13774887643237e-5, 7.070413203297526e-5, 3.7586241289292057e-5,
                    5.215765275782933e-5, 5.0892191031797965e-5, 6.0361599739655027e-5,
                    0.0002115234468410606, 6.762407799582329e-5, 6.128527766515489e-5,
                    6.877257450089247e-5, 4.0342832293317586e-5, 9.069591261730147e-5,
                    3.287369338837356e-5, 5.334498153266961e-5, 4.311486826362475e-5,
                    2.7101083172008594e-5, 6.638444133190413e-5, 3.0220663181978394e-5,
                    3.059898841681708e-5, 3.428413426626439e-5, 5.328956575990345e-5,
                    5.8290385376917734e-5, 3.2029284482679426e-5, 5.194455954829966e-5,
                    4.356596376046935e-5, 0.00010213180134457275, 6.762407799582329e-5,
                    0.0002572414426920628, 8.260622063209745e-5, 0.00010974965288521437,
                    3.914967961795868e-5, 9.24329429517602e-5, 1.944123797501404e-5,
                    5.671321784641703e-5, 4.3725340927239116e-5, 2.4361071089720258e-5,
                    7.039091150390745e-5, 2.8990274331175793e-5, 1.9761042109607406e-5,
                    2.0606293959436287e-5, 3.303980909758129e-5, 6.835469558146614e-5,
                    3.251897787194481e-5, 4.9597307096479376e-5, 5.161260462672792e-5,
                    8.384989736522444e-5, 6.128527766515489e-5, 8.260622063209745e-5,
                    0.00040062774321407494, 9.176520635223037e-5, 4.24450733509276e-5,
                    0.00013649536885528913, 2.795898558062375e-5, 5.776485879906311e-5,
                    5.297433504211756e-5, 2.096337815714719e-5, 8.732138784049224e-5,
                    7.72993279801323e-5, 3.157321240648539e-5, 6.20911214743412e-5,
                    5.5395235505876526e-5, 6.87263368295024e-5, 3.119447603214407e-5,
                    5.712210638879194e-5, 4.7582438163447656e-5, 0.00011128793835053006,
                    6.877257450089247e-5, 0.00010974965288521437, 9.176520635223037e-5,
                    0.0003311044630153933, 4.110686358754979e-5, 0.00011496787207967655,
                    3.7471133002296914e-5, 5.8009204705217295e-5, 4.264260049063499e-5,
                    2.7499385465663175e-5, 6.564249680293548e-5, 1.0776922337867614e-5,
                    2.6361145490510014e-5, 5.253711876826162e-5, 4.376068044844988e-5,
                    7.755450012546453e-5, 3.136710636337601e-5, 5.538287775207809e-5,
                    5.875406955185643e-5, 3.9979795118900033e-5, 4.0342832293317586e-5,
                    3.914967961795868e-5, 4.24450733509276e-5, 4.110686358754979e-5,
                    0.00017908772525119756, 7.08270539695304e-5, 3.0744442046956937e-5,
                    6.26684900507608e-5, 6.177919887854576e-5, 3.0779618982509974e-5,
                    7.723554213023251e-5, 7.496701991063121e-5, 4.153492555989657e-5,
                    5.599817249994873e-5, 4.146575230594868e-5, 4.339534905506263e-5,
                    3.264055137564756e-5, 5.5319251423178206e-5, 4.0387959359408326e-5,
                    9.820639448926798e-5, 9.069591261730147e-5, 9.24329429517602e-5,
                    0.00013649536885528913, 0.00011496787207967655, 7.08270539695304e-5,
                    0.0016481856234771104, 5.333359956549902e-5, 0.00011994777962070845,
                    0.00010136296595660454, 4.4356003555970656e-5, 0.00010139332519990304,
                    0.00011408051306718691, 6.214588155638237e-5, 0.00014620493022191695,
                    8.818718676351976e-5, 9.993888667560119e-5, 5.3929337114287886e-5,
                    8.770775715460813e-5, 5.460132957074539e-5, 3.2824010133967134e-5,
                    3.287369338837356e-5, 1.944123797501404e-5, 2.795898558062375e-5,
                    3.7471133002296914e-5, 3.0744442046956937e-5, 5.333359956549902e-5,
                    0.00016353541427233863, 2.6242110885245204e-5, 3.596150526576588e-5,
                    2.7812094899895113e-5, 4.584902642319197e-5, 5.998222660773463e-5,
                    1.857729283796686e-5, 1.7016698218624954e-5, 5.636466829513969e-5,
                    3.4871455008564245e-5, 2.677990000411334e-5, 2.911909437148394e-5,
                    3.150283148213823e-5, 5.615413407790034e-5, 5.334498153266961e-5,
                    5.671321784641703e-5, 5.776485879906311e-5, 5.8009204705217295e-5,
                    6.26684900507608e-5, 0.00011994777962070845, 2.6242110885245204e-5,
                    0.00027619979891424485, 7.808919506690668e-5, 2.7968090942596292e-5,
                    9.832949930537614e-5, 0.00010422287808377349, 5.315496046041192e-5,
                    8.244329044308585e-5, 8.140453091177969e-5, 6.550632899011393e-5,
                    4.1697538708161844e-5, 0.00014425505944347554, 4.4372358984830375e-5,
                    4.853726748595011e-5, 4.311486826362475e-5, 4.3725340927239116e-5,
                    5.297433504211756e-5, 4.264260049063499e-5, 6.177919887854576e-5,
                    0.00010136296595660454, 3.596150526576588e-5, 7.808919506690668e-5,
                    0.000243322112701978, 2.829561222584897e-5, 0.000103831260335864,
                    9.970448582485367e-5, 4.195072262861632e-5, 5.6357728702984445e-5,
                    7.781116850079112e-5, 4.707090430153278e-5, 3.592090409012511e-5,
                    6.402693075661046e-5, 4.4626498532312846e-5, 2.530646757214246e-5,
                    2.7101083172008594e-5, 2.4361071089720258e-5, 2.096337815714719e-5,
                    2.7499385465663175e-5, 3.0779618982509974e-5, 4.4356003555970656e-5,
                    2.7812094899895113e-5, 2.7968090942596292e-5, 2.829561222584897e-5,
                    0.00010534978848760108, 3.892003393725329e-5, 3.515529891012128e-5,
                    2.6903065914650267e-5, 3.138599181394963e-5, 3.311503568175917e-5,
                    2.5388038368862397e-5, 2.2271373405093566e-5, 3.383472742044376e-5,
                    2.0801996076647175e-5, 7.066369028327967e-5, 6.638444133190413e-5,
                    7.039091150390745e-5, 8.732138784049224e-5, 6.564249680293548e-5,
                    7.723554213023251e-5, 0.00010139332519990304, 4.584902642319197e-5,
                    9.832949930537614e-5, 0.000103831260335864, 3.892003393725329e-5,
                    0.0007066882567333455, 0.00016538598265149562, 4.741938569795753e-5,
                    0.00010996330641671114, 0.00011953269476814119, 6.637074638160052e-5,
                    5.0102510765237595e-5, 8.179046879304735e-5, 7.744275265311925e-5,
                    2.0390251171750888e-5, 3.0220663181978394e-5, 2.8990274331175793e-5,
                    7.72993279801323e-5, 1.0776922337867614e-5, 7.496701991063121e-5,
                    0.00011408051306718691, 5.998222660773463e-5, 0.00010422287808377349,
                    9.970448582485367e-5, 3.515529891012128e-5, 0.00016538598265149562,
                    0.0019439677607081577, 4.7250208273053016e-5, 0.00014777301613244802,
                    0.00014763437460105227, 3.9148158115896e-5, 3.3690404300306705e-5,
                    6.95243561825685e-5, 5.818835067910558e-5, 2.8898483503023622e-5,
                    3.059898841681708e-5, 1.9761042109607406e-5, 3.157321240648539e-5,
                    2.6361145490510014e-5, 4.153492555989657e-5, 6.214588155638237e-5,
                    1.857729283796686e-5, 5.315496046041192e-5, 4.195072262861632e-5,
                    2.6903065914650267e-5, 4.741938569795753e-5, 4.7250208273053016e-5,
                    0.0001436352172851801, 9.514889407379635e-5, 4.012140859015808e-5,
                    3.616461257122946e-5, 2.6143412662981437e-5, 4.853255898444506e-5,
                    1.8288139189505958e-5, 2.812045874382062e-5, 3.428413426626439e-5,
                    2.0606293959436287e-5, 6.20911214743412e-5, 5.253711876826162e-5,
                    5.599817249994873e-5, 0.00014620493022191695, 1.7016698218624954e-5,
                    8.244329044308585e-5, 5.6357728702984445e-5, 3.138599181394963e-5,
                    0.00010996330641671114, 0.00014777301613244802, 9.514889407379635e-5,
                    0.0009937022125140937, 8.300252027147743e-5, 3.338286894763107e-5,
                    1.9373876572764592e-5, 5.9551281965417546e-5, 2.3333646340099204e-5,
                    4.13774887643237e-5, 5.328956575990345e-5, 3.303980909758129e-5,
                    5.5395235505876526e-5, 4.376068044844988e-5, 4.146575230594868e-5,
                    8.818718676351976e-5, 5.636466829513969e-5, 8.140453091177969e-5,
                    7.781116850079112e-5, 3.311503568175917e-5, 0.00011953269476814119,
                    0.00014763437460105227, 4.012140859015808e-5, 8.300252027147743e-5,
                    0.0005054585590745467, 4.8128280886385126e-5, 3.223804624598108e-5,
                    6.420447243166779e-5, 4.947052347304861e-5, 7.070413203297526e-5,
                    5.8290385376917734e-5, 6.835469558146614e-5, 6.87263368295024e-5,
                    7.755450012546453e-5, 4.339534905506263e-5, 9.993888667560119e-5,
                    3.4871455008564245e-5, 6.550632899011393e-5, 4.707090430153278e-5,
                    2.5388038368862397e-5, 6.637074638160052e-5, 3.9148158115896e-5,
                    3.616461257122946e-5, 3.338286894763107e-5, 4.8128280886385126e-5,
                    0.0001624387273643113, 3.9243690099152265e-5, 6.054614463746359e-5,
                    4.95528779285145e-5, 3.7586241289292057e-5, 3.2029284482679426e-5,
                    3.251897787194481e-5, 3.119447603214407e-5, 3.136710636337601e-5,
                    3.264055137564756e-5, 5.3929337114287886e-5, 2.677990000411334e-5,
                    4.1697538708161844e-5, 3.592090409012511e-5, 2.2271373405093566e-5,
                    5.0102510765237595e-5, 3.3690404300306705e-5, 2.6143412662981437e-5,
                    1.9373876572764592e-5, 3.223804624598108e-5, 3.9243690099152265e-5,
                    0.00012202561764009547, 3.914235214280701e-5, 3.230055411053708e-5,
                    5.215765275782933e-5, 5.194455954829966e-5, 4.9597307096479376e-5,
                    5.712210638879194e-5, 5.538287775207809e-5, 5.5319251423178206e-5,
                    8.770775715460813e-5, 2.911909437148394e-5, 0.00014425505944347554,
                    6.402693075661046e-5, 3.383472742044376e-5, 8.179046879304735e-5,
                    6.95243561825685e-5, 4.853255898444506e-5, 5.9551281965417546e-5,
                    6.420447243166779e-5, 6.054614463746359e-5, 3.914235214280701e-5,
                    0.0001849011455817157, 4.0310296740851806e-5, 5.0892191031797965e-5,
                    4.356596376046935e-5, 5.161260462672792e-5, 4.7582438163447656e-5,
                    5.875406955185643e-5, 4.0387959359408326e-5, 5.460132957074539e-5,
                    3.150283148213823e-5, 4.4372358984830375e-5, 4.4626498532312846e-5,
                    2.0801996076647175e-5, 7.744275265311925e-5, 5.818835067910558e-5,
                    1.8288139189505958e-5, 2.3333646340099204e-5, 4.947052347304861e-5,
                    4.95528779285145e-5, 3.230055411053708e-5, 4.0310296740851806e-5,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorGerber2(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 8.479810572424716e-5, 0.00013481919269452974,
                    0.00011885949139879613, 0.00015023227927681826, 5.69469257116721e-5,
                    0.0001457080284042035, 4.813319113642258e-5, 8.001256659997715e-5,
                    6.897807417944483e-5, 3.695463639560883e-5, 0.00010454423085261528,
                    3.0077488769433062e-5, 4.1832177274172604e-5, 4.021155212906692e-5,
                    6.091895371574161e-5, 9.574521098841244e-5, 5.335727202419911e-5,
                    7.322772093766515e-5, 7.292769852536438e-5, 8.479810572424716e-5,
                    0.00021152344684106065, 9.309893102926256e-5, 8.704190204675714e-5,
                    9.705322855720491e-5, 5.788213539335325e-5, 0.00013660890782330875,
                    4.7860985361128804e-5, 7.67267180764851e-5, 6.251262405993471e-5,
                    3.8970017367464815e-5, 9.845824046484301e-5, 4.5162600745831125e-5,
                    4.3968928208447925e-5, 4.928830039370641e-5, 7.826530023878485e-5,
                    8.133280636642498e-5, 4.595939250363155e-5, 7.393929031440889e-5,
                    6.148191842965166e-5, 0.00013481919269452974, 9.309893102926256e-5,
                    0.0002572414426920628, 0.00011707814665958131, 0.00015004712093609514,
                    5.517571934810329e-5, 0.00013742487684328782, 2.833869262713695e-5,
                    8.114776427002974e-5, 6.249782852968606e-5, 3.463983915358424e-5,
                    0.00010485460712575697, 4.3286941367850525e-5, 2.838191504124765e-5,
                    2.9641597202604233e-5, 4.827584986056339e-5, 9.3991400526803e-5,
                    4.671885164293886e-5, 7.123442926132771e-5, 7.346929539402039e-5,
                    0.00011885949139879613, 8.704190204675714e-5, 0.00011707814665958131,
                    0.00040062774321407494, 0.00013256029196035614, 6.100215108231338e-5,
                    0.00019992697591169606, 4.1034739549577096e-5, 8.227564293174718e-5,
                    7.514676745422884e-5, 2.9971155324625996e-5, 0.0001307515265977456,
                    0.00011350497337701902, 4.578063212722756e-5, 8.808810250128745e-5,
                    8.249957770369063e-5, 9.648142387936978e-5, 4.484771644382903e-5,
                    8.119714775173985e-5, 6.742670084729188e-5, 0.00015023227927681826,
                    9.705322855720491e-5, 0.00015004712093609514, 0.00013256029196035614,
                    0.0003311044630153933, 5.9684376287045115e-5, 0.00016856946508429896,
                    5.5469821508902395e-5, 8.304941201474624e-5, 6.127263099030415e-5,
                    3.944937375089744e-5, 9.851576008553968e-5, 1.6340659711945967e-5,
                    3.8888097185467306e-5, 7.584057432138684e-5, 6.451698711351788e-5,
                    0.0001082939560679841, 4.6354132065554304e-5, 7.964895855667953e-5,
                    8.52575580036906e-5, 5.69469257116721e-5, 5.788213539335325e-5,
                    5.517571934810329e-5, 6.100215108231338e-5, 5.9684376287045115e-5,
                    0.0001790877252511976, 0.00010577554128142576, 4.508743828063588e-5,
                    9.009794869493217e-5, 8.723067754798909e-5, 4.345167914124309e-5,
                    0.00011135781644809016, 0.00011101108599754135, 6.030515044172232e-5,
                    8.048864875572246e-5, 6.047124953644372e-5, 5.9458138674628894e-5,
                    4.695283428950703e-5, 7.83139719565008e-5, 5.8741126974117044e-5,
                    0.0001457080284042035, 0.00013660890782330875, 0.00013742487684328782,
                    0.00019992697591169606, 0.00016856946508429896, 0.00010577554128142576,
                    0.0016481856234771101, 8.05632143752197e-5, 0.00017301939829157578,
                    0.00015208438933711385, 6.621056170578248e-5, 0.000157028499707481,
                    0.00017305191530969037, 9.398095718660544e-5, 0.0002172513814144819,
                    0.0001331010361058201, 0.00014721619959553087, 8.157855599220381e-5,
                    0.00013263725227876945, 8.158736075175916e-5, 4.813319113642258e-5,
                    4.7860985361128804e-5, 2.833869262713695e-5, 4.1034739549577096e-5,
                    5.5469821508902395e-5, 4.508743828063588e-5, 8.05632143752197e-5,
                    0.00016353541427233865, 3.8705038774792076e-5, 5.241878064913663e-5,
                    4.0094927927233295e-5, 6.750656895864463e-5, 8.921356069489136e-5,
                    2.6942960671557136e-5, 2.5309031869455816e-5, 8.165501454806691e-5,
                    5.067791243020644e-5, 3.984275682485157e-5, 4.263604611341596e-5,
                    4.650720801029173e-5, 8.001256659997715e-5, 7.67267180764851e-5,
                    8.114776427002974e-5, 8.227564293174718e-5, 8.304941201474624e-5,
                    9.009794869493217e-5, 0.00017301939829157578, 3.8705038774792076e-5,
                    0.0002761997989142448, 0.0001083146602104146, 3.9293216271407566e-5,
                    0.00014548380062296182, 0.00015327766361444394, 7.5700881401251e-5,
                    0.0001178121774541056, 0.00011704979632188946, 8.8782183012639e-5,
                    5.867466108935288e-5, 0.0001742471671876385, 6.32683572424384e-5,
                    6.897807417944483e-5, 6.251262405993471e-5, 6.249782852968606e-5,
                    7.514676745422884e-5, 6.127263099030415e-5, 8.723067754798909e-5,
                    0.00015208438933711385, 5.241878064913663e-5, 0.0001083146602104146,
                    0.000243322112701978, 3.982854217525252e-5, 0.00015061486429549637,
                    0.0001437134570265953, 6.077941571415766e-5, 8.03352314533713e-5,
                    0.00011211475468696074, 6.803055811160149e-5, 5.081106562688003e-5,
                    9.024937372284348e-5, 6.346883344849865e-5, 3.695463639560883e-5,
                    3.8970017367464815e-5, 3.463983915358424e-5, 2.9971155324625996e-5,
                    3.944937375089744e-5, 4.345167914124309e-5, 6.621056170578248e-5,
                    4.0094927927233295e-5, 3.9293216271407566e-5, 3.982854217525252e-5,
                    0.00010534978848760107, 5.732870722606158e-5, 5.1928722018579136e-5,
                    3.808130642511506e-5, 4.396413768734414e-5, 4.829160239573156e-5,
                    3.563879716201725e-5, 3.246789836090531e-5, 4.767636681128344e-5,
                    2.9378888080786643e-5, 0.00010454423085261528, 9.845824046484301e-5,
                    0.00010485460712575697, 0.0001307515265977456, 9.851576008553968e-5,
                    0.00011135781644809016, 0.000157028499707481, 6.750656895864463e-5,
                    0.00014548380062296182, 0.00015061486429549637, 5.732870722606158e-5,
                    0.0007066882567333454, 0.0002479078726463613, 7.19569283011353e-5,
                    0.00016053378497559822, 0.00017844758240149526, 9.627886756780575e-5,
                    7.581611880628563e-5, 0.00012161209033181492, 0.00011433823261211857,
                    3.0077488769433062e-5, 4.5162600745831125e-5, 4.3286941367850525e-5,
                    0.00011350497337701902, 1.6340659711945967e-5, 0.00011101108599754135,
                    0.00017305191530969037, 8.921356069489136e-5, 0.00015327766361444394,
                    0.0001437134570265953, 5.1928722018579136e-5, 0.0002479078726463613,
                    0.0019439677607081581, 6.96230882910983e-5, 0.00021138762664374308,
                    0.00022010620355538297, 5.769672681197949e-5, 4.999151227360743e-5,
                    0.00010137528575046608, 8.3783638122033e-5, 4.1832177274172604e-5,
                    4.3968928208447925e-5, 2.838191504124765e-5, 4.578063212722756e-5,
                    3.8888097185467306e-5, 6.030515044172232e-5, 9.398095718660544e-5,
                    2.6942960671557136e-5, 7.5700881401251e-5, 6.077941571415766e-5,
                    3.808130642511506e-5, 7.19569283011353e-5, 6.96230882910983e-5,
                    0.00014363521728518009, 0.00013508143201512292, 5.9351090675873367e-5,
                    5.0822077966862156e-5, 3.778742929465094e-5, 6.958151153275493e-5,
                    2.6587945292731808e-5, 4.021155212906692e-5, 4.928830039370641e-5,
                    2.9641597202604233e-5, 8.808810250128745e-5, 7.584057432138684e-5,
                    8.048864875572246e-5, 0.0002172513814144819, 2.5309031869455816e-5,
                    0.0001178121774541056, 8.03352314533713e-5, 4.396413768734414e-5,
                    0.00016053378497559822, 0.00021138762664374308, 0.00013508143201512292,
                    0.000993702212514094, 0.00011996250103134387, 4.691692020519512e-5,
                    2.8279175364916546e-5, 8.654805268062516e-5, 3.3130609393999566e-5,
                    6.091895371574161e-5, 7.826530023878485e-5, 4.827584986056339e-5,
                    8.249957770369063e-5, 6.451698711351788e-5, 6.047124953644372e-5,
                    0.0001331010361058201, 8.165501454806691e-5, 0.00011704979632188946,
                    0.00011211475468696074, 4.829160239573156e-5, 0.00017844758240149526,
                    0.00022010620355538297, 5.9351090675873367e-5, 0.00011996250103134387,
                    0.0005054585590745467, 6.989349534289873e-5, 4.739434522560995e-5,
                    9.214839692991751e-5, 7.242838195380754e-5, 9.574521098841244e-5,
                    8.133280636642498e-5, 9.3991400526803e-5, 9.648142387936978e-5,
                    0.0001082939560679841, 5.9458138674628894e-5, 0.00014721619959553087,
                    5.067791243020644e-5, 8.8782183012639e-5, 6.803055811160149e-5,
                    3.563879716201725e-5, 9.627886756780575e-5, 5.769672681197949e-5,
                    5.0822077966862156e-5, 4.691692020519512e-5, 6.989349534289873e-5,
                    0.00016243872736431132, 5.54266341534582e-5, 8.26998376291834e-5,
                    7.038465861742772e-5, 5.335727202419911e-5, 4.595939250363155e-5,
                    4.671885164293886e-5, 4.484771644382903e-5, 4.6354132065554304e-5,
                    4.695283428950703e-5, 8.157855599220381e-5, 3.984275682485157e-5,
                    5.867466108935288e-5, 5.081106562688003e-5, 3.246789836090531e-5,
                    7.581611880628563e-5, 4.999151227360743e-5, 3.778742929465094e-5,
                    2.8279175364916546e-5, 4.739434522560995e-5, 5.54266341534582e-5,
                    0.00012202561764009547, 5.487779465764626e-5, 4.54985842118056e-5,
                    7.322772093766515e-5, 7.393929031440889e-5, 7.123442926132771e-5,
                    8.119714775173985e-5, 7.964895855667953e-5, 7.83139719565008e-5,
                    0.00013263725227876945, 4.263604611341596e-5, 0.0001742471671876385,
                    9.024937372284348e-5, 4.767636681128344e-5, 0.00012161209033181492,
                    0.00010137528575046608, 6.958151153275493e-5, 8.654805268062516e-5,
                    9.214839692991751e-5, 8.26998376291834e-5, 5.487779465764626e-5,
                    0.00018490114558171567, 5.772591012762798e-5, 7.292769852536438e-5,
                    6.148191842965166e-5, 7.346929539402039e-5, 6.742670084729188e-5,
                    8.52575580036906e-5, 5.8741126974117044e-5, 8.158736075175916e-5,
                    4.650720801029173e-5, 6.32683572424384e-5, 6.346883344849865e-5,
                    2.9378888080786643e-5, 0.00011433823261211857, 8.3783638122033e-5,
                    2.6587945292731808e-5, 3.3130609393999566e-5, 7.242838195380754e-5,
                    7.038465861742772e-5, 4.54985842118056e-5, 5.772591012762798e-5,
                    0.00015789185651061684], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorSB0(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.0001500963574559976, 0.0002054755760736773,
                    0.00020354707747575188, 0.00023828072357999673, 0.00010648413107860484,
                    0.0003092624415130563, 9.317754575746249e-5, 0.00014435503872611656,
                    0.0001275796310444135, 8.061050968379674e-5, 0.00019835382034830802,
                    5.027175754947748e-5, 7.867871832617885e-5, 5.6764913058208326e-5,
                    0.00013387764187932882, 0.00015535897089713387, 9.80505984803607e-5,
                    0.00013121083740914204, 0.0001345110396282771, 0.0001500963574559976,
                    0.0002115234468410606, 0.00016168749758353087, 0.00016275547305728092,
                    0.00017850135204961298, 0.00010790643036463165, 0.0002951054368452412,
                    8.908884768578249e-5, 0.00014515454144106146, 0.0001232922053974773,
                    7.596124666545128e-5, 0.00020391043127961024, 0.00011496039350677398,
                    8.335478980305416e-5, 8.40231432653567e-5, 0.00015186711691912933,
                    0.00014290659123865535, 8.157645487667805e-5, 0.00013503085230188633,
                    0.00011245251363840218, 0.0002054755760736773, 0.00016168749758353087,
                    0.0002572414426920628, 0.0002156309918509547, 0.0002473566698996358,
                    9.795550531150186e-5, 0.0002909098808490865, 5.8140155699872404e-5,
                    0.00014970886705760805, 0.00011812909663578849, 6.997381316623438e-5,
                    0.00021311254981763974, 7.64844086389938e-5, 5.386783364556744e-5,
                    4.938749898371177e-5, 9.622699440527315e-5, 0.00015882828066682213,
                    9.102244444976314e-5, 0.00012930122843697375, 0.00013762292641129049,
                    0.00020354707747575188, 0.00016275547305728092, 0.0002156309918509547,
                    0.00040062774321407494, 0.00024326336721459415, 0.00011487201273843996,
                    0.0003824480454369155, 8.140814519274715e-5, 0.00015509822098790728,
                    0.00014634252446577486, 5.1976510995504426e-5, 0.00027963861363867673,
                    0.00022325358781500582, 8.485650307796671e-5, 0.00015677804080006121,
                    0.00017111205997393645, 0.00016804251422969103, 8.44368889980767e-5,
                    0.00014573756918512577, 0.0001202206648903591, 0.00023828072357999673,
                    0.00017850135204961298, 0.0002473566698996358, 0.00024326336721459415,
                    0.0003311044630153933, 0.00012443735372339097, 0.0003349051313688808,
                    0.00011674617723242665, 0.0001591853316861772, 0.00012222024437690975,
                    7.859656450348869e-5, 0.00021249857669877403, 2.4400175585646307e-5,
                    8.662592921006082e-5, 0.00012617325867290914, 0.00014013423866500005,
                    0.00018186218314966658, 0.00010792314562268385, 0.00014960847051290768,
                    0.0001652316540610189, 0.00010648413107860484, 0.00010790643036463165,
                    9.795550531150186e-5, 0.00011487201273843996, 0.00012443735372339097,
                    0.00017908772525119756, 0.00021609184852201574, 9.091962543822732e-5,
                    0.0001604479953744847, 0.00015179498325428663, 7.811541562508289e-5,
                    0.00020287917192354633, 0.0002185574082366284, 0.00011053601797993994,
                    0.00014051894412450748, 0.0001208658788548363, 0.00010293537499882347,
                    8.450746287607847e-5, 0.000139549453347791, 0.00010667588074968075,
                    0.0003092624415130563, 0.0002951054368452412, 0.0002909098808490865,
                    0.0003824480454369155, 0.0003349051313688808, 0.00021609184852201574,
                    0.0016481856234771104, 0.00017139458119795557, 0.0002916620985679563,
                    0.0003180985907475514, 0.00012718188337846632, 0.00033614192248373635,
                    0.00034619466259492654, 0.00020209884523841274, 0.0004188707634067541,
                    0.00027694644370671387, 0.0002882187328190139, 0.00017329593893273588,
                    0.00026192548189411417, 0.00017392591285220185, 9.317754575746249e-5,
                    8.908884768578249e-5, 5.8140155699872404e-5, 8.140814519274715e-5,
                    0.00011674617723242665, 9.091962543822732e-5, 0.00017139458119795557,
                    0.00016353541427233863, 8.029511117864979e-5, 0.00010251301603935441,
                    7.51421777207081e-5, 0.00012671148709809412, 0.00016645923358696703,
                    5.38655161482187e-5, 4.946567344198954e-5, 0.00017285817334035148,
                    9.594656217856487e-5, 8.113845165286235e-5, 8.725812920214212e-5,
                    8.87424194537993e-5, 0.00014435503872611656, 0.00014515454144106146,
                    0.00014970886705760805, 0.00015509822098790728, 0.0001591853316861772,
                    0.0001604479953744847, 0.0002916620985679563, 8.029511117864979e-5,
                    0.00027619979891424485, 0.00018228946072362126, 7.544753468302803e-5,
                    0.0002812193192598643, 0.0002731845241696146, 0.00013268325559077872,
                    0.00020554589208691398, 0.0002099897105003409, 0.00014244398615832857,
                    0.00010089395622430583, 0.00021367332941146487, 0.00011404929753991295,
                    0.0001275796310444135, 0.0001232922053974773, 0.00011812909663578849,
                    0.00014634252446577486, 0.00012222024437690975, 0.00015179498325428663,
                    0.0003180985907475514, 0.00010251301603935441, 0.00018228946072362126,
                    0.000243322112701978, 7.2421710284985e-5, 0.00026834916443997306,
                    0.00026184605869628344, 0.00011707022724670785, 0.0001277370803880656,
                    0.00020923746381097663, 0.00012707210955126432, 8.75180587542336e-5,
                    0.0001606368377655854, 0.00010973224477555082, 8.061050968379674e-5,
                    7.596124666545128e-5, 6.997381316623438e-5, 5.1976510995504426e-5,
                    7.859656450348869e-5, 7.811541562508289e-5, 0.00012718188337846632,
                    7.51421777207081e-5, 7.544753468302803e-5, 7.2421710284985e-5,
                    0.00010534978848760108, 0.00010700429270366509, 9.157999471464655e-5,
                    6.598691083542432e-5, 6.472186946493633e-5, 9.328562773734289e-5,
                    6.368592057730412e-5, 6.506903147345624e-5, 8.568186159159285e-5,
                    5.367691318944735e-5, 0.00019835382034830802, 0.00020391043127961024,
                    0.00021311254981763974, 0.00027963861363867673, 0.00021249857669877403,
                    0.00020287917192354633, 0.00033614192248373635, 0.00012671148709809412,
                    0.0002812193192598643, 0.00026834916443997306, 0.00010700429270366509,
                    0.0007066882567333455, 0.0004914979653351839, 0.00015180524114450557,
                    0.00026966000562904683, 0.0003857099865784877, 0.0001777378003483919,
                    0.00016660359158931164, 0.00023937217544120547, 0.0002211658552734588,
                    5.027175754947748e-5, 0.00011496039350677398, 7.64844086389938e-5,
                    0.00022325358781500582, 2.4400175585646307e-5, 0.0002185574082366284,
                    0.00034619466259492654, 0.00016645923358696703, 0.0002731845241696146,
                    0.00026184605869628344, 9.157999471464655e-5, 0.0004914979653351839,
                    0.0019439677607081577, 0.00013014688566139832, 0.00032915110250406174,
                    0.0004429847741978726, 0.00010561062243312037, 9.120211775443551e-5,
                    0.0001738751753710941, 0.00013233545622138014, 7.867871832617885e-5,
                    8.335478980305416e-5, 5.386783364556744e-5, 8.485650307796671e-5,
                    8.662592921006082e-5, 0.00011053601797993994, 0.00020209884523841274,
                    5.38655161482187e-5, 0.00013268325559077872, 0.00011707022724670785,
                    6.598691083542432e-5, 0.00015180524114450557, 0.00013014688566139832,
                    0.0001436352172851801, 0.00023620041015318382, 0.00011791752903941887,
                    8.664070256374394e-5, 7.367252741427623e-5, 0.00012397562482369202,
                    5.180011201894452e-5, 5.6764913058208326e-5, 8.40231432653567e-5,
                    4.938749898371177e-5, 0.00015677804080006121, 0.00012617325867290914,
                    0.00014051894412450748, 0.0004188707634067541, 4.946567344198954e-5,
                    0.00020554589208691398, 0.0001277370803880656, 6.472186946493633e-5,
                    0.00026966000562904683, 0.00032915110250406174, 0.00023620041015318382,
                    0.0009937022125140937, 0.00018779491926943986, 8.175259425125182e-5,
                    4.584902794141038e-5, 0.00016607105610462117, 5.925689608772268e-5,
                    0.00013387764187932882, 0.00015186711691912933, 9.622699440527315e-5,
                    0.00017111205997393645, 0.00014013423866500005, 0.0001208658788548363,
                    0.00027694644370671387, 0.00017285817334035148, 0.0002099897105003409,
                    0.00020923746381097663, 9.328562773734289e-5, 0.0003857099865784877,
                    0.0004429847741978726, 0.00011791752903941887, 0.00018779491926943986,
                    0.0005054585590745467, 0.00013226307848455612, 9.517539576319179e-5,
                    0.00017393949493398989, 0.00014019423111644977, 0.00015535897089713387,
                    0.00014290659123865535, 0.00015882828066682213, 0.00016804251422969103,
                    0.00018186218314966658, 0.00010293537499882347, 0.0002882187328190139,
                    9.594656217856487e-5, 0.00014244398615832857, 0.00012707210955126432,
                    6.368592057730412e-5, 0.0001777378003483919, 0.00010561062243312037,
                    8.664070256374394e-5, 8.175259425125182e-5, 0.00013226307848455612,
                    0.0001624387273643113, 0.00010033632442787796, 0.000134554724207352,
                    0.00012616145620234442, 9.80505984803607e-5, 8.157645487667805e-5,
                    9.102244444976314e-5, 8.44368889980767e-5, 0.00010792314562268385,
                    8.450746287607847e-5, 0.00017329593893273588, 8.113845165286235e-5,
                    0.00010089395622430583, 8.75180587542336e-5, 6.506903147345624e-5,
                    0.00016660359158931164, 9.120211775443551e-5, 7.367252741427623e-5,
                    4.584902794141038e-5, 9.517539576319179e-5, 0.00010033632442787796,
                    0.00012202561764009547, 9.774624998521133e-5, 8.130145565023084e-5,
                    0.00013121083740914204, 0.00013503085230188633, 0.00012930122843697375,
                    0.00014573756918512577, 0.00014960847051290768, 0.000139549453347791,
                    0.00026192548189411417, 8.725812920214212e-5, 0.00021367332941146487,
                    0.0001606368377655854, 8.568186159159285e-5, 0.00023937217544120547,
                    0.0001738751753710941, 0.00012397562482369202, 0.00016607105610462117,
                    0.00017393949493398989, 0.000134554724207352, 9.774624998521133e-5,
                    0.0001849011455817157, 0.00010244599934140222, 0.0001345110396282771,
                    0.00011245251363840218, 0.00013762292641129049, 0.0001202206648903591,
                    0.0001652316540610189, 0.00010667588074968075, 0.00017392591285220185,
                    8.87424194537993e-5, 0.00011404929753991295, 0.00010973224477555082,
                    5.367691318944735e-5, 0.0002211658552734588, 0.00013233545622138014,
                    5.180011201894452e-5, 5.925689608772268e-5, 0.00014019423111644977,
                    0.00012616145620234442, 8.130145565023084e-5, 0.00010244599934140222,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorSB1(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.0001500963574559976, 0.0002054755760736773,
                    0.00020354707747575188, 0.00023828072357999673, 0.00010648413107860484,
                    0.0003092624415130563, 9.317754575746249e-5, 0.00014435503872611656,
                    0.0001275796310444135, 8.061050968379674e-5, 0.00019835382034830802,
                    5.027175754947748e-5, 7.867871832617885e-5, 5.6764913058208326e-5,
                    0.00013387764187932882, 0.00015535897089713387, 9.80505984803607e-5,
                    0.00013121083740914204, 0.0001345110396282771, 0.0001500963574559976,
                    0.0002115234468410606, 0.00016168749758353087, 0.00016275547305728092,
                    0.00017850135204961298, 0.00010790643036463165, 0.0002951054368452412,
                    8.908884768578249e-5, 0.00014515454144106146, 0.0001232922053974773,
                    7.596124666545128e-5, 0.00020391043127961024, 0.00011496039350677398,
                    8.335478980305416e-5, 8.40231432653567e-5, 0.00015186711691912933,
                    0.00014290659123865535, 8.157645487667805e-5, 0.00013503085230188633,
                    0.00011245251363840218, 0.0002054755760736773, 0.00016168749758353087,
                    0.0002572414426920628, 0.0002156309918509547, 0.0002473566698996358,
                    9.795550531150186e-5, 0.0002909098808490865, 5.8140155699872404e-5,
                    0.00014970886705760805, 0.00011812909663578849, 6.997381316623438e-5,
                    0.00021311254981763974, 7.64844086389938e-5, 5.386783364556744e-5,
                    4.938749898371177e-5, 9.622699440527315e-5, 0.00015882828066682213,
                    9.102244444976314e-5, 0.00012930122843697375, 0.00013762292641129049,
                    0.00020354707747575188, 0.00016275547305728092, 0.0002156309918509547,
                    0.00040062774321407494, 0.00024326336721459415, 0.00011487201273843996,
                    0.0003824480454369155, 8.140814519274715e-5, 0.00015509822098790728,
                    0.00014634252446577486, 5.1976510995504426e-5, 0.00027963861363867673,
                    0.00022325358781500582, 8.485650307796671e-5, 0.00015677804080006121,
                    0.00017111205997393645, 0.00016804251422969103, 8.44368889980767e-5,
                    0.00014573756918512577, 0.0001202206648903591, 0.00023828072357999673,
                    0.00017850135204961298, 0.0002473566698996358, 0.00024326336721459415,
                    0.0003311044630153933, 0.00012443735372339097, 0.0003349051313688808,
                    0.00011674617723242665, 0.0001591853316861772, 0.00012222024437690975,
                    7.859656450348869e-5, 0.00021249857669877403, 2.4400175585646307e-5,
                    8.662592921006082e-5, 0.00012617325867290914, 0.00014013423866500005,
                    0.00018186218314966658, 0.00010792314562268385, 0.00014960847051290768,
                    0.0001652316540610189, 0.00010648413107860484, 0.00010790643036463165,
                    9.795550531150186e-5, 0.00011487201273843996, 0.00012443735372339097,
                    0.00017908772525119756, 0.00021609184852201574, 9.091962543822732e-5,
                    0.0001604479953744847, 0.00015179498325428663, 7.811541562508289e-5,
                    0.00020287917192354633, 0.0002185574082366284, 0.00011053601797993994,
                    0.00014051894412450748, 0.0001208658788548363, 0.00010293537499882347,
                    8.450746287607847e-5, 0.000139549453347791, 0.00010667588074968075,
                    0.0003092624415130563, 0.0002951054368452412, 0.0002909098808490865,
                    0.0003824480454369155, 0.0003349051313688808, 0.00021609184852201574,
                    0.0016481856234771104, 0.00017139458119795557, 0.0002916620985679563,
                    0.0003180985907475514, 0.00012718188337846632, 0.00033614192248373635,
                    0.00034619466259492654, 0.00020209884523841274, 0.0004188707634067541,
                    0.00027694644370671387, 0.0002882187328190139, 0.00017329593893273588,
                    0.00026192548189411417, 0.00017392591285220185, 9.317754575746249e-5,
                    8.908884768578249e-5, 5.8140155699872404e-5, 8.140814519274715e-5,
                    0.00011674617723242665, 9.091962543822732e-5, 0.00017139458119795557,
                    0.00016353541427233863, 8.029511117864979e-5, 0.00010251301603935441,
                    7.51421777207081e-5, 0.00012671148709809412, 0.00016645923358696703,
                    5.38655161482187e-5, 4.946567344198954e-5, 0.00017285817334035148,
                    9.594656217856487e-5, 8.113845165286235e-5, 8.725812920214212e-5,
                    8.87424194537993e-5, 0.00014435503872611656, 0.00014515454144106146,
                    0.00014970886705760805, 0.00015509822098790728, 0.0001591853316861772,
                    0.0001604479953744847, 0.0002916620985679563, 8.029511117864979e-5,
                    0.00027619979891424485, 0.00018228946072362126, 7.544753468302803e-5,
                    0.0002812193192598643, 0.0002731845241696146, 0.00013268325559077872,
                    0.00020554589208691398, 0.0002099897105003409, 0.00014244398615832857,
                    0.00010089395622430583, 0.00021367332941146487, 0.00011404929753991295,
                    0.0001275796310444135, 0.0001232922053974773, 0.00011812909663578849,
                    0.00014634252446577486, 0.00012222024437690975, 0.00015179498325428663,
                    0.0003180985907475514, 0.00010251301603935441, 0.00018228946072362126,
                    0.000243322112701978, 7.2421710284985e-5, 0.00026834916443997306,
                    0.00026184605869628344, 0.00011707022724670785, 0.0001277370803880656,
                    0.00020923746381097663, 0.00012707210955126432, 8.75180587542336e-5,
                    0.0001606368377655854, 0.00010973224477555082, 8.061050968379674e-5,
                    7.596124666545128e-5, 6.997381316623438e-5, 5.1976510995504426e-5,
                    7.859656450348869e-5, 7.811541562508289e-5, 0.00012718188337846632,
                    7.51421777207081e-5, 7.544753468302803e-5, 7.2421710284985e-5,
                    0.00010534978848760108, 0.00010700429270366509, 9.157999471464655e-5,
                    6.598691083542432e-5, 6.472186946493633e-5, 9.328562773734289e-5,
                    6.368592057730412e-5, 6.506903147345624e-5, 8.568186159159285e-5,
                    5.367691318944735e-5, 0.00019835382034830802, 0.00020391043127961024,
                    0.00021311254981763974, 0.00027963861363867673, 0.00021249857669877403,
                    0.00020287917192354633, 0.00033614192248373635, 0.00012671148709809412,
                    0.0002812193192598643, 0.00026834916443997306, 0.00010700429270366509,
                    0.0007066882567333455, 0.0004914979653351839, 0.00015180524114450557,
                    0.00026966000562904683, 0.0003857099865784877, 0.0001777378003483919,
                    0.00016660359158931164, 0.00023937217544120547, 0.0002211658552734588,
                    5.027175754947748e-5, 0.00011496039350677398, 7.64844086389938e-5,
                    0.00022325358781500582, 2.4400175585646307e-5, 0.0002185574082366284,
                    0.00034619466259492654, 0.00016645923358696703, 0.0002731845241696146,
                    0.00026184605869628344, 9.157999471464655e-5, 0.0004914979653351839,
                    0.0019439677607081577, 0.00013014688566139832, 0.00032915110250406174,
                    0.0004429847741978726, 0.00010561062243312037, 9.120211775443551e-5,
                    0.0001738751753710941, 0.00013233545622138014, 7.867871832617885e-5,
                    8.335478980305416e-5, 5.386783364556744e-5, 8.485650307796671e-5,
                    8.662592921006082e-5, 0.00011053601797993994, 0.00020209884523841274,
                    5.38655161482187e-5, 0.00013268325559077872, 0.00011707022724670785,
                    6.598691083542432e-5, 0.00015180524114450557, 0.00013014688566139832,
                    0.0001436352172851801, 0.00023620041015318382, 0.00011791752903941887,
                    8.664070256374394e-5, 7.367252741427623e-5, 0.00012397562482369202,
                    5.180011201894452e-5, 5.6764913058208326e-5, 8.40231432653567e-5,
                    4.938749898371177e-5, 0.00015677804080006121, 0.00012617325867290914,
                    0.00014051894412450748, 0.0004188707634067541, 4.946567344198954e-5,
                    0.00020554589208691398, 0.0001277370803880656, 6.472186946493633e-5,
                    0.00026966000562904683, 0.00032915110250406174, 0.00023620041015318382,
                    0.0009937022125140937, 0.00018779491926943986, 8.175259425125182e-5,
                    4.584902794141038e-5, 0.00016607105610462117, 5.925689608772268e-5,
                    0.00013387764187932882, 0.00015186711691912933, 9.622699440527315e-5,
                    0.00017111205997393645, 0.00014013423866500005, 0.0001208658788548363,
                    0.00027694644370671387, 0.00017285817334035148, 0.0002099897105003409,
                    0.00020923746381097663, 9.328562773734289e-5, 0.0003857099865784877,
                    0.0004429847741978726, 0.00011791752903941887, 0.00018779491926943986,
                    0.0005054585590745467, 0.00013226307848455612, 9.517539576319179e-5,
                    0.00017393949493398989, 0.00014019423111644977, 0.00015535897089713387,
                    0.00014290659123865535, 0.00015882828066682213, 0.00016804251422969103,
                    0.00018186218314966658, 0.00010293537499882347, 0.0002882187328190139,
                    9.594656217856487e-5, 0.00014244398615832857, 0.00012707210955126432,
                    6.368592057730412e-5, 0.0001777378003483919, 0.00010561062243312037,
                    8.664070256374394e-5, 8.175259425125182e-5, 0.00013226307848455612,
                    0.0001624387273643113, 0.00010033632442787796, 0.000134554724207352,
                    0.00012616145620234442, 9.80505984803607e-5, 8.157645487667805e-5,
                    9.102244444976314e-5, 8.44368889980767e-5, 0.00010792314562268385,
                    8.450746287607847e-5, 0.00017329593893273588, 8.113845165286235e-5,
                    0.00010089395622430583, 8.75180587542336e-5, 6.506903147345624e-5,
                    0.00016660359158931164, 9.120211775443551e-5, 7.367252741427623e-5,
                    4.584902794141038e-5, 9.517539576319179e-5, 0.00010033632442787796,
                    0.00012202561764009547, 9.774624998521133e-5, 8.130145565023084e-5,
                    0.00013121083740914204, 0.00013503085230188633, 0.00012930122843697375,
                    0.00014573756918512577, 0.00014960847051290768, 0.000139549453347791,
                    0.00026192548189411417, 8.725812920214212e-5, 0.00021367332941146487,
                    0.0001606368377655854, 8.568186159159285e-5, 0.00023937217544120547,
                    0.0001738751753710941, 0.00012397562482369202, 0.00016607105610462117,
                    0.00017393949493398989, 0.000134554724207352, 9.774624998521133e-5,
                    0.0001849011455817157, 0.00010244599934140222, 0.0001345110396282771,
                    0.00011245251363840218, 0.00013762292641129049, 0.0001202206648903591,
                    0.0001652316540610189, 0.00010667588074968075, 0.00017392591285220185,
                    8.87424194537993e-5, 0.00011404929753991295, 0.00010973224477555082,
                    5.367691318944735e-5, 0.0002211658552734588, 0.00013233545622138014,
                    5.180011201894452e-5, 5.925689608772268e-5, 0.00014019423111644977,
                    0.00012616145620234442, 8.130145565023084e-5, 0.00010244599934140222,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorGerberSB0(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.00020178235652529235, 0.00022173021010844419,
                    0.0002517473514622632, 0.000256249815378467, 0.00015921781569191705,
                    0.0004533116258622552, 0.00014164266959536124, 0.00020051743991649564,
                    0.0001854464037096936, 0.00011373764303332041, 0.0003040160620824565,
                    0.00015777255284802152, 0.0001235054503824378, 0.00014769232337662517,
                    0.00021413393297829334, 0.0001818481042244945, 0.00014175954924131363,
                    0.00017814139859659352, 0.0001675927816948642, 0.00020178235652529235,
                    0.0002115234468410606, 0.0002112873323477776, 0.0002421902421934082,
                    0.00024315352471116408, 0.00015916427962074452, 0.00045650523320110036,
                    0.0001424356364241599, 0.00020898887046533464, 0.0001907135553830898,
                    0.00011813067218324054, 0.0003081878943035091, 0.00020814746322452612,
                    0.00012904451097439372, 0.00017555532575084975, 0.00024255096569986167,
                    0.0001774039350092801, 0.00013240499725859043, 0.00018123463132009256,
                    0.00016195195348442612, 0.00022173021010844419, 0.0002112873323477776,
                    0.0002572414426920628, 0.0002851407334836263, 0.0002700625169966402,
                    0.0001609745199293241, 0.0004605518893502699, 0.0001214725551061221,
                    0.00021120443370292507, 0.00018528836146906682, 0.00010374398109822753,
                    0.00032552533536752017, 0.00015400044199450832, 0.00011236829439441562,
                    0.00011840626406469592, 0.00018950572095254131, 0.0001874706887147314,
                    0.00014026322820021283, 0.00017992911839732578, 0.000178243049722257,
                    0.0002517473514622632, 0.0002421902421934082, 0.0002851407334836263,
                    0.00040062774321407494, 0.0003190608819710296, 0.000190984566889166,
                    0.0006356495996551091, 0.00014810228393929306, 0.000265650702607652,
                    0.0002331314797894144, 0.00010409706246068067, 0.0004290045861818549,
                    0.0003612003448622298, 0.00014654261158341813, 0.0002855692152789008,
                    0.00028966540635829216, 0.00022260824681193307, 0.00014570031249772154,
                    0.00022302618729465892, 0.00020621079581635413, 0.000256249815378467,
                    0.00024315352471116408, 0.0002700625169966402, 0.0003190608819710296,
                    0.0003311044630153933, 0.0001876688045520936, 0.0005476250100196218,
                    0.00016438350255393563, 0.00023530455483602682, 0.00020620965566407195,
                    0.00012913548495643629, 0.00035305263895201653, 0.00011887776945053929,
                    0.00014763743194328284, 0.00021354478307733898, 0.00024208862389066358,
                    0.00021950685809182794, 0.00016123494128192145, 0.00021244373439114245,
                    0.00020244325250221902, 0.00015921781569191705, 0.00015916427962074452,
                    0.0001609745199293241, 0.000190984566889166, 0.0001876688045520936,
                    0.00017908772525119756, 0.00037805703331058503, 0.00013429045880173403,
                    0.0002079480796602434, 0.0001922184097879973, 0.00011584430091015752,
                    0.00030885443731318887, 0.0003594816797032773, 0.0001424866988609799,
                    0.00025000607418868204, 0.00022298856725204108, 0.0001505236247353043,
                    0.00012834085476196412, 0.00017322432482065904, 0.00014455267315627196,
                    0.0004533116258622552, 0.00045650523320110036, 0.0004605518893502699,
                    0.0006356495996551091, 0.0005476250100196218, 0.00037805703331058503,
                    0.0016481856234771104, 0.0003026849571342161, 0.0005101026232421233,
                    0.0004892159303258824, 0.00023608025923076107, 0.000640308286133508,
                    0.0006376863388213525, 0.00035165531607400283, 0.0007051857143422411,
                    0.0005109843708254457, 0.0004228602188662458, 0.0002913881301596775,
                    0.00043378434020728145, 0.00030913460094692365, 0.00014164266959536124,
                    0.0001424356364241599, 0.0001214725551061221, 0.00014810228393929306,
                    0.00016438350255393563, 0.00013429045880173403, 0.0003026849571342161,
                    0.00016353541427233863, 0.0001445863072564352, 0.00015761229492109298,
                    0.00010851336135656118, 0.0002347672778037858, 0.0002875991463519631,
                    9.80170594861329e-5, 0.00010030740847661505, 0.00023456418839848934,
                    0.00013356417913589348, 0.00011631807469254503, 0.00013635686118298516,
                    0.00013335107262850643, 0.00020051743991649564, 0.00020898887046533464,
                    0.00021120443370292507, 0.000265650702607652, 0.00023530455483602682,
                    0.0002079480796602434, 0.0005101026232421233, 0.0001445863072564352,
                    0.00027619979891424485, 0.0002452399177633054, 0.00012572552603293299,
                    0.0004162190787655545, 0.0004533152532108888, 0.00017933311301538755,
                    0.00034919571221040025, 0.0003033950107951737, 0.00018923746112349475,
                    0.0001511656726979, 0.0002195486694239333, 0.000176851750527614,
                    0.0001854464037096936, 0.0001907135553830898, 0.00018528836146906682,
                    0.0002331314797894144, 0.00020620965566407195, 0.0001922184097879973,
                    0.0004892159303258824, 0.00015761229492109298, 0.0002452399177633054,
                    0.000243322112701978, 0.00011997247400372198, 0.0003714173092317063,
                    0.0004607975203377339, 0.00015791750168882532, 0.00026417199624891084,
                    0.00029956342079475465, 0.00017756909221152255, 0.00014436721773723147,
                    0.00019889544531880474, 0.0001669499534029005, 0.00011373764303332041,
                    0.00011813067218324054, 0.00010374398109822753, 0.00010409706246068067,
                    0.00012913548495643629, 0.00011584430091015752, 0.00023608025923076107,
                    0.00010851336135656118, 0.00012572552603293299, 0.00011997247400372198,
                    0.00010534978848760108, 0.00018590925186452205, 0.00017578970634840984,
                    9.898536681281736e-5, 0.00013163887518804002, 0.00015556541001668378,
                    0.00010328871956671789, 9.677298905141091e-5, 0.00011810723576794285,
                    9.258254298059739e-5, 0.0003040160620824565, 0.0003081878943035091,
                    0.00032552533536752017, 0.0004290045861818549, 0.00035305263895201653,
                    0.00030885443731318887, 0.000640308286133508, 0.0002347672778037858,
                    0.0004162190787655545, 0.0003714173092317063, 0.00018590925186452205,
                    0.0007066882567333455, 0.000807568985706062, 0.00025060220750151277,
                    0.00046933615580751505, 0.0005184235485318653, 0.00028566429648132846,
                    0.00023432394072644164, 0.0003311939240480223, 0.00029437224277905916,
                    0.00015777255284802152, 0.00020814746322452612, 0.00015400044199450832,
                    0.0003612003448622298, 0.00011887776945053929, 0.0003594816797032773,
                    0.0006376863388213525, 0.0002875991463519631, 0.0004533152532108888,
                    0.0004607975203377339, 0.00017578970634840984, 0.000807568985706062,
                    0.0019439677607081577, 0.0002622876626610714, 0.0006642617380107544,
                    0.0007243951148089038, 0.00021531489282496772, 0.00018432522335595937,
                    0.0003233705649471341, 0.00025697457073559364, 0.0001235054503824378,
                    0.00012904451097439372, 0.00011236829439441562, 0.00014654261158341813,
                    0.00014763743194328284, 0.0001424866988609799, 0.00035165531607400283,
                    9.80170594861329e-5, 0.00017933311301538755, 0.00015791750168882532,
                    9.898536681281736e-5, 0.00025060220750151277, 0.0002622876626610714,
                    0.0001436352172851801, 0.00030842844747419124, 0.00019461304720309267,
                    0.00011965896605266635, 0.00010286567711201824, 0.0001495971553492702,
                    9.751274127688749e-5, 0.00014769232337662517, 0.00017555532575084975,
                    0.00011840626406469592, 0.0002855692152789008, 0.00021354478307733898,
                    0.00025000607418868204, 0.0007051857143422411, 0.00010030740847661505,
                    0.00034919571221040025, 0.00026417199624891084, 0.00013163887518804002,
                    0.00046933615580751505, 0.0006642617380107544, 0.00030842844747419124,
                    0.0009937022125140937, 0.0003698115813784753, 0.0001674203572897601,
                    0.0001100023057274042, 0.0002694547457523458, 0.00011046648930414672,
                    0.00021413393297829334, 0.00024255096569986167, 0.00018950572095254131,
                    0.00028966540635829216, 0.00024208862389066358, 0.00022298856725204108,
                    0.0005109843708254457, 0.00023456418839848934, 0.0003033950107951737,
                    0.00029956342079475465, 0.00015556541001668378, 0.0005184235485318653,
                    0.0007243951148089038, 0.00019461304720309267, 0.0003698115813784753,
                    0.0005054585590745467, 0.00021306357940508217, 0.0001677908056676286,
                    0.0002503123163159305, 0.00021668072562953003, 0.0001818481042244945,
                    0.0001774039350092801, 0.0001874706887147314, 0.00022260824681193307,
                    0.00021950685809182794, 0.0001505236247353043, 0.0004228602188662458,
                    0.00013356417913589348, 0.00018923746112349475, 0.00017756909221152255,
                    0.00010328871956671789, 0.00028566429648132846, 0.00021531489282496772,
                    0.00011965896605266635, 0.0001674203572897601, 0.00021306357940508217,
                    0.0001624387273643113, 0.00012821572722683912, 0.00016457875186554408,
                    0.00014948158449467656, 0.00014175954924131363, 0.00013240499725859043,
                    0.00014026322820021283, 0.00014570031249772154, 0.00016123494128192145,
                    0.00012834085476196412, 0.0002913881301596775, 0.00011631807469254503,
                    0.0001511656726979, 0.00014436721773723147, 9.677298905141091e-5,
                    0.00023432394072644164, 0.00018432522335595937, 0.00010286567711201824,
                    0.0001100023057274042, 0.0001677908056676286, 0.00012821572722683912,
                    0.00012202561764009547, 0.00013320952315118176, 0.00011981243821704253,
                    0.00017814139859659352, 0.00018123463132009256, 0.00017992911839732578,
                    0.00022302618729465892, 0.00021244373439114245, 0.00017322432482065904,
                    0.00043378434020728145, 0.00013635686118298516, 0.0002195486694239333,
                    0.00019889544531880474, 0.00011810723576794285, 0.0003311939240480223,
                    0.0003233705649471341, 0.0001495971553492702, 0.0002694547457523458,
                    0.0002503123163159305, 0.00016457875186554408, 0.00013320952315118176,
                    0.0001849011455817157, 0.00015039693623930154, 0.0001675927816948642,
                    0.00016195195348442612, 0.000178243049722257, 0.00020621079581635413,
                    0.00020244325250221902, 0.00014455267315627196, 0.00030913460094692365,
                    0.00013335107262850643, 0.000176851750527614, 0.0001669499534029005,
                    9.258254298059739e-5, 0.00029437224277905916, 0.00025697457073559364,
                    9.751274127688749e-5, 0.00011046648930414672, 0.00021668072562953003,
                    0.00014948158449467656, 0.00011981243821704253, 0.00015039693623930154,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorGerberSB1(; normalise = normalise))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00020997582228184753, 0.00020178235652529235, 0.00022173021010844419,
                    0.0002517473514622632, 0.000256249815378467, 0.00015921781569191705,
                    0.0004533116258622552, 0.00014164266959536124, 0.00020051743991649564,
                    0.0001854464037096936, 0.00011373764303332041, 0.0003040160620824565,
                    0.00015777255284802152, 0.0001235054503824378, 0.00014769232337662517,
                    0.00021413393297829334, 0.0001818481042244945, 0.00014175954924131363,
                    0.00017814139859659352, 0.0001675927816948642, 0.00020178235652529235,
                    0.0002115234468410606, 0.0002112873323477776, 0.0002421902421934082,
                    0.00024315352471116408, 0.00015916427962074452, 0.00045650523320110036,
                    0.0001424356364241599, 0.00020898887046533464, 0.0001907135553830898,
                    0.00011813067218324054, 0.0003081878943035091, 0.00020814746322452612,
                    0.00012904451097439372, 0.00017555532575084975, 0.00024255096569986167,
                    0.0001774039350092801, 0.00013240499725859043, 0.00018123463132009256,
                    0.00016195195348442612, 0.00022173021010844419, 0.0002112873323477776,
                    0.0002572414426920628, 0.0002851407334836263, 0.0002700625169966402,
                    0.0001609745199293241, 0.0004605518893502699, 0.0001214725551061221,
                    0.00021120443370292507, 0.00018528836146906682, 0.00010374398109822753,
                    0.00032552533536752017, 0.00015400044199450832, 0.00011236829439441562,
                    0.00011840626406469592, 0.00018950572095254131, 0.0001874706887147314,
                    0.00014026322820021283, 0.00017992911839732578, 0.000178243049722257,
                    0.0002517473514622632, 0.0002421902421934082, 0.0002851407334836263,
                    0.00040062774321407494, 0.0003190608819710296, 0.000190984566889166,
                    0.0006356495996551091, 0.00014810228393929306, 0.000265650702607652,
                    0.0002331314797894144, 0.00010409706246068067, 0.0004290045861818549,
                    0.0003612003448622298, 0.00014654261158341813, 0.0002855692152789008,
                    0.00028966540635829216, 0.00022260824681193307, 0.00014570031249772154,
                    0.00022302618729465892, 0.00020621079581635413, 0.000256249815378467,
                    0.00024315352471116408, 0.0002700625169966402, 0.0003190608819710296,
                    0.0003311044630153933, 0.0001876688045520936, 0.0005476250100196218,
                    0.00016438350255393563, 0.00023530455483602682, 0.00020620965566407195,
                    0.00012913548495643629, 0.00035305263895201653, 0.00011887776945053929,
                    0.00014763743194328284, 0.00021354478307733898, 0.00024208862389066358,
                    0.00021950685809182794, 0.00016123494128192145, 0.00021244373439114245,
                    0.00020244325250221902, 0.00015921781569191705, 0.00015916427962074452,
                    0.0001609745199293241, 0.000190984566889166, 0.0001876688045520936,
                    0.00017908772525119756, 0.00037805703331058503, 0.00013429045880173403,
                    0.0002079480796602434, 0.0001922184097879973, 0.00011584430091015752,
                    0.00030885443731318887, 0.0003594816797032773, 0.0001424866988609799,
                    0.00025000607418868204, 0.00022298856725204108, 0.0001505236247353043,
                    0.00012834085476196412, 0.00017322432482065904, 0.00014455267315627196,
                    0.0004533116258622552, 0.00045650523320110036, 0.0004605518893502699,
                    0.0006356495996551091, 0.0005476250100196218, 0.00037805703331058503,
                    0.0016481856234771104, 0.0003026849571342161, 0.0005101026232421233,
                    0.0004892159303258824, 0.00023608025923076107, 0.000640308286133508,
                    0.0006376863388213525, 0.00035165531607400283, 0.0007051857143422411,
                    0.0005109843708254457, 0.0004228602188662458, 0.0002913881301596775,
                    0.00043378434020728145, 0.00030913460094692365, 0.00014164266959536124,
                    0.0001424356364241599, 0.0001214725551061221, 0.00014810228393929306,
                    0.00016438350255393563, 0.00013429045880173403, 0.0003026849571342161,
                    0.00016353541427233863, 0.0001445863072564352, 0.00015761229492109298,
                    0.00010851336135656118, 0.0002347672778037858, 0.0002875991463519631,
                    9.80170594861329e-5, 0.00010030740847661505, 0.00023456418839848934,
                    0.00013356417913589348, 0.00011631807469254503, 0.00013635686118298516,
                    0.00013335107262850643, 0.00020051743991649564, 0.00020898887046533464,
                    0.00021120443370292507, 0.000265650702607652, 0.00023530455483602682,
                    0.0002079480796602434, 0.0005101026232421233, 0.0001445863072564352,
                    0.00027619979891424485, 0.0002452399177633054, 0.00012572552603293299,
                    0.0004162190787655545, 0.0004533152532108888, 0.00017933311301538755,
                    0.00034919571221040025, 0.0003033950107951737, 0.00018923746112349475,
                    0.0001511656726979, 0.0002195486694239333, 0.000176851750527614,
                    0.0001854464037096936, 0.0001907135553830898, 0.00018528836146906682,
                    0.0002331314797894144, 0.00020620965566407195, 0.0001922184097879973,
                    0.0004892159303258824, 0.00015761229492109298, 0.0002452399177633054,
                    0.000243322112701978, 0.00011997247400372198, 0.0003714173092317063,
                    0.0004607975203377339, 0.00015791750168882532, 0.00026417199624891084,
                    0.00029956342079475465, 0.00017756909221152255, 0.00014436721773723147,
                    0.00019889544531880474, 0.0001669499534029005, 0.00011373764303332041,
                    0.00011813067218324054, 0.00010374398109822753, 0.00010409706246068067,
                    0.00012913548495643629, 0.00011584430091015752, 0.00023608025923076107,
                    0.00010851336135656118, 0.00012572552603293299, 0.00011997247400372198,
                    0.00010534978848760108, 0.00018590925186452205, 0.00017578970634840984,
                    9.898536681281736e-5, 0.00013163887518804002, 0.00015556541001668378,
                    0.00010328871956671789, 9.677298905141091e-5, 0.00011810723576794285,
                    9.258254298059739e-5, 0.0003040160620824565, 0.0003081878943035091,
                    0.00032552533536752017, 0.0004290045861818549, 0.00035305263895201653,
                    0.00030885443731318887, 0.000640308286133508, 0.0002347672778037858,
                    0.0004162190787655545, 0.0003714173092317063, 0.00018590925186452205,
                    0.0007066882567333455, 0.000807568985706062, 0.00025060220750151277,
                    0.00046933615580751505, 0.0005184235485318653, 0.00028566429648132846,
                    0.00023432394072644164, 0.0003311939240480223, 0.00029437224277905916,
                    0.00015777255284802152, 0.00020814746322452612, 0.00015400044199450832,
                    0.0003612003448622298, 0.00011887776945053929, 0.0003594816797032773,
                    0.0006376863388213525, 0.0002875991463519631, 0.0004533152532108888,
                    0.0004607975203377339, 0.00017578970634840984, 0.000807568985706062,
                    0.0019439677607081577, 0.0002622876626610714, 0.0006642617380107544,
                    0.0007243951148089038, 0.00021531489282496772, 0.00018432522335595937,
                    0.0003233705649471341, 0.00025697457073559364, 0.0001235054503824378,
                    0.00012904451097439372, 0.00011236829439441562, 0.00014654261158341813,
                    0.00014763743194328284, 0.0001424866988609799, 0.00035165531607400283,
                    9.80170594861329e-5, 0.00017933311301538755, 0.00015791750168882532,
                    9.898536681281736e-5, 0.00025060220750151277, 0.0002622876626610714,
                    0.0001436352172851801, 0.00030842844747419124, 0.00019461304720309267,
                    0.00011965896605266635, 0.00010286567711201824, 0.0001495971553492702,
                    9.751274127688749e-5, 0.00014769232337662517, 0.00017555532575084975,
                    0.00011840626406469592, 0.0002855692152789008, 0.00021354478307733898,
                    0.00025000607418868204, 0.0007051857143422411, 0.00010030740847661505,
                    0.00034919571221040025, 0.00026417199624891084, 0.00013163887518804002,
                    0.00046933615580751505, 0.0006642617380107544, 0.00030842844747419124,
                    0.0009937022125140937, 0.0003698115813784753, 0.0001674203572897601,
                    0.0001100023057274042, 0.0002694547457523458, 0.00011046648930414672,
                    0.00021413393297829334, 0.00024255096569986167, 0.00018950572095254131,
                    0.00028966540635829216, 0.00024208862389066358, 0.00022298856725204108,
                    0.0005109843708254457, 0.00023456418839848934, 0.0003033950107951737,
                    0.00029956342079475465, 0.00015556541001668378, 0.0005184235485318653,
                    0.0007243951148089038, 0.00019461304720309267, 0.0003698115813784753,
                    0.0005054585590745467, 0.00021306357940508217, 0.0001677908056676286,
                    0.0002503123163159305, 0.00021668072562953003, 0.0001818481042244945,
                    0.0001774039350092801, 0.0001874706887147314, 0.00022260824681193307,
                    0.00021950685809182794, 0.0001505236247353043, 0.0004228602188662458,
                    0.00013356417913589348, 0.00018923746112349475, 0.00017756909221152255,
                    0.00010328871956671789, 0.00028566429648132846, 0.00021531489282496772,
                    0.00011965896605266635, 0.0001674203572897601, 0.00021306357940508217,
                    0.0001624387273643113, 0.00012821572722683912, 0.00016457875186554408,
                    0.00014948158449467656, 0.00014175954924131363, 0.00013240499725859043,
                    0.00014026322820021283, 0.00014570031249772154, 0.00016123494128192145,
                    0.00012834085476196412, 0.0002913881301596775, 0.00011631807469254503,
                    0.0001511656726979, 0.00014436721773723147, 9.677298905141091e-5,
                    0.00023432394072644164, 0.00018432522335595937, 0.00010286567711201824,
                    0.0001100023057274042, 0.0001677908056676286, 0.00012821572722683912,
                    0.00012202561764009547, 0.00013320952315118176, 0.00011981243821704253,
                    0.00017814139859659352, 0.00018123463132009256, 0.00017992911839732578,
                    0.00022302618729465892, 0.00021244373439114245, 0.00017322432482065904,
                    0.00043378434020728145, 0.00013635686118298516, 0.0002195486694239333,
                    0.00019889544531880474, 0.00011810723576794285, 0.0003311939240480223,
                    0.0003233705649471341, 0.0001495971553492702, 0.0002694547457523458,
                    0.0002503123163159305, 0.00016457875186554408, 0.00013320952315118176,
                    0.0001849011455817157, 0.00015039693623930154, 0.0001675927816948642,
                    0.00016195195348442612, 0.000178243049722257, 0.00020621079581635413,
                    0.00020244325250221902, 0.00014455267315627196, 0.00030913460094692365,
                    0.00013335107262850643, 0.000176851750527614, 0.0001669499534029005,
                    9.258254298059739e-5, 0.00029437224277905916, 0.00025697457073559364,
                    9.751274127688749e-5, 0.00011046648930414672, 0.00021668072562953003,
                    0.00014948158449467656, 0.00011981243821704253, 0.00015039693623930154,
                    0.00015789185651061686], (20, 20))
    @test isapprox(portfolio.cov, covt)
end

@testset "Covariance Estimation Weighted" begin
    portfolio = Portfolio(; prices = prices)
    rf = 0.0329 / 252
    w = eweights(size(portfolio.returns, 1), 1 / size(portfolio.returns, 1); scale = true)
    c0 = StatsBase.SimpleCovariance(; corrected = false)
    c1 = PortCovCor(; ce = CovFull(; ce = c0, w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    @test isapprox(portfolio.cov, cov(c0, portfolio.returns, w))

    c1 = PortCovCor(; ce = CovSemi(; ce = c0, target = rf, mu_w = w, cov_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([9.621043838905131e-5, 6.358999985774661e-5, 8.353321020725778e-5,
                    8.331947537440016e-5, 8.149679755598909e-5, 5.031530927730727e-5,
                    0.00011621527289953164, 3.9103937512684226e-5, 6.911203024853585e-5,
                    6.265070598294052e-5, 3.590762901141954e-5, 6.604286903849441e-5,
                    8.064105726447188e-5, 4.3234003658089605e-5, 7.196926121288857e-5,
                    5.6268091265828246e-5, 6.26518043912791e-5, 4.3151345428359704e-5,
                    5.877751709491605e-5, 5.01815196987021e-5, 6.358999985774661e-5,
                    9.938829363940189e-5, 7.116535347212371e-5, 7.621801703665003e-5,
                    6.961036593365979e-5, 4.514253110045112e-5, 0.00012003855472198062,
                    3.5145245255652426e-5, 6.474450598781159e-5, 5.7755651968520436e-5,
                    3.370436628379075e-5, 6.76659652562613e-5, 9.49137587098754e-5,
                    4.1966748331071823e-5, 8.091979897049517e-5, 6.070372598206081e-5,
                    5.8106707282599386e-5, 3.438396547666106e-5, 5.37874094102696e-5,
                    4.407492910464201e-5, 8.353321020725778e-5, 7.116535347212371e-5,
                    0.00012636547212688013, 9.712049632109987e-5, 9.083448773660251e-5,
                    5.5661354133077885e-5, 0.00013206883737805649, 4.007350424933291e-5,
                    7.363716804345025e-5, 6.815157409701193e-5, 3.728586290713286e-5,
                    7.810578315512912e-5, 9.724547697541435e-5, 4.059515340300829e-5,
                    8.170498353631042e-5, 6.360758744039165e-5, 6.973261788188832e-5,
                    4.625370387458137e-5, 6.042448646370836e-5, 5.556918180008275e-5,
                    8.331947537440016e-5, 7.621801703665003e-5, 9.712049632109987e-5,
                    0.00018447610419218956, 9.844811635368036e-5, 6.404103914333712e-5,
                    0.00017580558681092574, 4.5561898959566895e-5, 8.790318116967006e-5,
                    8.189911528104646e-5, 4.517761501817459e-5, 9.204657865487172e-5,
                    0.00013125661671304812, 5.217442422396933e-5, 0.00012244623215355892,
                    7.581736367067463e-5, 7.563806971667599e-5, 4.843300107472182e-5,
                    7.304649862653152e-5, 5.689134409880626e-5, 8.149679755598909e-5,
                    6.961036593365979e-5, 9.083448773660251e-5, 9.844811635368036e-5,
                    0.00013517031787527766, 5.1645133577562685e-5, 0.00014216216566426032,
                    4.215167855131904e-5, 7.699450241913063e-5, 6.421032273181296e-5,
                    3.669842488093514e-5, 7.932462769049267e-5, 9.962153920425098e-5,
                    4.253533179571406e-5, 9.225992517705918e-5, 6.151871098230727e-5,
                    7.165458364217097e-5, 4.3042617916804766e-5, 6.207868209028688e-5,
                    6.098216799716828e-5, 5.031530927730727e-5, 4.514253110045112e-5,
                    5.5661354133077885e-5, 6.404103914333712e-5, 5.1645133577562685e-5,
                    0.00010236745434509997, 9.648499203209543e-5, 3.572332371792949e-5,
                    6.530392388795265e-5, 5.868349781225734e-5, 3.844020928686844e-5,
                    8.168130290684688e-5, 0.00012571870406140166, 4.0876880814996054e-5,
                    8.323250664984377e-5, 4.9980028241314824e-5, 4.500867141996436e-5,
                    3.6606052416813364e-5, 5.475014167356384e-5, 3.858765675679668e-5,
                    0.00011621527289953164, 0.00012003855472198062, 0.00013206883737805649,
                    0.00017580558681092574, 0.00014216216566426032, 9.648499203209543e-5,
                    0.0006601154921665957, 6.970555254259665e-5, 0.0001511686494955581,
                    0.0001372310493660601, 8.157304743700411e-5, 0.00014805218829166028,
                    0.0002465103315279907, 8.414219361979122e-5, 0.000208538860401102,
                    0.00013838235653348504, 0.00011652181864515243, 8.121908770076569e-5,
                    0.00012059220651476437, 8.36717076257129e-5, 3.9103937512684226e-5,
                    3.5145245255652426e-5, 4.007350424933291e-5, 4.5561898959566895e-5,
                    4.215167855131904e-5, 3.572332371792949e-5, 6.970555254259665e-5,
                    8.914254783778881e-5, 4.262306955505077e-5, 4.221390230597525e-5,
                    3.032470926350991e-5, 5.3779699457742426e-5, 0.0001093055189011707,
                    3.2616059787567015e-5, 5.3728942881277366e-5, 5.8456138427024594e-5,
                    3.481355765332708e-5, 3.264967781179191e-5, 3.927822397024826e-5,
                    3.3293295072218566e-5, 6.911203024853585e-5, 6.474450598781159e-5,
                    7.363716804345025e-5, 8.790318116967006e-5, 7.699450241913063e-5,
                    6.530392388795265e-5, 0.0001511686494955581, 4.262306955505077e-5,
                    0.00013941843405422736, 8.21638974814396e-5, 4.189879746359169e-5,
                    9.218429894294817e-5, 0.0001288650464322309, 5.7024854553561074e-5,
                    0.00010800810195930344, 7.881093777946663e-5, 7.111945232614835e-5,
                    5.014895794922752e-5, 0.0001024900330275506, 5.119495612450621e-5,
                    6.265070598294052e-5, 5.7755651968520436e-5, 6.815157409701193e-5,
                    8.189911528104646e-5, 6.421032273181296e-5, 5.868349781225734e-5,
                    0.0001372310493660601, 4.221390230597525e-5, 8.21638974814396e-5,
                    0.00012112671783360837, 4.3497095199214675e-5, 9.185075881104027e-5,
                    0.00013765743413012235, 4.9067782867305104e-5, 0.00010201468315891567,
                    7.376974842027644e-5, 5.4984143179928906e-5, 4.4044308716616114e-5,
                    6.779578758901103e-5, 4.746894746575861e-5, 3.590762901141954e-5,
                    3.370436628379075e-5, 3.728586290713286e-5, 4.517761501817459e-5,
                    3.669842488093514e-5, 3.844020928686844e-5, 8.157304743700411e-5,
                    3.032470926350991e-5, 4.189879746359169e-5, 4.3497095199214675e-5,
                    5.858579359260336e-5, 4.610099202301754e-5, 7.850765613457797e-5,
                    3.1898725369141094e-5, 6.091104173706569e-5, 3.965471426146413e-5,
                    3.198932721202842e-5, 2.808010768108654e-5, 3.676908691280522e-5,
                    2.7353368950187097e-5, 6.604286903849441e-5, 6.76659652562613e-5,
                    7.810578315512912e-5, 9.204657865487172e-5, 7.932462769049267e-5,
                    8.168130290684688e-5, 0.00014805218829166028, 5.3779699457742426e-5,
                    9.218429894294817e-5, 9.185075881104027e-5, 4.610099202301754e-5,
                    0.00042659606571972573, 0.00019259146898408433, 5.5926367089037634e-5,
                    0.00013679678858548265, 0.00010319900677543598, 6.734933877979462e-5,
                    5.131790475168186e-5, 7.75498657371874e-5, 6.41586782728639e-5,
                    8.064105726447188e-5, 9.49137587098754e-5, 9.724547697541435e-5,
                    0.00013125661671304812, 9.962153920425098e-5, 0.00012571870406140166,
                    0.0002465103315279907, 0.0001093055189011707, 0.0001288650464322309,
                    0.00013765743413012235, 7.850765613457797e-5, 0.00019259146898408433,
                    0.0008703719920977757, 8.49442264155263e-5, 0.0002662983381878127,
                    0.00017598011556805182, 8.130261653388715e-5, 7.051236305752997e-5,
                    9.41949954664612e-5, 9.217240825006838e-5, 4.3234003658089605e-5,
                    4.1966748331071823e-5, 4.059515340300829e-5, 5.217442422396933e-5,
                    4.253533179571406e-5, 4.0876880814996054e-5, 8.414219361979122e-5,
                    3.2616059787567015e-5, 5.7024854553561074e-5, 4.9067782867305104e-5,
                    3.1898725369141094e-5, 5.5926367089037634e-5, 8.49442264155263e-5,
                    6.800605353923648e-5, 8.87379102968888e-5, 4.677305950136884e-5,
                    4.089463952296339e-5, 3.2820427968191384e-5, 4.93883443653379e-5,
                    3.2176824087434216e-5, 7.196926121288857e-5, 8.091979897049517e-5,
                    8.170498353631042e-5, 0.00012244623215355892, 9.225992517705918e-5,
                    8.323250664984377e-5, 0.000208538860401102, 5.3728942881277366e-5,
                    0.00010800810195930344, 0.00010201468315891567, 6.091104173706569e-5,
                    0.00013679678858548265, 0.0002662983381878127, 8.87379102968888e-5,
                    0.00045372539845231285, 0.00011163110746871011, 7.349598078115978e-5,
                    5.423827528696571e-5, 8.609707249376065e-5, 6.242194467933265e-5,
                    5.6268091265828246e-5, 6.070372598206081e-5, 6.360758744039165e-5,
                    7.581736367067463e-5, 6.151871098230727e-5, 4.9980028241314824e-5,
                    0.00013838235653348504, 5.8456138427024594e-5, 7.881093777946663e-5,
                    7.376974842027644e-5, 3.965471426146413e-5, 0.00010319900677543598,
                    0.00017598011556805182, 4.677305950136884e-5, 0.00011163110746871011,
                    0.00022468782269403025, 5.4685086886001814e-5, 4.382288752182102e-5,
                    6.294494163991495e-5, 4.9175136060117616e-5, 6.26518043912791e-5,
                    5.8106707282599386e-5, 6.973261788188832e-5, 7.563806971667599e-5,
                    7.165458364217097e-5, 4.500867141996436e-5, 0.00011652181864515243,
                    3.481355765332708e-5, 7.111945232614835e-5, 5.4984143179928906e-5,
                    3.198932721202842e-5, 6.734933877979462e-5, 8.130261653388715e-5,
                    4.089463952296339e-5, 7.349598078115978e-5, 5.4685086886001814e-5,
                    8.142496446321765e-5, 3.936942857290476e-5, 5.8824421663507934e-5,
                    4.430777574173535e-5, 4.3151345428359704e-5, 3.438396547666106e-5,
                    4.625370387458137e-5, 4.843300107472182e-5, 4.3042617916804766e-5,
                    3.6606052416813364e-5, 8.121908770076569e-5, 3.264967781179191e-5,
                    5.014895794922752e-5, 4.4044308716616114e-5, 2.808010768108654e-5,
                    5.131790475168186e-5, 7.051236305752997e-5, 3.2820427968191384e-5,
                    5.423827528696571e-5, 4.382288752182102e-5, 3.936942857290476e-5,
                    5.585665135466087e-5, 4.298696573159893e-5, 3.166012710035925e-5,
                    5.877751709491605e-5, 5.37874094102696e-5, 6.042448646370836e-5,
                    7.304649862653152e-5, 6.207868209028688e-5, 5.475014167356384e-5,
                    0.00012059220651476437, 3.927822397024826e-5, 0.0001024900330275506,
                    6.779578758901103e-5, 3.676908691280522e-5, 7.75498657371874e-5,
                    9.41949954664612e-5, 4.93883443653379e-5, 8.609707249376065e-5,
                    6.294494163991495e-5, 5.8824421663507934e-5, 4.298696573159893e-5,
                    8.984494996233074e-5, 4.258713468654801e-5, 5.01815196987021e-5,
                    4.407492910464201e-5, 5.556918180008275e-5, 5.689134409880626e-5,
                    6.098216799716828e-5, 3.858765675679668e-5, 8.36717076257129e-5,
                    3.3293295072218566e-5, 5.119495612450621e-5, 4.746894746575861e-5,
                    2.7353368950187097e-5, 6.41586782728639e-5, 9.217240825006838e-5,
                    3.2176824087434216e-5, 6.242194467933265e-5, 4.9175136060117616e-5,
                    4.430777574173535e-5, 3.166012710035925e-5, 4.258713468654801e-5,
                    8.296254897326261e-5], (20, 20))
    @test isapprox(portfolio.cov, covt)

    ve = SimpleVariance(; corrected = false)

    normalise = false
    c1 = PortCovCor(;
                    ce = CorGerber0(; normalise = normalise, mean_w = w, ve = ve,
                                    std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.0001333968242010015, 0.00019183773617947292,
                    0.000194277918267779, 0.00022122131074275473, 9.684191452822541e-5,
                    0.0002795608212094419, 8.831227232066488e-5, 0.0001292885716905384,
                    0.0001113645126594343, 6.922599187771085e-5, 0.00019593261619522598,
                    5.861017241316661e-5, 6.845759617563268e-5, 5.935148974052885e-5,
                    0.00012442302114643708, 0.00013563033566165464, 9.264941264707135e-5,
                    0.00011781875748292913, 0.00012626820762383495, 0.0001333968242010015,
                    0.00020060062616370064, 0.00015047563041361328, 0.00014725846673473598,
                    0.00017018489244212113, 0.00010036156155057771, 0.00030592943315543234,
                    8.739715572096956e-5, 0.00013657458571129087, 0.00011278696282570545,
                    6.689945472660234e-5, 0.00019345577934365047, 7.294496036689861e-5,
                    7.935150747197551e-5, 9.638285570449505e-5, 0.00015564898333945003,
                    0.00012529593905692934, 7.854287763307539e-5, 0.00011960016001400105,
                    9.981061763561958e-5, 0.00019183773617947292, 0.00015047563041361328,
                    0.00025023180181571545, 0.00018972936272964607, 0.0002286329339145841,
                    9.534929366979272e-5, 0.00028386618243798407, 5.678944139781563e-5,
                    0.00013709139507161628, 0.00011019484379071962, 5.70789985776054e-5,
                    0.0002232025008219375, 9.177111877853128e-5, 4.815249077361892e-5,
                    4.3700385788075515e-5, 0.00010125294945692465, 0.00014845649189103177,
                    8.101589333180262e-5, 0.00011879286852745387, 0.0001253094937423254,
                    0.000194277918267779, 0.00014725846673473598, 0.00018972936272964607,
                    0.00039197799320071677, 0.00023777544884787116, 0.0001195277886702471,
                    0.000369875996993491, 8.687886914968376e-5, 0.00014171213780645898,
                    0.0001208890729464597, 6.225044517171332e-5, 0.00025915845782133044,
                    0.0002058622037697291, 8.275800373143763e-5, 0.0001175872192056748,
                    0.00015501355385873192, 0.00016236840626154697, 8.368896612002356e-5,
                    0.0001324664594261486, 0.00011654857356214968, 0.00022122131074275473,
                    0.00017018489244212113, 0.0002286329339145841, 0.00023777544884787116,
                    0.00030911461216782526, 0.00011232713078622691, 0.000312097957098231,
                    9.582213978846758e-5, 0.00014307428446338807, 0.00011226720899470402,
                    6.656125331080196e-5, 0.0002165464730486501, 4.40195169291817e-5,
                    6.946619911229863e-5, 0.0001022477192749545, 0.000136434573165733,
                    0.00016626850852904455, 8.6514748658912e-5, 0.00013513988643194848,
                    0.0001533520581881595, 9.684191452822541e-5, 0.00010036156155057771,
                    9.534929366979272e-5, 0.0001195277886702471, 0.00011232713078622691,
                    0.0001915128908033608, 0.00019683612706303648, 8.623505708791997e-5,
                    0.0001636847305842682, 0.00014749777594465425, 7.964082278993963e-5,
                    0.00022252324921014514, 0.0002336104372168666, 0.00010553030434148043,
                    0.00013663981341474296, 0.0001239858921705648, 9.448831870880962e-5,
                    8.683350787415143e-5, 0.00013675208836738431, 0.00010627354602096927,
                    0.0002795608212094419, 0.00030592943315543234, 0.00028386618243798407,
                    0.000369875996993491, 0.000312097957098231, 0.00019683612706303648,
                    0.0016063027844326404, 0.00017785542477878207, 0.00028447764664428623,
                    0.0002972436525354247, 0.0001306069721517743, 0.00031627028508613553,
                    0.00038224486182952594, 0.00017332034355391373, 0.00038326214230463936,
                    0.00031784975524990573, 0.00028464320647342837, 0.00016998494973050906,
                    0.00027246104617719455, 0.00017392444629763077, 8.831227232066488e-5,
                    8.739715572096956e-5, 5.678944139781563e-5, 8.687886914968376e-5,
                    9.582213978846758e-5, 8.623505708791997e-5, 0.00017785542477878207,
                    0.00017038019135706003, 7.150088423284018e-5, 9.576644654993318e-5,
                    7.757087250525891e-5, 0.00015143788648078427, 0.0001743300574663396,
                    4.907028723085462e-5, 4.3408884911949044e-5, 0.00015848576632736228,
                    8.361233935430868e-5, 8.228197075579291e-5, 7.55851694938512e-5,
                    9.09228457063453e-5, 0.0001292885716905384, 0.00013657458571129087,
                    0.00013709139507161628, 0.00014171213780645898, 0.00014307428446338807,
                    0.0001636847305842682, 0.00028447764664428623, 7.150088423284018e-5,
                    0.00026904101047426043, 0.00017723660965165768, 7.199175713188254e-5,
                    0.00027246537728102023, 0.0002756010090602498, 0.00012326701896070883,
                    0.0001913941624914223, 0.00020887305516231318, 0.00013368460799161505,
                    9.790181535783517e-5, 0.00020848101532411432, 0.00010726864344449147,
                    0.0001113645126594343, 0.00011278696282570545, 0.00011019484379071962,
                    0.0001208890729464597, 0.00011226720899470402, 0.00014749777594465425,
                    0.0002972436525354247, 9.576644654993318e-5, 0.00017723660965165768,
                    0.00024075963524820054, 7.288215085279877e-5, 0.00026633174947749056,
                    0.00026384104046261195, 0.00010105019366589963, 0.00013559340644747245,
                    0.00020538704754510296, 0.00011471573538819634, 8.347680354505229e-5,
                    0.00015040077899936257, 0.00010575313169419456, 6.922599187771085e-5,
                    6.689945472660234e-5, 5.70789985776054e-5, 6.225044517171332e-5,
                    6.656125331080196e-5, 7.964082278993963e-5, 0.0001306069721517743,
                    7.757087250525891e-5, 7.199175713188254e-5, 7.288215085279877e-5,
                    0.00011254732252706103, 0.00011536203161025307, 0.00010332320689011474,
                    6.49487678528232e-5, 8.14311312732764e-5, 9.58028258911447e-5,
                    6.389935555492083e-5, 6.106379707230526e-5, 8.35508029083752e-5,
                    5.242864723352527e-5, 0.00019593261619522598, 0.00019345577934365047,
                    0.0002232025008219375, 0.00025915845782133044, 0.0002165464730486501,
                    0.00022252324921014514, 0.00031627028508613553, 0.00015143788648078427,
                    0.00027246537728102023, 0.00026633174947749056, 0.00011536203161025307,
                    0.0007824998303617654, 0.0005862305011752345, 0.00015945041223337471,
                    0.00029799637402808387, 0.00036674810507686124, 0.00018257200940572767,
                    0.00016173124683101716, 0.00023620349571479667, 0.00021506636323368432,
                    5.861017241316661e-5, 7.294496036689861e-5, 9.177111877853128e-5,
                    0.0002058622037697291, 4.40195169291817e-5, 0.0002336104372168666,
                    0.00038224486182952594, 0.0001743300574663396, 0.0002756010090602498,
                    0.00026384104046261195, 0.00010332320689011474, 0.0005862305011752345,
                    0.0020414865940008354, 0.00012683190646005003, 0.00033772628451720493,
                    0.0004073726176811445, 0.00011705741387689168, 0.00010304307932421887,
                    0.00018606796133679431, 0.00014765448853540407, 6.845759617563268e-5,
                    7.935150747197551e-5, 4.815249077361892e-5, 8.275800373143763e-5,
                    6.946619911229863e-5, 0.00010553030434148043, 0.00017332034355391373,
                    4.907028723085462e-5, 0.00012326701896070883, 0.00010105019366589963,
                    6.49487678528232e-5, 0.00015945041223337471, 0.00012683190646005003,
                    0.00013364641145961862, 0.00022017437110599577, 0.00011341846081506002,
                    8.238025980349429e-5, 6.288194933471046e-5, 0.00011157312955615532,
                    4.5494440600098644e-5, 5.935148974052885e-5, 9.638285570449505e-5,
                    4.3700385788075515e-5, 0.0001175872192056748, 0.0001022477192749545,
                    0.00013663981341474296, 0.00038326214230463936, 4.3408884911949044e-5,
                    0.0001913941624914223, 0.00013559340644747245, 8.14311312732764e-5,
                    0.00029799637402808387, 0.00033772628451720493, 0.00022017437110599577,
                    0.0009593985028265281, 0.0002022492838747159, 7.976533156776911e-5,
                    4.540294560509339e-5, 0.00015215824054337502, 5.3896963937872516e-5,
                    0.00012442302114643708, 0.00015564898333945003, 0.00010125294945692465,
                    0.00015501355385873192, 0.000136434573165733, 0.0001239858921705648,
                    0.00031784975524990573, 0.00015848576632736228, 0.00020887305516231318,
                    0.00020538704754510296, 9.58028258911447e-5, 0.00036674810507686124,
                    0.0004073726176811445, 0.00011341846081506002, 0.0002022492838747159,
                    0.0005073871321777783, 0.00014015589040378823, 9.057294410115198e-5,
                    0.0001640794311744225, 0.00013253909530248152, 0.00013563033566165464,
                    0.00012529593905692934, 0.00014845649189103177, 0.00016236840626154697,
                    0.00016626850852904455, 9.448831870880962e-5, 0.00028464320647342837,
                    8.361233935430868e-5, 0.00013368460799161505, 0.00011471573538819634,
                    6.389935555492083e-5, 0.00018257200940572767, 0.00011705741387689168,
                    8.238025980349429e-5, 7.976533156776911e-5, 0.00014015589040378823,
                    0.00015395471447026042, 9.266459802928348e-5, 0.00012735275094044864,
                    0.00011142320610596043, 9.264941264707135e-5, 7.854287763307539e-5,
                    8.101589333180262e-5, 8.368896612002356e-5, 8.6514748658912e-5,
                    8.683350787415143e-5, 0.00016998494973050906, 8.228197075579291e-5,
                    9.790181535783517e-5, 8.347680354505229e-5, 6.106379707230526e-5,
                    0.00016173124683101716, 0.00010304307932421887, 6.288194933471046e-5,
                    4.540294560509339e-5, 9.057294410115198e-5, 9.266459802928348e-5,
                    0.000119328491029678, 9.101505725713764e-5, 7.105687268365917e-5,
                    0.00011781875748292913, 0.00011960016001400105, 0.00011879286852745387,
                    0.0001324664594261486, 0.00013513988643194848, 0.00013675208836738431,
                    0.00027246104617719455, 7.55851694938512e-5, 0.00020848101532411432,
                    0.00015040077899936257, 8.35508029083752e-5, 0.00023620349571479667,
                    0.00018606796133679431, 0.00011157312955615532, 0.00015215824054337502,
                    0.0001640794311744225, 0.00012735275094044864, 9.101505725713764e-5,
                    0.00017798467979133597, 9.647337611705316e-5, 0.00012626820762383495,
                    9.981061763561958e-5, 0.0001253094937423254, 0.00011654857356214968,
                    0.0001533520581881595, 0.00010627354602096927, 0.00017392444629763077,
                    9.09228457063453e-5, 0.00010726864344449147, 0.00010575313169419456,
                    5.242864723352527e-5, 0.00021506636323368432, 0.00014765448853540407,
                    4.5494440600098644e-5, 5.3896963937872516e-5, 0.00013253909530248152,
                    0.00011142320610596043, 7.105687268365917e-5, 9.647337611705316e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    @test isapprox(var(ve, portfolio.returns, w), std(ve, portfolio.returns, w) .^ 2)
    @test !isapprox(var(ve, portfolio.returns, w), var(ve, portfolio.returns))

    c1 = PortCovCor(;
                    ce = CorGerber1(; normalise = normalise, mean_w = w, ve = ve,
                                    std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 5.937281091275969e-5, 9.782587834558456e-5,
                    8.222580569629747e-5, 0.00010619965521802596, 3.92626947363604e-5,
                    9.459234366239403e-5, 3.2135982604116335e-5, 5.551230302710897e-5,
                    4.5631153853385406e-5, 2.59262425583515e-5, 6.720333682604531e-5,
                    2.1099297327024752e-5, 2.6944281757890624e-5, 2.3684105782662102e-5,
                    4.557060743834735e-5, 6.721717448248055e-5, 3.725671473519816e-5,
                    5.1281415566350224e-5, 5.1711919550780464e-5, 5.937281091275969e-5,
                    0.00020060062616370064, 6.63317595363856e-5, 6.231383370120125e-5,
                    7.410693243919343e-5, 3.987563776940697e-5, 0.00010929886851152596,
                    3.269288737218035e-5, 5.5446544098854815e-5, 4.388792550137486e-5,
                    2.6333641150314162e-5, 6.676030630067222e-5, 2.6158140503725268e-5,
                    3.194853316479534e-5, 3.976686960234564e-5, 5.8638499125578e-5,
                    5.6332798784110005e-5, 3.2495433590865855e-5, 5.032902710599095e-5,
                    4.23912864463964e-5, 9.782587834558456e-5, 6.63317595363856e-5,
                    0.00025023180181571545, 7.998284086210479e-5, 0.00011302990649063083,
                    3.87548174388224e-5, 9.776538709512171e-5, 2.0389222872267104e-5,
                    5.545838648085744e-5, 4.405513362837255e-5, 2.3575656464571102e-5,
                    7.409954356355613e-5, 3.125659436817376e-5, 1.9101955398648804e-5,
                    1.7752588553909414e-5, 3.5964039441799216e-5, 6.89120369788266e-5,
                    3.265508711629477e-5, 4.895573767811374e-5, 5.114518334692284e-5,
                    8.222580569629747e-5, 6.231383370120125e-5, 7.998284086210479e-5,
                    0.00039197799320071677, 9.829041199542211e-5, 4.815011392632967e-5,
                    0.00013490652423090333, 3.131265470831126e-5, 5.59735704069737e-5,
                    4.9903000454879644e-5, 2.4530016589476338e-5, 8.758171107922472e-5,
                    7.541255656358924e-5, 3.215964376603105e-5, 4.91293719162136e-5,
                    5.4732041848679474e-5, 7.055683006063048e-5, 3.360554431174196e-5,
                    5.4606298725612963e-5, 4.665318330907518e-5, 0.00010619965521802596,
                    7.410693243919343e-5, 0.00011302990649063083, 9.829041199542211e-5,
                    0.00030911461216782526, 4.2754036670476684e-5, 0.00011383683815737216,
                    3.559179590864105e-5, 5.758653536105111e-5, 4.610185380653642e-5,
                    2.7260737448301274e-5, 7.241938140398263e-5, 1.543655086359566e-5,
                    2.7354955438089267e-5, 4.0723499120247705e-5, 4.9110397490550595e-5,
                    7.502165463196533e-5, 3.1509474989572996e-5, 5.310757300530722e-5,
                    5.93872499727085e-5, 3.92626947363604e-5, 3.987563776940697e-5,
                    3.87548174388224e-5, 4.815011392632967e-5, 4.2754036670476684e-5,
                    0.0001915128908033608, 6.722932695063908e-5, 3.073451578802462e-5,
                    6.450204308282999e-5, 6.0017442076510305e-5, 3.295353991831282e-5,
                    8.457996839290987e-5, 8.180312212155505e-5, 4.0746028754113917e-5,
                    5.429091998837741e-5, 4.560576425677421e-5, 4.1037601935217084e-5,
                    3.486706796194263e-5, 5.468190262462182e-5, 3.919741362476295e-5,
                    9.459234366239403e-5, 0.00010929886851152596, 9.776538709512171e-5,
                    0.00013490652423090333, 0.00011383683815737216, 6.722932695063908e-5,
                    0.0016063027844326404, 5.794077514613831e-5, 0.00011025841264732062,
                    0.00010160798535955693, 4.385350022897935e-5, 9.207344820638532e-5,
                    0.00012235599607311092, 5.6676705251559095e-5, 0.00013793380441673304,
                    0.00010740506581872003, 0.00010634367047481062, 5.43863483568351e-5,
                    8.994075087063151e-5, 5.988810878018712e-5, 3.2135982604116335e-5,
                    3.269288737218035e-5, 2.0389222872267104e-5, 3.131265470831126e-5,
                    3.559179590864105e-5, 3.073451578802462e-5, 5.794077514613831e-5,
                    0.00017038019135706003, 2.577142247053196e-5, 3.510203031358198e-5,
                    2.9917835125739065e-5, 5.1641176819575673e-5, 6.14155787024193e-5,
                    1.8952418933800415e-5, 1.5190648777701121e-5, 6.016284100436549e-5,
                    3.19426777363142e-5, 2.9791020479366375e-5, 2.7423768639680074e-5,
                    3.241304847437189e-5, 5.551230302710897e-5, 5.5446544098854815e-5,
                    5.545838648085744e-5, 5.59735704069737e-5, 5.758653536105111e-5,
                    6.450204308282999e-5, 0.00011025841264732062, 2.577142247053196e-5,
                    0.00026904101047426043, 7.822028431074544e-5, 2.991221330742123e-5,
                    9.349191215723511e-5, 0.00010047114271113548, 4.993081182392901e-5,
                    7.627986664685944e-5, 8.22330943877359e-5, 6.330306844326169e-5,
                    4.053137058446667e-5, 0.00013433319154420692, 4.345891920710068e-5,
                    4.5631153853385406e-5, 4.388792550137486e-5, 4.405513362837255e-5,
                    4.9903000454879644e-5, 4.610185380653642e-5, 6.0017442076510305e-5,
                    0.00010160798535955693, 3.510203031358198e-5, 7.822028431074544e-5,
                    0.00024075963524820054, 3.110956010167236e-5, 0.00010074793996884361,
                    0.00010191853847755421, 3.923905602908782e-5, 5.49848592562886e-5,
                    8.4763437022004e-5, 4.664715560016418e-5, 3.4580682724574436e-5,
                    6.494936454936738e-5, 4.338885032390374e-5, 2.59262425583515e-5,
                    2.6333641150314162e-5, 2.3575656464571102e-5, 2.4530016589476338e-5,
                    2.7260737448301274e-5, 3.295353991831282e-5, 4.385350022897935e-5,
                    2.9917835125739065e-5, 2.991221330742123e-5, 3.110956010167236e-5,
                    0.00011254732252706103, 4.160228561366284e-5, 3.692466738305708e-5,
                    2.6966899167465744e-5, 3.454030455907403e-5, 3.5482927874208786e-5,
                    2.7537423030669424e-5, 2.373616144535814e-5, 3.4687456009884105e-5,
                    2.2266881513583767e-5, 6.720333682604531e-5, 6.676030630067222e-5,
                    7.409954356355613e-5, 8.758171107922472e-5, 7.241938140398263e-5,
                    8.457996839290987e-5, 9.207344820638532e-5, 5.1641176819575673e-5,
                    9.349191215723511e-5, 0.00010074793996884361, 4.160228561366284e-5,
                    0.0007824998303617654, 0.00018861393243914092, 5.079619455207317e-5,
                    0.00010928151349044172, 0.00012477295837766154, 6.756485905946874e-5,
                    5.2718570153603406e-5, 7.85358592240922e-5, 7.455556415812571e-5,
                    2.1099297327024752e-5, 2.6158140503725268e-5, 3.125659436817376e-5,
                    7.541255656358924e-5, 1.543655086359566e-5, 8.180312212155505e-5,
                    0.00012235599607311092, 6.14155787024193e-5, 0.00010047114271113548,
                    0.00010191853847755421, 3.692466738305708e-5, 0.00018861393243914092,
                    0.0020414865940008354, 4.727394609533572e-5, 0.00013498719723309413,
                    0.00014208407470933106, 4.488236310365604e-5, 3.4994348235607265e-5,
                    6.958721701796767e-5, 5.526876769544382e-5, 2.6944281757890624e-5,
                    3.194853316479534e-5, 1.9101955398648804e-5, 3.215964376603105e-5,
                    2.7354955438089267e-5, 4.0746028754113917e-5, 5.6676705251559095e-5,
                    1.8952418933800415e-5, 4.993081182392901e-5, 3.923905602908782e-5,
                    2.6966899167465744e-5, 5.079619455207317e-5, 4.727394609533572e-5,
                    0.00013364641145961862, 9.35708616460326e-5, 4.124418059799822e-5,
                    3.696720472006602e-5, 2.5020524923667997e-5, 4.7455505163365266e-5,
                    1.7859007630846963e-5, 2.3684105782662102e-5, 3.976686960234564e-5,
                    1.7752588553909414e-5, 4.91293719162136e-5, 4.0723499120247705e-5,
                    5.429091998837741e-5, 0.00013793380441673304, 1.5190648777701121e-5,
                    7.627986664685944e-5, 5.49848592562886e-5, 3.454030455907403e-5,
                    0.00010928151349044172, 0.00013498719723309413, 9.35708616460326e-5,
                    0.0009593985028265281, 7.683929899342878e-5, 3.4688150224465575e-5,
                    1.699052735715414e-5, 5.693638691651939e-5, 2.1850297982504607e-5,
                    4.557060743834735e-5, 5.8638499125578e-5, 3.5964039441799216e-5,
                    5.4732041848679474e-5, 4.9110397490550595e-5, 4.560576425677421e-5,
                    0.00010740506581872003, 6.016284100436549e-5, 8.22330943877359e-5,
                    8.4763437022004e-5, 3.5482927874208786e-5, 0.00012477295837766154,
                    0.00014208407470933106, 4.124418059799822e-5, 7.683929899342878e-5,
                    0.0005073871321777783, 5.341933599742322e-5, 3.3251411007877435e-5,
                    6.384668351977325e-5, 4.955521413165801e-5, 6.721717448248055e-5,
                    5.6332798784110005e-5, 6.89120369788266e-5, 7.055683006063048e-5,
                    7.502165463196533e-5, 4.1037601935217084e-5, 0.00010634367047481062,
                    3.19426777363142e-5, 6.330306844326169e-5, 4.664715560016418e-5,
                    2.7537423030669424e-5, 6.756485905946874e-5, 4.488236310365604e-5,
                    3.696720472006602e-5, 3.4688150224465575e-5, 5.341933599742322e-5,
                    0.00015395471447026042, 3.8845151368512964e-5, 5.8104838134376495e-5,
                    4.810383732397588e-5, 3.725671473519816e-5, 3.2495433590865855e-5,
                    3.265508711629477e-5, 3.360554431174196e-5, 3.1509474989572996e-5,
                    3.486706796194263e-5, 5.43863483568351e-5, 2.9791020479366375e-5,
                    4.053137058446667e-5, 3.4580682724574436e-5, 2.373616144535814e-5,
                    5.2718570153603406e-5, 3.4994348235607265e-5, 2.5020524923667997e-5,
                    1.699052735715414e-5, 3.3251411007877435e-5, 3.8845151368512964e-5,
                    0.000119328491029678, 3.985305464754324e-5, 3.115041466527209e-5,
                    5.1281415566350224e-5, 5.032902710599095e-5, 4.895573767811374e-5,
                    5.4606298725612963e-5, 5.310757300530722e-5, 5.468190262462182e-5,
                    8.994075087063151e-5, 2.7423768639680074e-5, 0.00013433319154420692,
                    6.494936454936738e-5, 3.4687456009884105e-5, 7.85358592240922e-5,
                    6.958721701796767e-5, 4.7455505163365266e-5, 5.693638691651939e-5,
                    6.384668351977325e-5, 5.8104838134376495e-5, 3.985305464754324e-5,
                    0.00017798467979133597, 3.992425035115804e-5, 5.1711919550780464e-5,
                    4.23912864463964e-5, 5.114518334692284e-5, 4.665318330907518e-5,
                    5.93872499727085e-5, 3.919741362476295e-5, 5.988810878018712e-5,
                    3.241304847437189e-5, 4.345891920710068e-5, 4.338885032390374e-5,
                    2.2266881513583767e-5, 7.455556415812571e-5, 5.526876769544382e-5,
                    1.7859007630846963e-5, 2.1850297982504607e-5, 4.955521413165801e-5,
                    4.810383732397588e-5, 3.115041466527209e-5, 3.992425035115804e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(;
                    ce = CorGerber2(; normalise = normalise, mean_w = w, ve = ve,
                                    std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.0001986461942518414, 8.219478332583836e-5, 0.00012957422501837712,
                    0.00011564172795602978, 0.00014355301671697645, 5.58577378111604e-5,
                    0.00014144758609927822, 4.714209517479255e-5, 7.787378258010738e-5,
                    6.480656613679467e-5, 3.779626520172468e-5, 0.00010026282250679006,
                    3.101486537375358e-5, 3.869218861043138e-5, 3.3955837242103855e-5,
                    6.669112843408608e-5, 9.002888263189854e-5, 5.313903231632269e-5,
                    7.131669613197604e-5, 7.347192941912554e-5, 8.219478332583836e-5,
                    0.0002006006261637007, 9.207368608026156e-5, 8.75766534743178e-5,
                    0.00010332454313465516, 5.710626772692632e-5, 0.00016135786056775884,
                    4.7658414770810515e-5, 7.893753056187652e-5, 6.319719129348889e-5,
                    3.781086619049571e-5, 9.963528597699351e-5, 3.8493200128706405e-5,
                    4.556235539030288e-5, 5.638090405129697e-5, 8.526804986174368e-5,
                    7.774901755482544e-5, 4.598543078843762e-5, 7.07875385173279e-5,
                    5.952242476685643e-5, 0.00012957422501837712, 9.207368608026156e-5,
                    0.0002502318018157154, 0.00011255634071348021, 0.0001513331177687725,
                    5.511753557053166e-5, 0.00014562301680793314, 3.003503110701322e-5,
                    7.906438047190778e-5, 6.297053129174449e-5, 3.340250219249262e-5,
                    0.00011157365154249237, 4.6620145918299854e-5, 2.736097049819164e-5,
                    2.529052716851659e-5, 5.3093831514844e-5, 9.419395441370796e-5,
                    4.65503654117238e-5, 6.925462842061672e-5, 7.2682530031499e-5,
                    0.00011564172795602978, 8.75766534743178e-5, 0.00011255634071348021,
                    0.00039197799320071677, 0.00013920451479946527, 6.872315114109327e-5,
                    0.00019817338314475464, 4.612882974592176e-5, 8.023588272434827e-5,
                    7.06439058694159e-5, 3.519199187628954e-5, 0.0001314963694539066,
                    0.00011039214610997702, 4.632423411693351e-5, 6.938469914830167e-5,
                    8.103516834264953e-5, 9.837079646162375e-5, 4.7986716172197275e-5,
                    7.737108116915099e-5, 6.663786778519997e-5, 0.00014355301671697645,
                    0.00010332454313465516, 0.0001513331177687725, 0.00013920451479946527,
                    0.0003091146121678252, 6.195443005398243e-5, 0.00016684288769339332,
                    5.191246344621788e-5, 8.199279194728158e-5, 6.542289571270377e-5,
                    3.870192139725493e-5, 0.00010864507459743642, 2.2914405526984115e-5,
                    3.924947978959023e-5, 5.8519541957125885e-5, 7.226669310269816e-5,
                    0.00010350173116052551, 4.620021707584661e-5, 7.642975172016838e-5,
                    8.573857168723539e-5, 5.58577378111604e-5, 5.710626772692632e-5,
                    5.511753557053166e-5, 6.872315114109327e-5, 6.195443005398243e-5,
                    0.00019151289080336086, 0.00010027003477261633, 4.53269133675563e-5,
                    9.269721156634642e-5, 8.543299768306567e-5, 4.6711821085838515e-5,
                    0.0001227331491632604, 0.00012126469265091802, 5.8826489644367995e-5,
                    7.803313742258276e-5, 6.667067421014294e-5, 5.73299209894681e-5,
                    4.975544672288667e-5, 7.806615260867241e-5, 5.736875862939942e-5,
                    0.00014144758609927822, 0.00016135786056775884, 0.00014562301680793314,
                    0.00019817338314475464, 0.00016684288769339332, 0.00010027003477261633,
                    0.0016063027844326401, 8.740321108626578e-5, 0.00015905578260264335,
                    0.00015184654425381836, 6.58469865279133e-5, 0.00014263191678377294,
                    0.00018580425211628786, 8.552701859249089e-5, 0.00020427829609685505,
                    0.0001606028291339101, 0.000155303260146172, 8.245606329573359e-5,
                    0.00013552029769693132, 8.938564279384991e-5, 4.714209517479255e-5,
                    4.7658414770810515e-5, 3.003503110701322e-5, 4.612882974592176e-5,
                    5.191246344621788e-5, 4.53269133675563e-5, 8.740321108626578e-5,
                    0.00017038019135706006, 3.793419807982137e-5, 5.1493487696889935e-5,
                    4.3301960212312695e-5, 7.704743329882629e-5, 9.100070456576085e-5,
                    2.737367739801524e-5, 2.26503381336982e-5, 8.72239729062208e-5,
                    4.635199695293095e-5, 4.3761944640197645e-5, 4.029679967858363e-5,
                    4.7927001029291456e-5, 7.787378258010738e-5, 7.893753056187652e-5,
                    7.906438047190778e-5, 8.023588272434827e-5, 8.199279194728158e-5,
                    9.269721156634642e-5, 0.00015905578260264335, 3.793419807982137e-5,
                    0.00026904101047426043, 0.00010850136999528784, 4.213496730569746e-5,
                    0.0001395879412796139, 0.00014742939747481326, 7.100966381324699e-5,
                    0.00010938871155408321, 0.00011832263246318371, 8.579337945351021e-5,
                    5.737974566981581e-5, 0.00016468534404347811, 6.185767775503054e-5,
                    6.480656613679467e-5, 6.319719129348889e-5, 6.297053129174449e-5,
                    7.06439058694159e-5, 6.542289571270377e-5, 8.543299768306567e-5,
                    0.00015184654425381836, 5.1493487696889935e-5, 0.00010850136999528784,
                    0.0002407596352482006, 4.359996106267255e-5, 0.00014689092480870604,
                    0.0001470530024824945, 5.653615223108856e-5, 7.832298309782995e-5,
                    0.00012023689690010371, 6.632011694976454e-5, 4.894429840443883e-5,
                    9.079657234426911e-5, 6.15332726583559e-5, 3.779626520172468e-5,
                    3.781086619049571e-5, 3.340250219249262e-5, 3.519199187628954e-5,
                    3.870192139725493e-5, 4.6711821085838515e-5, 6.58469865279133e-5,
                    4.3301960212312695e-5, 4.213496730569746e-5, 4.359996106267255e-5,
                    0.00011254732252706103, 6.145967724751135e-5, 5.4442507288490645e-5,
                    3.81124989340973e-5, 4.856703351497938e-5, 5.1933640906403245e-5,
                    3.84668043278077e-5, 3.4227307856284115e-5, 4.918062991020336e-5,
                    3.125661628614864e-5, 0.00010026282250679006, 9.963528597699351e-5,
                    0.00011157365154249237, 0.0001314963694539066, 0.00010864507459743642,
                    0.0001227331491632604, 0.00014263191678377294, 7.704743329882629e-5,
                    0.0001395879412796139, 0.00014689092480870604, 6.145967724751135e-5,
                    0.0007824998303617653, 0.0002865997592472387, 7.726728850717195e-5,
                    0.00016156559066281563, 0.00018636470659568805, 9.91398847449091e-5,
                    7.965578411605312e-5, 0.0001183287950828076, 0.00011134297305706447,
                    3.101486537375358e-5, 3.8493200128706405e-5, 4.6620145918299854e-5,
                    0.00011039214610997702, 2.2914405526984115e-5, 0.00012126469265091802,
                    0.00018580425211628786, 9.100070456576085e-5, 0.00014742939747481326,
                    0.0001470530024824945, 5.4442507288490645e-5, 0.0002865997592472387,
                    0.002041486594000835, 6.889706566091834e-5, 0.0001930968066287628,
                    0.00021094383801768015, 6.492112041492644e-5, 5.226745948668453e-5,
                    0.00010114073810825317, 8.044320844884564e-5, 3.869218861043138e-5,
                    4.556235539030288e-5, 2.736097049819164e-5, 4.632423411693351e-5,
                    3.924947978959023e-5, 5.8826489644367995e-5, 8.552701859249089e-5,
                    2.737367739801524e-5, 7.100966381324699e-5, 5.653615223108856e-5,
                    3.81124989340973e-5, 7.726728850717195e-5, 6.889706566091834e-5,
                    0.00013364641145961864, 0.00013161016124904466, 6.055491505710008e-5,
                    5.103992168030762e-5, 3.58066825686992e-5, 6.665944235757802e-5,
                    2.565839166964623e-5, 3.3955837242103855e-5, 5.638090405129697e-5,
                    2.529052716851659e-5, 6.938469914830167e-5, 5.8519541957125885e-5,
                    7.803313742258276e-5, 0.00020427829609685505, 2.26503381336982e-5,
                    0.00010938871155408321, 7.832298309782995e-5, 4.856703351497938e-5,
                    0.00016156559066281563, 0.0001930968066287628, 0.00013161016124904466,
                    0.0009593985028265281, 0.00011194527800393796, 4.840936277093752e-5,
                    2.4809824827278204e-5, 8.294164172960152e-5, 3.111642177253345e-5,
                    6.669112843408608e-5, 8.526804986174368e-5, 5.3093831514844e-5,
                    8.103516834264953e-5, 7.226669310269816e-5, 6.667067421014294e-5,
                    0.0001606028291339101, 8.72239729062208e-5, 0.00011832263246318371,
                    0.00012023689690010371, 5.1933640906403245e-5, 0.00018636470659568805,
                    0.00021094383801768015, 6.055491505710008e-5, 0.00011194527800393796,
                    0.0005073871321777781, 7.755533296517255e-5, 4.865051215186404e-5,
                    9.182593758932298e-5, 7.231037893512565e-5, 9.002888263189854e-5,
                    7.774901755482544e-5, 9.419395441370796e-5, 9.837079646162375e-5,
                    0.00010350173116052551, 5.73299209894681e-5, 0.000155303260146172,
                    4.635199695293095e-5, 8.579337945351021e-5, 6.632011694976454e-5,
                    3.84668043278077e-5, 9.91398847449091e-5, 6.492112041492644e-5,
                    5.103992168030762e-5, 4.840936277093752e-5, 7.755533296517255e-5,
                    0.00015395471447026042, 5.480570082885725e-5, 7.997247727680748e-5,
                    6.719586272459899e-5, 5.313903231632269e-5, 4.598543078843762e-5,
                    4.65503654117238e-5, 4.7986716172197275e-5, 4.620021707584661e-5,
                    4.975544672288667e-5, 8.245606329573359e-5, 4.3761944640197645e-5,
                    5.737974566981581e-5, 4.894429840443883e-5, 3.4227307856284115e-5,
                    7.965578411605312e-5, 5.226745948668453e-5, 3.58066825686992e-5,
                    2.4809824827278204e-5, 4.865051215186404e-5, 5.480570082885725e-5,
                    0.00011932849102967798, 5.541298848578068e-5, 4.3362672075426435e-5,
                    7.131669613197604e-5, 7.07875385173279e-5, 6.925462842061672e-5,
                    7.737108116915099e-5, 7.642975172016838e-5, 7.806615260867241e-5,
                    0.00013552029769693132, 4.029679967858363e-5, 0.00016468534404347811,
                    9.079657234426911e-5, 4.918062991020336e-5, 0.0001183287950828076,
                    0.00010114073810825317, 6.665944235757802e-5, 8.294164172960152e-5,
                    9.182593758932298e-5, 7.997247727680748e-5, 5.541298848578068e-5,
                    0.00017798467979133594, 5.6519834763661094e-5, 7.347192941912554e-5,
                    5.952242476685643e-5, 7.2682530031499e-5, 6.663786778519997e-5,
                    8.573857168723539e-5, 5.736875862939942e-5, 8.938564279384991e-5,
                    4.7927001029291456e-5, 6.185767775503054e-5, 6.15332726583559e-5,
                    3.125661628614864e-5, 0.00011134297305706447, 8.044320844884564e-5,
                    2.565839166964623e-5, 3.111642177253345e-5, 7.231037893512565e-5,
                    6.719586272459899e-5, 4.3362672075426435e-5, 5.6519834763661094e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorSB0(; normalise = normalise, mean_w = w, ve = ve, std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.0001414744096189848, 0.0001984979738288057,
                    0.00019599460950942677, 0.00022758203187090052, 0.00010465648354881212,
                    0.00030027273078807223, 9.104525327657161e-5, 0.00013672066457573267,
                    0.00012069646135109975, 8.213256854752073e-5, 0.0001949698195556935,
                    5.172543443257344e-5, 7.232194495722532e-5, 4.611397004161342e-5,
                    0.00013847922128104825, 0.00014453171522331557, 9.67684168735297e-5,
                    0.00012459337291597075, 0.0001318955945718919, 0.0001414744096189848,
                    0.00020060062616370064, 0.00016172762921933147, 0.00016054035644389095,
                    0.00017980021631797314, 0.00010709502159353492, 0.000309609102219062,
                    9.041006262200267e-5, 0.00014391574618103885, 0.00011813470547366425,
                    7.398862368996516e-5, 0.00020640101735404576, 9.171510101089695e-5,
                    8.310168916098567e-5, 9.174535022537639e-5, 0.00016145203227289754,
                    0.0001324971677120309, 7.845582521088563e-5, 0.00012623350427883387,
                    0.00010867750305477979, 0.0001984979738288057, 0.00016172762921933147,
                    0.00025023180181571545, 0.00020545635306872507, 0.00023656402197338915,
                    0.00010121022979666667, 0.0003030031467881994, 6.18472734210266e-5,
                    0.00014548707935943864, 0.00011813605406180024, 6.795338155617318e-5,
                    0.00022833971362028847, 8.005234125091278e-5, 5.117143486779321e-5,
                    4.347973593871425e-5, 0.00010495352784186079, 0.00015556022999371982,
                    8.833746340230418e-5, 0.00012386868666523312, 0.00013645945319881706,
                    0.00019599460950942677, 0.00016054035644389095, 0.00020545635306872507,
                    0.00039197799320071677, 0.00024071004337442337, 0.00012426751776349206,
                    0.0003776178841036795, 9.042277178807317e-5, 0.0001526433026909086,
                    0.0001371397000679919, 6.1005058657752696e-5, 0.0002823997889695534,
                    0.00020401935458407575, 8.291235809642676e-5, 0.00012994944750261198,
                    0.0001693134450772865, 0.00016682386971231673, 8.538539962299356e-5,
                    0.00013952515463968936, 0.00012116863635462447, 0.00022758203187090052,
                    0.00017980021631797314, 0.00023656402197338915, 0.00024071004337442337,
                    0.00030911461216782526, 0.000126908941372277, 0.0003263484626569288,
                    0.00010573938183576223, 0.00015342633016771686, 0.00012409508386395567,
                    7.782711557113011e-5, 0.00023306129671241103, 2.8867621500173066e-5,
                    7.795635758999098e-5, 9.68563824458639e-5, 0.00015771699888543502,
                    0.00017039519592813816, 0.0001047098392785362, 0.0001416283159163236,
                    0.00016192956638857236, 0.00010465648354881212, 0.00010709502159353492,
                    0.00010121022979666667, 0.00012426751776349206, 0.000126908941372277,
                    0.0001915128908033608, 0.00021269119399579316, 9.378052836514122e-5,
                    0.0001650236622875906, 0.00015389208787929917, 8.449249523679696e-5,
                    0.00022494437773366933, 0.00023998473129804163, 0.00010636357711423471,
                    0.00013934901905587278, 0.00013525407511233897, 0.00010280092703319205,
                    8.801992726904406e-5, 0.0001408092744899032, 0.00010554247249288472,
                    0.00030027273078807223, 0.000309609102219062, 0.0003030031467881994,
                    0.0003776178841036795, 0.0003263484626569288, 0.00021269119399579316,
                    0.0016063027844326404, 0.00018081141145475044, 0.0002713845320039407,
                    0.0003146464052961923, 0.00012900707714313297, 0.0003049621630563284,
                    0.00037897060484292917, 0.0001822926063119136, 0.00039102732930576355,
                    0.0003193519601865918, 0.00029207520583864955, 0.00017219113457171722,
                    0.0002608875215732181, 0.00018084429428773645, 9.104525327657161e-5,
                    9.041006262200267e-5, 6.18472734210266e-5, 9.042277178807317e-5,
                    0.00010573938183576223, 9.378052836514122e-5, 0.00018081141145475044,
                    0.00017038019135706003, 7.942903331657553e-5, 0.00010297457183939732,
                    8.16680924030094e-5, 0.00014893511836341618, 0.00016853903070186357,
                    5.440106124689758e-5, 4.358030093603823e-5, 0.00018276286595455928,
                    8.774613463181367e-5, 8.468016096772065e-5, 8.369649935072979e-5,
                    9.143489750758392e-5, 0.00013672066457573267, 0.00014391574618103885,
                    0.00014548707935943864, 0.0001526433026909086, 0.00015342633016771686,
                    0.0001650236622875906, 0.0002713845320039407, 7.942903331657553e-5,
                    0.00026904101047426043, 0.00018144129297834925, 7.998544653429915e-5,
                    0.0002794415533370636, 0.00026070796462092176, 0.00012355113303020524,
                    0.00019352846173644055, 0.0002144164596431992, 0.00013859454803483582,
                    0.0001001886531231252, 0.000207829815878711, 0.00011043926452743085,
                    0.00012069646135109975, 0.00011813470547366425, 0.00011813605406180024,
                    0.0001371397000679919, 0.00012409508386395567, 0.00015389208787929917,
                    0.0003146464052961923, 0.00010297457183939732, 0.00018144129297834925,
                    0.00024075963524820054, 7.765212531052256e-5, 0.00026836257147824435,
                    0.0002674997505593638, 0.00010873419260635257, 0.0001239370130953397,
                    0.00021316567545433875, 0.00011888344109376338, 8.491428426347331e-5,
                    0.00015640011339200025, 0.000106332720976699, 8.213256854752073e-5,
                    7.398862368996516e-5, 6.795338155617318e-5, 6.1005058657752696e-5,
                    7.782711557113011e-5, 8.449249523679696e-5, 0.00012900707714313297,
                    8.16680924030094e-5, 7.998544653429915e-5, 7.765212531052256e-5,
                    0.00011254732252706103, 0.00011687111093508446, 9.328171202208404e-5,
                    6.474075069238788e-5, 7.282969779610852e-5, 9.989409037023235e-5,
                    6.847661280617474e-5, 6.709727530936593e-5, 8.952215117195305e-5,
                    5.567155503714664e-5, 0.0001949698195556935, 0.00020640101735404576,
                    0.00022833971362028847, 0.0002823997889695534, 0.00023306129671241103,
                    0.00022494437773366933, 0.0003049621630563284, 0.00014893511836341618,
                    0.0002794415533370636, 0.00026836257147824435, 0.00011687111093508446,
                    0.0007824998303617654, 0.0005784887248002191, 0.00016081021107326276,
                    0.00027990186902726187, 0.00039538071856135866, 0.0001876404525839927,
                    0.0001741721984419517, 0.00023745373152150536, 0.00022034370462144137,
                    5.172543443257344e-5, 9.171510101089695e-5, 8.005234125091278e-5,
                    0.00020401935458407575, 2.8867621500173066e-5, 0.00023998473129804163,
                    0.00037897060484292917, 0.00016853903070186357, 0.00026070796462092176,
                    0.0002674997505593638, 9.328171202208404e-5, 0.0005784887248002191,
                    0.0020414865940008354, 0.00012446087146605477, 0.00030384817230002316,
                    0.000433240929484266, 0.00010951434335332286, 9.572370994568983e-5,
                    0.00016651432447889982, 0.0001298037744869058, 7.232194495722532e-5,
                    8.310168916098567e-5, 5.117143486779321e-5, 8.291235809642676e-5,
                    7.795635758999098e-5, 0.00010636357711423471, 0.0001822926063119136,
                    5.440106124689758e-5, 0.00012355113303020524, 0.00010873419260635257,
                    6.474075069238788e-5, 0.00016081021107326276, 0.00012446087146605477,
                    0.00013364641145961862, 0.00022491292829682902, 0.00011610141746933295,
                    8.22337683140917e-5, 6.827562539856229e-5, 0.00011374464098991634,
                    4.795145931577015e-5, 4.611397004161342e-5, 9.174535022537639e-5,
                    4.347973593871425e-5, 0.00012994944750261198, 9.68563824458639e-5,
                    0.00013934901905587278, 0.00039102732930576355, 4.358030093603823e-5,
                    0.00019352846173644055, 0.0001239370130953397, 7.282969779610852e-5,
                    0.00027990186902726187, 0.00030384817230002316, 0.00022491292829682902,
                    0.0009593985028265281, 0.00017845448784751698, 7.935914784887467e-5,
                    4.267697135586022e-5, 0.00016001473647980508, 5.429495609909468e-5,
                    0.00013847922128104825, 0.00016145203227289754, 0.00010495352784186079,
                    0.0001693134450772865, 0.00015771699888543502, 0.00013525407511233897,
                    0.0003193519601865918, 0.00018276286595455928, 0.0002144164596431992,
                    0.00021316567545433875, 9.989409037023235e-5, 0.00039538071856135866,
                    0.000433240929484266, 0.00011610141746933295, 0.00017845448784751698,
                    0.0005073871321777783, 0.0001442751742852742, 9.697122769127179e-5,
                    0.00017500854458433413, 0.00013764323116522253, 0.00014453171522331557,
                    0.0001324971677120309, 0.00015556022999371982, 0.00016682386971231673,
                    0.00017039519592813816, 0.00010280092703319205, 0.00029207520583864955,
                    8.774613463181367e-5, 0.00013859454803483582, 0.00011888344109376338,
                    6.847661280617474e-5, 0.0001876404525839927, 0.00010951434335332286,
                    8.22337683140917e-5, 7.935914784887467e-5, 0.0001442751742852742,
                    0.00015395471447026042, 9.87908477094328e-5, 0.00012996758374001093,
                    0.00011681818960906702, 9.67684168735297e-5, 7.845582521088563e-5,
                    8.833746340230418e-5, 8.538539962299356e-5, 0.0001047098392785362,
                    8.801992726904406e-5, 0.00017219113457171722, 8.468016096772065e-5,
                    0.0001001886531231252, 8.491428426347331e-5, 6.709727530936593e-5,
                    0.0001741721984419517, 9.572370994568983e-5, 6.827562539856229e-5,
                    4.267697135586022e-5, 9.697122769127179e-5, 9.87908477094328e-5,
                    0.000119328491029678, 9.611010314353154e-5, 7.62098472733619e-5,
                    0.00012459337291597075, 0.00012623350427883387, 0.00012386868666523312,
                    0.00013952515463968936, 0.0001416283159163236, 0.0001408092744899032,
                    0.0002608875215732181, 8.369649935072979e-5, 0.000207829815878711,
                    0.00015640011339200025, 8.952215117195305e-5, 0.00023745373152150536,
                    0.00016651432447889982, 0.00011374464098991634, 0.00016001473647980508,
                    0.00017500854458433413, 0.00012996758374001093, 9.611010314353154e-5,
                    0.00017798467979133597, 9.824418944425037e-5, 0.0001318955945718919,
                    0.00010867750305477979, 0.00013645945319881706, 0.00012116863635462447,
                    0.00016192956638857236, 0.00010554247249288472, 0.00018084429428773645,
                    9.143489750758392e-5, 0.00011043926452743085, 0.000106332720976699,
                    5.567155503714664e-5, 0.00022034370462144137, 0.0001298037744869058,
                    4.795145931577015e-5, 5.429495609909468e-5, 0.00013764323116522253,
                    0.00011681818960906702, 7.62098472733619e-5, 9.824418944425037e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorSB1(; normalise = normalise, mean_w = w, ve = ve, std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.0001414744096189848, 0.0001984979738288057,
                    0.00019599460950942677, 0.00022758203187090052, 0.00010465648354881212,
                    0.00030027273078807223, 9.104525327657161e-5, 0.00013672066457573267,
                    0.00012069646135109975, 8.213256854752073e-5, 0.0001949698195556935,
                    5.172543443257344e-5, 7.232194495722532e-5, 4.611397004161342e-5,
                    0.00013847922128104825, 0.00014453171522331557, 9.67684168735297e-5,
                    0.00012459337291597075, 0.0001318955945718919, 0.0001414744096189848,
                    0.00020060062616370064, 0.00016172762921933147, 0.00016054035644389095,
                    0.00017980021631797314, 0.00010709502159353492, 0.000309609102219062,
                    9.041006262200267e-5, 0.00014391574618103885, 0.00011813470547366425,
                    7.398862368996516e-5, 0.00020640101735404576, 9.171510101089695e-5,
                    8.310168916098567e-5, 9.174535022537639e-5, 0.00016145203227289754,
                    0.0001324971677120309, 7.845582521088563e-5, 0.00012623350427883387,
                    0.00010867750305477979, 0.0001984979738288057, 0.00016172762921933147,
                    0.00025023180181571545, 0.00020545635306872507, 0.00023656402197338915,
                    0.00010121022979666667, 0.0003030031467881994, 6.18472734210266e-5,
                    0.00014548707935943864, 0.00011813605406180024, 6.795338155617318e-5,
                    0.00022833971362028847, 8.005234125091278e-5, 5.117143486779321e-5,
                    4.347973593871425e-5, 0.00010495352784186079, 0.00015556022999371982,
                    8.833746340230418e-5, 0.00012386868666523312, 0.00013645945319881706,
                    0.00019599460950942677, 0.00016054035644389095, 0.00020545635306872507,
                    0.00039197799320071677, 0.00024071004337442337, 0.00012426751776349206,
                    0.0003776178841036795, 9.042277178807317e-5, 0.0001526433026909086,
                    0.0001371397000679919, 6.1005058657752696e-5, 0.0002823997889695534,
                    0.00020401935458407575, 8.291235809642676e-5, 0.00012994944750261198,
                    0.0001693134450772865, 0.00016682386971231673, 8.538539962299356e-5,
                    0.00013952515463968936, 0.00012116863635462447, 0.00022758203187090052,
                    0.00017980021631797314, 0.00023656402197338915, 0.00024071004337442337,
                    0.00030911461216782526, 0.000126908941372277, 0.0003263484626569288,
                    0.00010573938183576223, 0.00015342633016771686, 0.00012409508386395567,
                    7.782711557113011e-5, 0.00023306129671241103, 2.8867621500173066e-5,
                    7.795635758999098e-5, 9.68563824458639e-5, 0.00015771699888543502,
                    0.00017039519592813816, 0.0001047098392785362, 0.0001416283159163236,
                    0.00016192956638857236, 0.00010465648354881212, 0.00010709502159353492,
                    0.00010121022979666667, 0.00012426751776349206, 0.000126908941372277,
                    0.0001915128908033608, 0.00021269119399579316, 9.378052836514122e-5,
                    0.0001650236622875906, 0.00015389208787929917, 8.449249523679696e-5,
                    0.00022494437773366933, 0.00023998473129804163, 0.00010636357711423471,
                    0.00013934901905587278, 0.00013525407511233897, 0.00010280092703319205,
                    8.801992726904406e-5, 0.0001408092744899032, 0.00010554247249288472,
                    0.00030027273078807223, 0.000309609102219062, 0.0003030031467881994,
                    0.0003776178841036795, 0.0003263484626569288, 0.00021269119399579316,
                    0.0016063027844326404, 0.00018081141145475044, 0.0002713845320039407,
                    0.0003146464052961923, 0.00012900707714313297, 0.0003049621630563284,
                    0.00037897060484292917, 0.0001822926063119136, 0.00039102732930576355,
                    0.0003193519601865918, 0.00029207520583864955, 0.00017219113457171722,
                    0.0002608875215732181, 0.00018084429428773645, 9.104525327657161e-5,
                    9.041006262200267e-5, 6.18472734210266e-5, 9.042277178807317e-5,
                    0.00010573938183576223, 9.378052836514122e-5, 0.00018081141145475044,
                    0.00017038019135706003, 7.942903331657553e-5, 0.00010297457183939732,
                    8.16680924030094e-5, 0.00014893511836341618, 0.00016853903070186357,
                    5.440106124689758e-5, 4.358030093603823e-5, 0.00018276286595455928,
                    8.774613463181367e-5, 8.468016096772065e-5, 8.369649935072979e-5,
                    9.143489750758392e-5, 0.00013672066457573267, 0.00014391574618103885,
                    0.00014548707935943864, 0.0001526433026909086, 0.00015342633016771686,
                    0.0001650236622875906, 0.0002713845320039407, 7.942903331657553e-5,
                    0.00026904101047426043, 0.00018144129297834925, 7.998544653429915e-5,
                    0.0002794415533370636, 0.00026070796462092176, 0.00012355113303020524,
                    0.00019352846173644055, 0.0002144164596431992, 0.00013859454803483582,
                    0.0001001886531231252, 0.000207829815878711, 0.00011043926452743085,
                    0.00012069646135109975, 0.00011813470547366425, 0.00011813605406180024,
                    0.0001371397000679919, 0.00012409508386395567, 0.00015389208787929917,
                    0.0003146464052961923, 0.00010297457183939732, 0.00018144129297834925,
                    0.00024075963524820054, 7.765212531052256e-5, 0.00026836257147824435,
                    0.0002674997505593638, 0.00010873419260635257, 0.0001239370130953397,
                    0.00021316567545433875, 0.00011888344109376338, 8.491428426347331e-5,
                    0.00015640011339200025, 0.000106332720976699, 8.213256854752073e-5,
                    7.398862368996516e-5, 6.795338155617318e-5, 6.1005058657752696e-5,
                    7.782711557113011e-5, 8.449249523679696e-5, 0.00012900707714313297,
                    8.16680924030094e-5, 7.998544653429915e-5, 7.765212531052256e-5,
                    0.00011254732252706103, 0.00011687111093508446, 9.328171202208404e-5,
                    6.474075069238788e-5, 7.282969779610852e-5, 9.989409037023235e-5,
                    6.847661280617474e-5, 6.709727530936593e-5, 8.952215117195305e-5,
                    5.567155503714664e-5, 0.0001949698195556935, 0.00020640101735404576,
                    0.00022833971362028847, 0.0002823997889695534, 0.00023306129671241103,
                    0.00022494437773366933, 0.0003049621630563284, 0.00014893511836341618,
                    0.0002794415533370636, 0.00026836257147824435, 0.00011687111093508446,
                    0.0007824998303617654, 0.0005784887248002191, 0.00016081021107326276,
                    0.00027990186902726187, 0.00039538071856135866, 0.0001876404525839927,
                    0.0001741721984419517, 0.00023745373152150536, 0.00022034370462144137,
                    5.172543443257344e-5, 9.171510101089695e-5, 8.005234125091278e-5,
                    0.00020401935458407575, 2.8867621500173066e-5, 0.00023998473129804163,
                    0.00037897060484292917, 0.00016853903070186357, 0.00026070796462092176,
                    0.0002674997505593638, 9.328171202208404e-5, 0.0005784887248002191,
                    0.0020414865940008354, 0.00012446087146605477, 0.00030384817230002316,
                    0.000433240929484266, 0.00010951434335332286, 9.572370994568983e-5,
                    0.00016651432447889982, 0.0001298037744869058, 7.232194495722532e-5,
                    8.310168916098567e-5, 5.117143486779321e-5, 8.291235809642676e-5,
                    7.795635758999098e-5, 0.00010636357711423471, 0.0001822926063119136,
                    5.440106124689758e-5, 0.00012355113303020524, 0.00010873419260635257,
                    6.474075069238788e-5, 0.00016081021107326276, 0.00012446087146605477,
                    0.00013364641145961862, 0.00022491292829682902, 0.00011610141746933295,
                    8.22337683140917e-5, 6.827562539856229e-5, 0.00011374464098991634,
                    4.795145931577015e-5, 4.611397004161342e-5, 9.174535022537639e-5,
                    4.347973593871425e-5, 0.00012994944750261198, 9.68563824458639e-5,
                    0.00013934901905587278, 0.00039102732930576355, 4.358030093603823e-5,
                    0.00019352846173644055, 0.0001239370130953397, 7.282969779610852e-5,
                    0.00027990186902726187, 0.00030384817230002316, 0.00022491292829682902,
                    0.0009593985028265281, 0.00017845448784751698, 7.935914784887467e-5,
                    4.267697135586022e-5, 0.00016001473647980508, 5.429495609909468e-5,
                    0.00013847922128104825, 0.00016145203227289754, 0.00010495352784186079,
                    0.0001693134450772865, 0.00015771699888543502, 0.00013525407511233897,
                    0.0003193519601865918, 0.00018276286595455928, 0.0002144164596431992,
                    0.00021316567545433875, 9.989409037023235e-5, 0.00039538071856135866,
                    0.000433240929484266, 0.00011610141746933295, 0.00017845448784751698,
                    0.0005073871321777783, 0.0001442751742852742, 9.697122769127179e-5,
                    0.00017500854458433413, 0.00013764323116522253, 0.00014453171522331557,
                    0.0001324971677120309, 0.00015556022999371982, 0.00016682386971231673,
                    0.00017039519592813816, 0.00010280092703319205, 0.00029207520583864955,
                    8.774613463181367e-5, 0.00013859454803483582, 0.00011888344109376338,
                    6.847661280617474e-5, 0.0001876404525839927, 0.00010951434335332286,
                    8.22337683140917e-5, 7.935914784887467e-5, 0.0001442751742852742,
                    0.00015395471447026042, 9.87908477094328e-5, 0.00012996758374001093,
                    0.00011681818960906702, 9.67684168735297e-5, 7.845582521088563e-5,
                    8.833746340230418e-5, 8.538539962299356e-5, 0.0001047098392785362,
                    8.801992726904406e-5, 0.00017219113457171722, 8.468016096772065e-5,
                    0.0001001886531231252, 8.491428426347331e-5, 6.709727530936593e-5,
                    0.0001741721984419517, 9.572370994568983e-5, 6.827562539856229e-5,
                    4.267697135586022e-5, 9.697122769127179e-5, 9.87908477094328e-5,
                    0.000119328491029678, 9.611010314353154e-5, 7.62098472733619e-5,
                    0.00012459337291597075, 0.00012623350427883387, 0.00012386868666523312,
                    0.00013952515463968936, 0.0001416283159163236, 0.0001408092744899032,
                    0.0002608875215732181, 8.369649935072979e-5, 0.000207829815878711,
                    0.00015640011339200025, 8.952215117195305e-5, 0.00023745373152150536,
                    0.00016651432447889982, 0.00011374464098991634, 0.00016001473647980508,
                    0.00017500854458433413, 0.00012996758374001093, 9.611010314353154e-5,
                    0.00017798467979133597, 9.824418944425037e-5, 0.0001318955945718919,
                    0.00010867750305477979, 0.00013645945319881706, 0.00012116863635462447,
                    0.00016192956638857236, 0.00010554247249288472, 0.00018084429428773645,
                    9.143489750758392e-5, 0.00011043926452743085, 0.000106332720976699,
                    5.567155503714664e-5, 0.00022034370462144137, 0.0001298037744869058,
                    4.795145931577015e-5, 5.429495609909468e-5, 0.00013764323116522253,
                    0.00011681818960906702, 7.62098472733619e-5, 9.824418944425037e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(;
                    ce = CorGerberSB0(; normalise = normalise, mean_w = w, ve = ve,
                                      std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.00019212136127538438, 0.00021304336242281387,
                    0.00024561713309616067, 0.00024232003372524034, 0.0001592512173979263,
                    0.0004382248899800087, 0.00014200187829679605, 0.000191907850782096,
                    0.00017758073279127156, 0.00011562987136226018, 0.0003045147454499287,
                    0.00015607864052565523, 0.00011415439372363761, 0.00012540063388757067,
                    0.00021944470289273694, 0.00017133301754569246, 0.00013690749806062234,
                    0.00016853674995769293, 0.0001600816330544569, 0.00019212136127538438,
                    0.00020060062616370064, 0.0002022150307834523, 0.00023655579324802516,
                    0.00023720001433985205, 0.00015808545045498405, 0.0004643213440313091,
                    0.00014032900591088625, 0.00020253100914397926, 0.00018511173392698506,
                    0.00011617525061402154, 0.00031077413717604075, 0.0001780352689424343,
                    0.0001257045437969243, 0.0001889726255479382, 0.0002494456789265347,
                    0.00016997044359485852, 0.00012798483533271016, 0.00017414509092092924,
                    0.00015505428177806647, 0.00021304336242281387, 0.0002022150307834523,
                    0.00025023180181571545, 0.00028027310942120484, 0.00026358518879652696,
                    0.00016492137142367407, 0.00046274330184119207, 0.00012546598401603267,
                    0.00020895087687485377, 0.00018507491519287515, 0.00010363330993118316,
                    0.00033226462221426717, 0.00016818376500402324, 0.00010628333745724262,
                    0.00010403935638875275, 0.00020632334666339077, 0.00018085737837510594,
                    0.0001373332860384458, 0.00017415185897646227, 0.00017477172721320372,
                    0.00024561713309616067, 0.00023655579324802516, 0.00028027310942120484,
                    0.00039197799320071677, 0.000312153271690415, 0.00020245227724304085,
                    0.0006222203578801216, 0.00015850143857388787, 0.0002533811755053621,
                    0.00022353797196589717, 0.00011704695939205516, 0.00043608714439529974,
                    0.000352965287033997, 0.00014262545524755323, 0.00023883712023379944,
                    0.00028909776779647916, 0.00021886951230563396, 0.00015144857490947773,
                    0.00021567899605111224, 0.00020211869640224817, 0.00024232003372524034,
                    0.00023720001433985205, 0.00026358518879652696, 0.000312153271690415,
                    0.00030911461216782526, 0.00018703750230040725, 0.0005286236748921592,
                    0.00016001296130954695, 0.0002291249886361139, 0.0002024144876066973,
                    0.00012856583264258322, 0.0003682077415026298, 0.00013084075992208662,
                    0.0001357498256781186, 0.00017601337395269155, 0.0002557615166158476,
                    0.00020675591334670302, 0.0001553114953059647, 0.00020141569432953124,
                    0.00019613153932772392, 0.0001592512173979263, 0.00015808545045498405,
                    0.00016492137142367407, 0.00020245227724304085, 0.00018703750230040725,
                    0.0001915128908033608, 0.00037427921816084273, 0.00014010584708257093,
                    0.0002111191338557657, 0.00019819358999228218, 0.0001251120961806339,
                    0.0003476993948322665, 0.0003885698994730006, 0.00014074512686271625,
                    0.0002487836743377734, 0.00023771293146690535, 0.00015140022117193292,
                    0.00013174358613513042, 0.00017580694911879542, 0.00014657204855285684,
                    0.0004382248899800087, 0.0004643213440313091, 0.00046274330184119207,
                    0.0006222203578801216, 0.0005286236748921592, 0.00037427921816084273,
                    0.0016063027844326404, 0.00031641762733165276, 0.0004892866850610133,
                    0.0004820059946414066, 0.000244764177289273, 0.0006454486917867896,
                    0.000653429486009047, 0.00032190090737313585, 0.0006392061991105575,
                    0.0005731556370453457, 0.0004152760013169241, 0.00028669541607740306,
                    0.0004241616967938175, 0.00032031673707439334, 0.00014200187829679605,
                    0.00014032900591088625, 0.00012546598401603267, 0.00015850143857388787,
                    0.00016001296130954695, 0.00014010584708257093, 0.00031641762733165276,
                    0.00017038019135706003, 0.0001436336658487603, 0.00015924884616538707,
                    0.0001163935452202507, 0.00026245135605738456, 0.0003020377865995061,
                    9.522662447589694e-5, 9.024458695225402e-5, 0.0002462864214578497,
                    0.0001311738636449485, 0.00011941939725883194, 0.0001348142681596813,
                    0.00013297097729951442, 0.000191907850782096, 0.00020253100914397926,
                    0.00020895087687485377, 0.0002533811755053621, 0.0002291249886361139,
                    0.0002111191338557657, 0.0004892866850610133, 0.0001436336658487603,
                    0.00026904101047426043, 0.00024100905471995286, 0.00013029337008379046,
                    0.0004277182948259737, 0.00044231535738089466, 0.00017015385468405016,
                    0.0003295323827727373, 0.0003045246051763106, 0.0001841004515075021,
                    0.00014785309161394813, 0.00021285771122279198, 0.0001699110537819248,
                    0.00017758073279127156, 0.00018511173392698506, 0.00018507491519287515,
                    0.00022353797196589717, 0.0002024144876066973, 0.00019819358999228218,
                    0.0004820059946414066, 0.00015924884616538707, 0.00024100905471995286,
                    0.00024075963524820054, 0.0001264616209832034, 0.000380686159015911,
                    0.00046868314460461226, 0.00014953902988653538, 0.0002559162960194222,
                    0.00030458453852882917, 0.00017165064044682033, 0.00013998274360633355,
                    0.00019420892073746814, 0.0001622077146672294, 0.00011562987136226018,
                    0.00011617525061402154, 0.00010363330993118316, 0.00011704695939205516,
                    0.00012856583264258322, 0.0001251120961806339, 0.000244764177289273,
                    0.0001163935452202507, 0.00013029337008379046, 0.0001264616209832034,
                    0.00011254732252706103, 0.0002059652270483576, 0.00018309298151363175,
                    0.00010022646846522736, 0.00014305057255298314, 0.00016776456854865994,
                    0.00010559552300737976, 9.951041296514335e-5, 0.00012087775771181887,
                    9.462426450266332e-5, 0.0003045147454499287, 0.00031077413717604075,
                    0.00033226462221426717, 0.00043608714439529974, 0.0003682077415026298,
                    0.0003476993948322665, 0.0006454486917867896, 0.00026245135605738456,
                    0.0004277182948259737, 0.000380686159015911, 0.0002059652270483576,
                    0.0007824998303617654, 0.00088985109717689, 0.00025503095394504525,
                    0.0004722878188865533, 0.0005440677095148366, 0.00029363570013974787,
                    0.00024218754247459806, 0.0003372820797296755, 0.0003022614422099009,
                    0.00015607864052565523, 0.0001780352689424343, 0.00016818376500402324,
                    0.000352965287033997, 0.00013084075992208662, 0.0003885698994730006,
                    0.000653429486009047, 0.0003020377865995061, 0.00044231535738089466,
                    0.00046868314460461226, 0.00018309298151363175, 0.00088985109717689,
                    0.0020414865940008354, 0.00025351811852718914, 0.0006331738861837404,
                    0.0007034492438388822, 0.00022351372066903725, 0.00019571294468421013,
                    0.00031787335587505147, 0.00025537602116123284, 0.00011415439372363761,
                    0.0001257045437969243, 0.00010628333745724262, 0.00014262545524755323,
                    0.0001357498256781186, 0.00014074512686271625, 0.00032190090737313585,
                    9.522662447589694e-5, 0.00017015385468405016, 0.00014953902988653538,
                    0.00010022646846522736, 0.00025503095394504525, 0.00025351811852718914,
                    0.00013364641145961862, 0.00029512288488359715, 0.0001924600980326289,
                    0.00011425697558261237, 9.712501950343018e-5, 0.00014233657629550024,
                    9.127816929595393e-5, 0.00012540063388757067, 0.0001889726255479382,
                    0.00010403935638875275, 0.00023883712023379944, 0.00017601337395269155,
                    0.0002487836743377734, 0.0006392061991105575, 9.024458695225402e-5,
                    0.0003295323827727373, 0.0002559162960194222, 0.00014305057255298314,
                    0.0004722878188865533, 0.0006331738861837404, 0.00029512288488359715,
                    0.0009593985028265281, 0.0003585658307580831, 0.00016302164805463964,
                    0.00010174509234572077, 0.0002589953220632478, 9.86773116659138e-5,
                    0.00021944470289273694, 0.0002494456789265347, 0.00020632334666339077,
                    0.00028909776779647916, 0.0002557615166158476, 0.00023771293146690535,
                    0.0005731556370453457, 0.0002462864214578497, 0.0003045246051763106,
                    0.00030458453852882917, 0.00016776456854865994, 0.0005440677095148366,
                    0.0007034492438388822, 0.0001924600980326289, 0.0003585658307580831,
                    0.0005073871321777783, 0.00021929732339168913, 0.00017107161725823605,
                    0.0002495260923176359, 0.000217265857244111, 0.00017133301754569246,
                    0.00016997044359485852, 0.00018085737837510594, 0.00021886951230563396,
                    0.00020675591334670302, 0.00015140022117193292, 0.0004152760013169241,
                    0.0001311738636449485, 0.0001841004515075021, 0.00017165064044682033,
                    0.00010559552300737976, 0.00029363570013974787, 0.00022351372066903725,
                    0.00011425697558261237, 0.00016302164805463964, 0.00021929732339168913,
                    0.00015395471447026042, 0.0001236767813068668, 0.0001582603260975952,
                    0.00014130683887400472, 0.00013690749806062234, 0.00012798483533271016,
                    0.0001373332860384458, 0.00015144857490947773, 0.0001553114953059647,
                    0.00013174358613513042, 0.00028669541607740306, 0.00011941939725883194,
                    0.00014785309161394813, 0.00013998274360633355, 9.951041296514335e-5,
                    0.00024218754247459806, 0.00019571294468421013, 9.712501950343018e-5,
                    0.00010174509234572077, 0.00017107161725823605, 0.0001236767813068668,
                    0.000119328491029678, 0.0001292063738759132, 0.00011468547875219135,
                    0.00016853674995769293, 0.00017414509092092924, 0.00017415185897646227,
                    0.00021567899605111224, 0.00020141569432953124, 0.00017580694911879542,
                    0.0004241616967938175, 0.0001348142681596813, 0.00021285771122279198,
                    0.00019420892073746814, 0.00012087775771181887, 0.0003372820797296755,
                    0.00031787335587505147, 0.00014233657629550024, 0.0002589953220632478,
                    0.0002495260923176359, 0.0001582603260975952, 0.0001292063738759132,
                    0.00017798467979133597, 0.00014296694260697797, 0.0001600816330544569,
                    0.00015505428177806647, 0.00017477172721320372, 0.00020211869640224817,
                    0.00019613153932772392, 0.00014657204855285684, 0.00032031673707439334,
                    0.00013297097729951442, 0.0001699110537819248, 0.0001622077146672294,
                    9.462426450266332e-5, 0.0003022614422099009, 0.00025537602116123284,
                    9.127816929595393e-5, 9.86773116659138e-5, 0.000217265857244111,
                    0.00014130683887400472, 0.00011468547875219135, 0.00014296694260697797,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(;
                    ce = CorGerberSB1(; normalise = normalise, mean_w = w, ve = ve,
                                      std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.00019212136127538438, 0.00021304336242281387,
                    0.00024561713309616067, 0.00024232003372524034, 0.0001592512173979263,
                    0.0004382248899800087, 0.00014200187829679605, 0.000191907850782096,
                    0.00017758073279127156, 0.00011562987136226018, 0.0003045147454499287,
                    0.00015607864052565523, 0.00011415439372363761, 0.00012540063388757067,
                    0.00021944470289273694, 0.00017133301754569246, 0.00013690749806062234,
                    0.00016853674995769293, 0.0001600816330544569, 0.00019212136127538438,
                    0.00020060062616370064, 0.0002022150307834523, 0.00023655579324802516,
                    0.00023720001433985205, 0.00015808545045498405, 0.0004643213440313091,
                    0.00014032900591088625, 0.00020253100914397926, 0.00018511173392698506,
                    0.00011617525061402154, 0.00031077413717604075, 0.0001780352689424343,
                    0.0001257045437969243, 0.0001889726255479382, 0.0002494456789265347,
                    0.00016997044359485852, 0.00012798483533271016, 0.00017414509092092924,
                    0.00015505428177806647, 0.00021304336242281387, 0.0002022150307834523,
                    0.00025023180181571545, 0.00028027310942120484, 0.00026358518879652696,
                    0.00016492137142367407, 0.00046274330184119207, 0.00012546598401603267,
                    0.00020895087687485377, 0.00018507491519287515, 0.00010363330993118316,
                    0.00033226462221426717, 0.00016818376500402324, 0.00010628333745724262,
                    0.00010403935638875275, 0.00020632334666339077, 0.00018085737837510594,
                    0.0001373332860384458, 0.00017415185897646227, 0.00017477172721320372,
                    0.00024561713309616067, 0.00023655579324802516, 0.00028027310942120484,
                    0.00039197799320071677, 0.000312153271690415, 0.00020245227724304085,
                    0.0006222203578801216, 0.00015850143857388787, 0.0002533811755053621,
                    0.00022353797196589717, 0.00011704695939205516, 0.00043608714439529974,
                    0.000352965287033997, 0.00014262545524755323, 0.00023883712023379944,
                    0.00028909776779647916, 0.00021886951230563396, 0.00015144857490947773,
                    0.00021567899605111224, 0.00020211869640224817, 0.00024232003372524034,
                    0.00023720001433985205, 0.00026358518879652696, 0.000312153271690415,
                    0.00030911461216782526, 0.00018703750230040725, 0.0005286236748921592,
                    0.00016001296130954695, 0.0002291249886361139, 0.0002024144876066973,
                    0.00012856583264258322, 0.0003682077415026298, 0.00013084075992208662,
                    0.0001357498256781186, 0.00017601337395269155, 0.0002557615166158476,
                    0.00020675591334670302, 0.0001553114953059647, 0.00020141569432953124,
                    0.00019613153932772392, 0.0001592512173979263, 0.00015808545045498405,
                    0.00016492137142367407, 0.00020245227724304085, 0.00018703750230040725,
                    0.0001915128908033608, 0.00037427921816084273, 0.00014010584708257093,
                    0.0002111191338557657, 0.00019819358999228218, 0.0001251120961806339,
                    0.0003476993948322665, 0.0003885698994730006, 0.00014074512686271625,
                    0.0002487836743377734, 0.00023771293146690535, 0.00015140022117193292,
                    0.00013174358613513042, 0.00017580694911879542, 0.00014657204855285684,
                    0.0004382248899800087, 0.0004643213440313091, 0.00046274330184119207,
                    0.0006222203578801216, 0.0005286236748921592, 0.00037427921816084273,
                    0.0016063027844326404, 0.00031641762733165276, 0.0004892866850610133,
                    0.0004820059946414066, 0.000244764177289273, 0.0006454486917867896,
                    0.000653429486009047, 0.00032190090737313585, 0.0006392061991105575,
                    0.0005731556370453457, 0.0004152760013169241, 0.00028669541607740306,
                    0.0004241616967938175, 0.00032031673707439334, 0.00014200187829679605,
                    0.00014032900591088625, 0.00012546598401603267, 0.00015850143857388787,
                    0.00016001296130954695, 0.00014010584708257093, 0.00031641762733165276,
                    0.00017038019135706003, 0.0001436336658487603, 0.00015924884616538707,
                    0.0001163935452202507, 0.00026245135605738456, 0.0003020377865995061,
                    9.522662447589694e-5, 9.024458695225402e-5, 0.0002462864214578497,
                    0.0001311738636449485, 0.00011941939725883194, 0.0001348142681596813,
                    0.00013297097729951442, 0.000191907850782096, 0.00020253100914397926,
                    0.00020895087687485377, 0.0002533811755053621, 0.0002291249886361139,
                    0.0002111191338557657, 0.0004892866850610133, 0.0001436336658487603,
                    0.00026904101047426043, 0.00024100905471995286, 0.00013029337008379046,
                    0.0004277182948259737, 0.00044231535738089466, 0.00017015385468405016,
                    0.0003295323827727373, 0.0003045246051763106, 0.0001841004515075021,
                    0.00014785309161394813, 0.00021285771122279198, 0.0001699110537819248,
                    0.00017758073279127156, 0.00018511173392698506, 0.00018507491519287515,
                    0.00022353797196589717, 0.0002024144876066973, 0.00019819358999228218,
                    0.0004820059946414066, 0.00015924884616538707, 0.00024100905471995286,
                    0.00024075963524820054, 0.0001264616209832034, 0.000380686159015911,
                    0.00046868314460461226, 0.00014953902988653538, 0.0002559162960194222,
                    0.00030458453852882917, 0.00017165064044682033, 0.00013998274360633355,
                    0.00019420892073746814, 0.0001622077146672294, 0.00011562987136226018,
                    0.00011617525061402154, 0.00010363330993118316, 0.00011704695939205516,
                    0.00012856583264258322, 0.0001251120961806339, 0.000244764177289273,
                    0.0001163935452202507, 0.00013029337008379046, 0.0001264616209832034,
                    0.00011254732252706103, 0.0002059652270483576, 0.00018309298151363175,
                    0.00010022646846522736, 0.00014305057255298314, 0.00016776456854865994,
                    0.00010559552300737976, 9.951041296514335e-5, 0.00012087775771181887,
                    9.462426450266332e-5, 0.0003045147454499287, 0.00031077413717604075,
                    0.00033226462221426717, 0.00043608714439529974, 0.0003682077415026298,
                    0.0003476993948322665, 0.0006454486917867896, 0.00026245135605738456,
                    0.0004277182948259737, 0.000380686159015911, 0.0002059652270483576,
                    0.0007824998303617654, 0.00088985109717689, 0.00025503095394504525,
                    0.0004722878188865533, 0.0005440677095148366, 0.00029363570013974787,
                    0.00024218754247459806, 0.0003372820797296755, 0.0003022614422099009,
                    0.00015607864052565523, 0.0001780352689424343, 0.00016818376500402324,
                    0.000352965287033997, 0.00013084075992208662, 0.0003885698994730006,
                    0.000653429486009047, 0.0003020377865995061, 0.00044231535738089466,
                    0.00046868314460461226, 0.00018309298151363175, 0.00088985109717689,
                    0.0020414865940008354, 0.00025351811852718914, 0.0006331738861837404,
                    0.0007034492438388822, 0.00022351372066903725, 0.00019571294468421013,
                    0.00031787335587505147, 0.00025537602116123284, 0.00011415439372363761,
                    0.0001257045437969243, 0.00010628333745724262, 0.00014262545524755323,
                    0.0001357498256781186, 0.00014074512686271625, 0.00032190090737313585,
                    9.522662447589694e-5, 0.00017015385468405016, 0.00014953902988653538,
                    0.00010022646846522736, 0.00025503095394504525, 0.00025351811852718914,
                    0.00013364641145961862, 0.00029512288488359715, 0.0001924600980326289,
                    0.00011425697558261237, 9.712501950343018e-5, 0.00014233657629550024,
                    9.127816929595393e-5, 0.00012540063388757067, 0.0001889726255479382,
                    0.00010403935638875275, 0.00023883712023379944, 0.00017601337395269155,
                    0.0002487836743377734, 0.0006392061991105575, 9.024458695225402e-5,
                    0.0003295323827727373, 0.0002559162960194222, 0.00014305057255298314,
                    0.0004722878188865533, 0.0006331738861837404, 0.00029512288488359715,
                    0.0009593985028265281, 0.0003585658307580831, 0.00016302164805463964,
                    0.00010174509234572077, 0.0002589953220632478, 9.86773116659138e-5,
                    0.00021944470289273694, 0.0002494456789265347, 0.00020632334666339077,
                    0.00028909776779647916, 0.0002557615166158476, 0.00023771293146690535,
                    0.0005731556370453457, 0.0002462864214578497, 0.0003045246051763106,
                    0.00030458453852882917, 0.00016776456854865994, 0.0005440677095148366,
                    0.0007034492438388822, 0.0001924600980326289, 0.0003585658307580831,
                    0.0005073871321777783, 0.00021929732339168913, 0.00017107161725823605,
                    0.0002495260923176359, 0.000217265857244111, 0.00017133301754569246,
                    0.00016997044359485852, 0.00018085737837510594, 0.00021886951230563396,
                    0.00020675591334670302, 0.00015140022117193292, 0.0004152760013169241,
                    0.0001311738636449485, 0.0001841004515075021, 0.00017165064044682033,
                    0.00010559552300737976, 0.00029363570013974787, 0.00022351372066903725,
                    0.00011425697558261237, 0.00016302164805463964, 0.00021929732339168913,
                    0.00015395471447026042, 0.0001236767813068668, 0.0001582603260975952,
                    0.00014130683887400472, 0.00013690749806062234, 0.00012798483533271016,
                    0.0001373332860384458, 0.00015144857490947773, 0.0001553114953059647,
                    0.00013174358613513042, 0.00028669541607740306, 0.00011941939725883194,
                    0.00014785309161394813, 0.00013998274360633355, 9.951041296514335e-5,
                    0.00024218754247459806, 0.00019571294468421013, 9.712501950343018e-5,
                    0.00010174509234572077, 0.00017107161725823605, 0.0001236767813068668,
                    0.000119328491029678, 0.0001292063738759132, 0.00011468547875219135,
                    0.00016853674995769293, 0.00017414509092092924, 0.00017415185897646227,
                    0.00021567899605111224, 0.00020141569432953124, 0.00017580694911879542,
                    0.0004241616967938175, 0.0001348142681596813, 0.00021285771122279198,
                    0.00019420892073746814, 0.00012087775771181887, 0.0003372820797296755,
                    0.00031787335587505147, 0.00014233657629550024, 0.0002589953220632478,
                    0.0002495260923176359, 0.0001582603260975952, 0.0001292063738759132,
                    0.00017798467979133597, 0.00014296694260697797, 0.0001600816330544569,
                    0.00015505428177806647, 0.00017477172721320372, 0.00020211869640224817,
                    0.00019613153932772392, 0.00014657204855285684, 0.00032031673707439334,
                    0.00013297097729951442, 0.0001699110537819248, 0.0001622077146672294,
                    9.462426450266332e-5, 0.0003022614422099009, 0.00025537602116123284,
                    9.127816929595393e-5, 9.86773116659138e-5, 0.000217265857244111,
                    0.00014130683887400472, 0.00011468547875219135, 0.00014296694260697797,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    normalise = true
    c1 = PortCovCor(;
                    ce = CorGerber0(; normalise = normalise, mean_w = w, ve = ve,
                                    std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = covt = reshape([0.00019864619425184141, 0.00013425963953565942,
                           0.0001891853819547153, 0.00019131722793598648,
                           0.00021793690246206743, 0.00010405377510909927,
                           0.00026487640690109473, 9.030020849859567e-5,
                           0.00012757140938446103, 0.00011457532970494082,
                           6.66348214971378e-5, 0.00020002989382771858,
                           6.304615744733477e-5, 6.686663491189081e-5,
                           6.0815677561871044e-5, 0.00011155122184171151,
                           0.00013888720899265852, 8.776367715427407e-5,
                           0.00011683794796528652, 0.00011873192355015885,
                           0.00013425963953565942, 0.00020060062616370064,
                           0.00014258056232574433, 0.00013973899798003602,
                           0.0001591823412253473, 0.00010269877922326622,
                           0.000256620947048321, 8.775037930628022e-5,
                           0.00013004881396012715, 0.00010819101262937347,
                           6.812198140915978e-5, 0.00019899880683340527,
                           8.271582588596679e-5, 7.561329660809641e-5, 8.26016800281704e-5,
                           0.0001382499031701364, 0.00012727193164431663,
                           7.736660643528058e-5, 0.0001214917970710955,
                           9.711255900352998e-5, 0.0001891853819547153,
                           0.00014258056232574433, 0.00025023180181571545,
                           0.00019635186097050286, 0.0002272155832123482,
                           0.00010304382838072091, 0.0002580925002894788,
                           5.2292123139243926e-5, 0.00014056817672710036,
                           0.00010889729055644842, 6.333079475700916e-5,
                           0.00022018650550365137, 0.00010029509691575046,
                           4.836825207370413e-5, 5.4013824778472495e-5,
                           8.452778312809513e-5, 0.00014500004490264196,
                           8.091845044033267e-5, 0.0001222567116646567,
                           0.00011872827283431304, 0.00019131722793598648,
                           0.00013973899798003602, 0.00019635186097050286,
                           0.00039197799320071677, 0.0002290695367317837,
                           0.00011286687006853016, 0.0003571302411766143,
                           7.452460261092963e-5, 0.0001438029226071443,
                           0.0001292303435563795, 5.147133209607527e-5,
                           0.0002728827775750142, 0.00021526169226143252,
                           8.118394915226867e-5, 0.00014881560423841143,
                           0.00016003978153237292, 0.00015791392532067247,
                           7.936495831922827e-5, 0.00013760986109191787,
                           0.00011071471223671174, 0.00021793690246206743,
                           0.0001591823412253473, 0.0002272155832123482,
                           0.0002290695367317837, 0.00030911461216782526,
                           0.00011691988899190701, 0.0002880298371353799,
                           0.00010659640081751727, 0.00014106191843439283,
                           0.00010900105913074473, 6.933423097199077e-5,
                           0.00020735179453151362, 3.8717862505548396e-5,
                           6.952869672230817e-5, 0.00012331654620464938,
                           0.00011778194656953519, 0.00016600377037092576,
                           8.584042182194431e-5, 0.00013557289861654715,
                           0.00014671508565008374, 0.00010405377510909927,
                           0.00010269877922326622, 0.00010304382838072091,
                           0.00011286687006853016, 0.00011691988899190701,
                           0.0001915128908033608, 0.00021564250662428177,
                           8.862066981952224e-5, 0.00016286054950427484,
                           0.00015142041395156558, 7.936208918812156e-5,
                           0.0002231101266815535, 0.00023808169722623938,
                           0.00011187771416540069, 0.00014526760312690075,
                           0.00011573158230382612, 9.972162355217428e-5,
                           8.519531696434115e-5, 0.00013904408588391674,
                           0.00010281280062012814, 0.00026487640690109473,
                           0.000256620947048321, 0.0002580925002894788,
                           0.0003571302411766143, 0.0002880298371353799,
                           0.00021564250662428177, 0.0016063027844326404,
                           0.0001587813068331617, 0.00029904153178071966,
                           0.00029170663340899764, 0.00012703633255833205,
                           0.00037367754162826865, 0.00035183503807934225,
                           0.00017726782617138927, 0.0004137426994685837,
                           0.0002603687307851496, 0.0002610450073115908,
                           0.0001599782697331468, 0.0002646392935652585,
                           0.00015395412787015572, 9.030020849859567e-5,
                           8.775037930628022e-5, 5.2292123139243926e-5,
                           7.452460261092963e-5, 0.00010659640081751727,
                           8.862066981952224e-5, 0.0001587813068331617,
                           0.00017038019135706003, 7.284006487431501e-5,
                           9.667724858418649e-5, 7.459926570969952e-5,
                           0.00014779940346600626, 0.000178755718513658,
                           4.868993804870556e-5, 4.1051956169976655e-5,
                           0.00015727359583233915, 9.15646433306699e-5,
                           7.936867368705733e-5, 7.675371714269529e-5, 8.885382728078775e-5,
                           0.00012757140938446103, 0.00013004881396012715,
                           0.00014056817672710036, 0.0001438029226071443,
                           0.00014106191843439283, 0.00016286054950427484,
                           0.00029904153178071966, 7.284006487431501e-5,
                           0.00026904101047426043, 0.00017360055449332107,
                           6.828576177315397e-5, 0.00028959414252173807,
                           0.0003024054302387605, 0.00012347534098747296,
                           0.0001947407738427904, 0.00020350273209466377,
                           0.00013272845700202385, 9.368790368287252e-5,
                           0.00020951855422798258, 0.00010706405877351011,
                           0.00011457532970494082, 0.00010819101262937347,
                           0.00010889729055644842, 0.0001292303435563795,
                           0.00010900105913074473, 0.00015142041395156558,
                           0.00029170663340899764, 9.667724858418649e-5,
                           0.00017360055449332107, 0.00024075963524820054,
                           7.044693292695311e-5, 0.00028380252083317443,
                           0.0002641701559339822, 0.00010416633341794404,
                           0.00013526269177915244, 0.00019407201635066618,
                           0.00011925550933675399, 8.445024089168516e-5,
                           0.00014895117064156086, 0.00010582986388976434,
                           6.66348214971378e-5, 6.812198140915978e-5, 6.333079475700916e-5,
                           5.147133209607527e-5, 6.933423097199077e-5, 7.936208918812156e-5,
                           0.00012703633255833205, 7.459926570969952e-5,
                           6.828576177315397e-5, 7.044693292695311e-5,
                           0.00011254732252706103, 0.00011526311936524352,
                           0.00010206397401377308, 6.299232656112082e-5,
                           7.620928465386729e-5, 9.046480212790513e-5, 6.043181286913472e-5,
                           5.980433166177258e-5, 7.974940192250184e-5, 5.132943765684599e-5,
                           0.00020002989382771858, 0.00019899880683340527,
                           0.00022018650550365137, 0.0002728827775750142,
                           0.00020735179453151362, 0.0002231101266815535,
                           0.00037367754162826865, 0.00014779940346600626,
                           0.00028959414252173807, 0.00028380252083317443,
                           0.00011526311936524352, 0.0007824998303617654,
                           0.0005858039311420092, 0.00015687293808854,
                           0.00030828357900679446, 0.0003632753196462939,
                           0.00018188129009958246, 0.0001626470574389786,
                           0.00023924679229901666, 0.00022559843135446764,
                           6.304615744733477e-5, 8.271582588596679e-5,
                           0.00010029509691575046, 0.00021526169226143252,
                           3.8717862505548396e-5, 0.00023808169722623938,
                           0.00035183503807934225, 0.000178755718513658,
                           0.0003024054302387605, 0.0002641701559339822,
                           0.00010206397401377308, 0.0005858039311420092,
                           0.0020414865940008354, 0.00012830752354432142,
                           0.0003743896993631501, 0.0004677555140349871,
                           0.00011956774824738945, 0.00010127383180032048,
                           0.00019989436210698718, 0.00016191441324293294,
                           6.686663491189081e-5, 7.561329660809641e-5, 4.836825207370413e-5,
                           8.118394915226867e-5, 6.952869672230817e-5,
                           0.00011187771416540069, 0.00017726782617138927,
                           4.868993804870556e-5, 0.00012347534098747296,
                           0.00010416633341794404, 6.299232656112082e-5,
                           0.00015687293808854, 0.00012830752354432142,
                           0.00013364641145961862, 0.0002156446867995369,
                           0.00010731713437389446, 7.969105468663526e-5,
                           6.317374237134621e-5, 0.00011262250272059591,
                           4.5984556753158617e-5, 6.0815677561871044e-5,
                           8.26016800281704e-5, 5.4013824778472495e-5,
                           0.00014881560423841143, 0.00012331654620464938,
                           0.00014526760312690075, 0.0004137426994685837,
                           4.1051956169976655e-5, 0.0001947407738427904,
                           0.00013526269177915244, 7.620928465386729e-5,
                           0.00030828357900679446, 0.0003743896993631501,
                           0.0002156446867995369, 0.0009593985028265281,
                           0.00020069264617265825, 7.072378032056703e-5,
                           4.9797228156005676e-5, 0.00015310330878226045,
                           5.4871986178121706e-5, 0.00011155122184171151,
                           0.0001382499031701364, 8.452778312809513e-5,
                           0.00016003978153237292, 0.00011778194656953519,
                           0.00011573158230382612, 0.0002603687307851496,
                           0.00015727359583233915, 0.00020350273209466377,
                           0.00019407201635066618, 9.046480212790513e-5,
                           0.0003632753196462939, 0.0004677555140349871,
                           0.00010731713437389446, 0.00020069264617265825,
                           0.0005073871321777783, 0.0001224598308192915,
                           9.130055081387548e-5, 0.00016067517151317198,
                           0.00013064029390290238, 0.00013888720899265852,
                           0.00012727193164431663, 0.00014500004490264196,
                           0.00015791392532067247, 0.00016600377037092576,
                           9.972162355217428e-5, 0.0002610450073115908, 9.15646433306699e-5,
                           0.00013272845700202385, 0.00011925550933675399,
                           6.043181286913472e-5, 0.00018188129009958246,
                           0.00011956774824738945, 7.969105468663526e-5,
                           7.072378032056703e-5, 0.0001224598308192915,
                           0.00015395471447026042, 9.03392464371573e-5,
                           0.0001243456091154825, 0.000112986169635096,
                           8.776367715427407e-5, 7.736660643528058e-5, 8.091845044033267e-5,
                           7.936495831922827e-5, 8.584042182194431e-5, 8.519531696434115e-5,
                           0.0001599782697331468, 7.936867368705733e-5,
                           9.368790368287252e-5, 8.445024089168516e-5, 5.980433166177258e-5,
                           0.0001626470574389786, 0.00010127383180032048,
                           6.317374237134621e-5, 4.9797228156005676e-5,
                           9.130055081387548e-5, 9.03392464371573e-5, 0.000119328491029678,
                           8.883437639193713e-5, 7.068459075911738e-5,
                           0.00011683794796528652, 0.0001214917970710955,
                           0.0001222567116646567, 0.00013760986109191787,
                           0.00013557289861654715, 0.00013904408588391674,
                           0.0002646392935652585, 7.675371714269529e-5,
                           0.00020951855422798258, 0.00014895117064156086,
                           7.974940192250184e-5, 0.00023924679229901666,
                           0.00019989436210698718, 0.00011262250272059591,
                           0.00015310330878226045, 0.00016067517151317198,
                           0.0001243456091154825, 8.883437639193713e-5,
                           0.00017798467979133597, 9.762982256011493e-5,
                           0.00011873192355015885, 9.711255900352998e-5,
                           0.00011872827283431304, 0.00011071471223671174,
                           0.00014671508565008374, 0.00010281280062012814,
                           0.00015395412787015572, 8.885382728078775e-5,
                           0.00010706405877351011, 0.00010582986388976434,
                           5.132943765684599e-5, 0.00022559843135446764,
                           0.00016191441324293294, 4.5984556753158617e-5,
                           5.4871986178121706e-5, 0.00013064029390290238,
                           0.000112986169635096, 7.068459075911738e-5, 9.762982256011493e-5,
                           0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(;
                    ce = CorGerber1(; normalise = normalise, mean_w = w, ve = ve,
                                    std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 5.790289152962848e-5, 9.815975506348757e-5,
                    8.009967622315327e-5, 0.0001046449305357801, 4.166051041866239e-5,
                    9.565008552443358e-5, 3.3020459189550735e-5, 5.280026190699802e-5,
                    4.7128872345638935e-5, 2.5218041156506664e-5, 7.056534283912718e-5,
                    2.2091626818752365e-5, 2.673179368683415e-5, 2.4612931488630645e-5,
                    4.101354669451262e-5, 6.789739362867979e-5, 3.6372787021105184e-5,
                    5.089354964634542e-5, 4.913538726389491e-5, 5.790289152962848e-5,
                    0.00020060062616370064, 6.566246487837123e-5, 5.779489156256453e-5,
                    6.75160910605572e-5, 4.0126822889214257e-5, 8.645730348412965e-5,
                    3.271071262637816e-5, 5.1122991287386855e-5, 4.126729527521229e-5,
                    2.7014941541931415e-5, 6.750444984224021e-5, 2.8191199252756152e-5,
                    3.013550290851094e-5, 3.310928346646328e-5, 5.019057976002863e-5,
                    5.568166573352273e-5, 3.0507590165399807e-5, 5.011276257262367e-5,
                    4.158392454704844e-5, 9.815975506348757e-5, 6.566246487837123e-5,
                    0.00025023180181571545, 8.032857741324239e-5, 0.0001064746889018188,
                    4.251748636546699e-5, 9.113659759132369e-5, 1.924549580876848e-5,
                    5.643973902540433e-5, 4.401687471944647e-5, 2.6032026682427214e-5,
                    7.410288831139236e-5, 3.353591200245114e-5, 1.947260200054252e-5,
                    2.1303106264691293e-5, 3.137414413229431e-5, 6.635124741959824e-5,
                    3.2060346929035204e-5, 4.875162722770635e-5, 4.902863272940204e-5,
                    8.009967622315327e-5, 5.779489156256453e-5, 8.032857741324239e-5,
                    0.00039197799320071677, 9.022558757628106e-5, 4.40411759992548e-5,
                    0.000132864387415907, 2.707725340148794e-5, 5.847310856618289e-5,
                    5.342626773869046e-5, 2.0207763301935592e-5, 9.029764009926463e-5,
                    7.716138576399513e-5, 3.15225148826551e-5, 6.194341805453339e-5,
                    5.608345028938761e-5, 6.848590929889534e-5, 3.170673452588416e-5,
                    5.712071963830223e-5, 4.57654973059578e-5, 0.0001046449305357801,
                    6.75160910605572e-5, 0.0001064746889018188, 9.022558757628106e-5,
                    0.00030911461216782526, 4.462611425123411e-5, 0.00010649051873030316,
                    3.800519926709587e-5, 5.732103503551082e-5, 4.4272762773104925e-5,
                    2.773754453249407e-5, 7.140546073143883e-5, 1.302276485213808e-5,
                    2.674390533191408e-5, 4.892370586504216e-5, 4.191800302678077e-5,
                    7.538003833243651e-5, 3.155878559206059e-5, 5.277565067402405e-5,
                    5.652029961903461e-5, 4.166051041866239e-5, 4.0126822889214257e-5,
                    4.251748636546699e-5, 4.40411759992548e-5, 4.462611425123411e-5,
                    0.0001915128908033608, 7.442479804599501e-5, 3.136475702665547e-5,
                    6.291781646630511e-5, 6.323517510402435e-5, 3.267569255834495e-5,
                    8.105444078369633e-5, 8.147545374663415e-5, 4.3381351843909195e-5,
                    5.6517736189795616e-5, 4.351975777121745e-5, 4.499794928731685e-5,
                    3.335032321754228e-5, 5.660250311550198e-5, 3.878269748752628e-5,
                    9.565008552443358e-5, 8.645730348412965e-5, 9.113659759132369e-5,
                    0.000132864387415907, 0.00010649051873030316, 7.442479804599501e-5,
                    0.0016063027844326404, 5.089622258924934e-5, 0.00011868104367772373,
                    9.987745654044215e-5, 4.3919149181417935e-5, 0.00010617439551926956,
                    0.00011232317460992998, 5.880208169849256e-5, 0.0001501403357810457,
                    8.652873362305999e-5, 9.654639247860006e-5, 5.182798742166934e-5,
                    8.719619330701392e-5, 5.315394372882808e-5, 3.3020459189550735e-5,
                    3.271071262637816e-5, 1.924549580876848e-5, 2.707725340148794e-5,
                    3.800519926709587e-5, 3.136475702665547e-5, 5.089622258924934e-5,
                    0.00017038019135706003, 2.5744266071722126e-5, 3.6110999971357303e-5,
                    2.8247575618719277e-5, 5.093458869581598e-5, 6.0698314444057707e-5,
                    1.87125148966637e-5, 1.4103661387525727e-5, 5.919247260106927e-5,
                    3.465176966351468e-5, 2.7882781227796624e-5, 2.842554021994097e-5,
                    3.212337054716365e-5, 5.280026190699802e-5, 5.1122991287386855e-5,
                    5.643973902540433e-5, 5.847310856618289e-5, 5.732103503551082e-5,
                    6.291781646630511e-5, 0.00011868104367772373, 2.5744266071722126e-5,
                    0.00026904101047426043, 7.78311286674084e-5, 2.8572820272649775e-5,
                    0.00010124407648778808, 0.00010895499513051499, 5.048927122877895e-5,
                    7.877346222311953e-5, 8.12718321387351e-5, 6.352079561189806e-5,
                    3.975481048857031e-5, 0.0001397516556598502, 4.307658267448689e-5,
                    4.7128872345638935e-5, 4.126729527521229e-5, 4.401687471944647e-5,
                    5.342626773869046e-5, 4.4272762773104925e-5, 6.323517510402435e-5,
                    9.987745654044215e-5, 3.6110999971357303e-5, 7.78311286674084e-5,
                    0.00024075963524820054, 2.9551865125203665e-5, 0.00010833631578830442,
                    0.00010254544581509141, 4.0877868606871523e-5, 5.508405724072635e-5,
                    7.645565697297236e-5, 4.587962265714181e-5, 3.516879791438986e-5,
                    6.283544259905589e-5, 4.371024921519192e-5, 2.5218041156506664e-5,
                    2.7014941541931415e-5, 2.6032026682427214e-5, 2.0207763301935592e-5,
                    2.773754453249407e-5, 3.267569255834495e-5, 4.3919149181417935e-5,
                    2.8247575618719277e-5, 2.8572820272649775e-5, 2.9551865125203665e-5,
                    0.00011254732252706103, 4.114003799573325e-5, 3.565882412566092e-5,
                    2.5926238603179368e-5, 3.248334690353868e-5, 3.419005444220658e-5,
                    2.554651146908249e-5, 2.251940402667848e-5, 3.3770123853969585e-5,
                    2.1627216788561188e-5, 7.056534283912718e-5, 6.750444984224021e-5,
                    7.410288831139236e-5, 9.029764009926463e-5, 7.140546073143883e-5,
                    8.105444078369633e-5, 0.00010617439551926956, 5.093458869581598e-5,
                    0.00010124407648778808, 0.00010833631578830442, 4.114003799573325e-5,
                    0.0007824998303617654, 0.00018790491470430527, 5.076698182536184e-5,
                    0.000112097312435564, 0.0001222588763804997, 6.666278343224106e-5,
                    5.2650970150126194e-5, 8.060967830375394e-5, 7.755788953559322e-5,
                    2.2091626818752365e-5, 2.8191199252756152e-5, 3.353591200245114e-5,
                    7.716138576399513e-5, 1.302276485213808e-5, 8.147545374663415e-5,
                    0.00011232317460992998, 6.0698314444057707e-5, 0.00010895499513051499,
                    0.00010254544581509141, 3.565882412566092e-5, 0.00018790491470430527,
                    0.0020414865940008354, 4.670685739648131e-5, 0.0001469978016420057,
                    0.00015824839829354148, 4.231105791041056e-5, 3.488362050466126e-5,
                    7.489183879537039e-5, 6.195002196587343e-5, 2.673179368683415e-5,
                    3.013550290851094e-5, 1.947260200054252e-5, 3.15225148826551e-5,
                    2.674390533191408e-5, 4.3381351843909195e-5, 5.880208169849256e-5,
                    1.87125148966637e-5, 5.048927122877895e-5, 4.0877868606871523e-5,
                    2.5926238603179368e-5, 5.076698182536184e-5, 4.670685739648131e-5,
                    0.00013364641145961862, 9.109936706673588e-5, 3.934459522319578e-5,
                    3.497496015431397e-5, 2.482351291639502e-5, 4.653296423872753e-5,
                    1.812281082021967e-5, 2.4612931488630645e-5, 3.310928346646328e-5,
                    2.1303106264691293e-5, 6.194341805453339e-5, 4.892370586504216e-5,
                    5.6517736189795616e-5, 0.0001501403357810457, 1.4103661387525727e-5,
                    7.877346222311953e-5, 5.508405724072635e-5, 3.248334690353868e-5,
                    0.000112097312435564, 0.0001469978016420057, 9.109936706673588e-5,
                    0.0009593985028265281, 7.821758238344545e-5, 3.003389976019471e-5,
                    1.8688168919501018e-5, 5.835222683598006e-5, 2.2733966485445173e-5,
                    4.101354669451262e-5, 5.019057976002863e-5, 3.137414413229431e-5,
                    5.608345028938761e-5, 4.191800302678077e-5, 4.351975777121745e-5,
                    8.652873362305999e-5, 5.919247260106927e-5, 8.12718321387351e-5,
                    7.645565697297236e-5, 3.419005444220658e-5, 0.0001222588763804997,
                    0.00015824839829354148, 3.934459522319578e-5, 7.821758238344545e-5,
                    0.0005073871321777783, 4.7158523664548754e-5, 3.335747611476062e-5,
                    6.377413573248922e-5, 4.8222050015979036e-5, 6.789739362867979e-5,
                    5.568166573352273e-5, 6.635124741959824e-5, 6.848590929889534e-5,
                    7.538003833243651e-5, 4.499794928731685e-5, 9.654639247860006e-5,
                    3.465176966351468e-5, 6.352079561189806e-5, 4.587962265714181e-5,
                    2.554651146908249e-5, 6.666278343224106e-5, 4.231105791041056e-5,
                    3.497496015431397e-5, 3.003389976019471e-5, 4.7158523664548754e-5,
                    0.00015395471447026042, 3.806124991922639e-5, 5.771399382785543e-5,
                    4.6766479858827796e-5, 3.6372787021105184e-5, 3.0507590165399807e-5,
                    3.2060346929035204e-5, 3.170673452588416e-5, 3.155878559206059e-5,
                    3.335032321754228e-5, 5.182798742166934e-5, 2.7882781227796624e-5,
                    3.975481048857031e-5, 3.516879791438986e-5, 2.251940402667848e-5,
                    5.2650970150126194e-5, 3.488362050466126e-5, 2.482351291639502e-5,
                    1.8688168919501018e-5, 3.335747611476062e-5, 3.806124991922639e-5,
                    0.000119328491029678, 3.837605612092056e-5, 3.0219872149881682e-5,
                    5.089354964634542e-5, 5.011276257262367e-5, 4.875162722770635e-5,
                    5.712071963830223e-5, 5.277565067402405e-5, 5.660250311550198e-5,
                    8.719619330701392e-5, 2.842554021994097e-5, 0.0001397516556598502,
                    6.283544259905589e-5, 3.3770123853969585e-5, 8.060967830375394e-5,
                    7.489183879537039e-5, 4.653296423872753e-5, 5.835222683598006e-5,
                    6.377413573248922e-5, 5.771399382785543e-5, 3.837605612092056e-5,
                    0.00017798467979133597, 3.9014506707986296e-5, 4.913538726389491e-5,
                    4.158392454704844e-5, 4.902863272940204e-5, 4.57654973059578e-5,
                    5.652029961903461e-5, 3.878269748752628e-5, 5.315394372882808e-5,
                    3.212337054716365e-5, 4.307658267448689e-5, 4.371024921519192e-5,
                    2.1627216788561188e-5, 7.755788953559322e-5, 6.195002196587343e-5,
                    1.812281082021967e-5, 2.2733966485445173e-5, 4.8222050015979036e-5,
                    4.6766479858827796e-5, 3.0219872149881682e-5, 3.9014506707986296e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(;
                    ce = CorGerber2(; normalise = normalise, mean_w = w, ve = ve,
                                    std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184147, 8.093606541224216e-5, 0.0001292780549739148,
                    0.00011304237705907611, 0.00014143789697986715, 5.946400028670962e-5,
                    0.00014061202738889893, 4.838719782907777e-5, 7.493255671005544e-5,
                    6.685574128774655e-5, 3.665879854666671e-5, 0.00010451485946468614,
                    3.2701783009225266e-5, 3.823956289326478e-5, 3.5099513429086156e-5,
                    5.995607130288032e-5, 9.124933703984123e-5, 5.143808062416295e-5,
                    7.073015248047412e-5, 6.961691875836e-5, 8.093606541224216e-5,
                    0.00020060062616370064, 8.991535555370827e-5, 8.177387938181198e-5,
                    9.482701447854161e-5, 5.7740550153416075e-5, 0.0001294819329152457,
                    4.770763048129992e-5, 7.33809863356177e-5, 5.975191491054725e-5,
                    3.8702812742629385e-5, 0.00010115624397393562, 4.205544432195544e-5,
                    4.30885858391718e-5, 4.73563495574156e-5, 7.371008242848842e-5,
                    7.749327161953223e-5, 4.376831412412267e-5, 7.098954933063334e-5,
                    5.825055881964274e-5, 0.0001292780549739148, 8.991535555370827e-5,
                    0.0002502318018157154, 0.00011403330324458328, 0.00014501493468937741,
                    6.0223296727590784e-5, 0.00013483523519254166, 2.8161995584634702e-5,
                    8.055088060370197e-5, 6.270539103500007e-5, 3.691781365933895e-5,
                    0.00011123457681759122, 5.026810801799405e-5, 2.776333771140034e-5,
                    3.061524357365738e-5, 4.579680075700509e-5, 9.107311382990216e-5,
                    4.593173718707674e-5, 6.972256509913439e-5, 6.943181291117024e-5,
                    0.00011304237705907611, 8.177387938181198e-5, 0.00011403330324458328,
                    0.0003919779932007167, 0.00012951790350431198, 6.346449807887583e-5,
                    0.0001940696756497559, 3.9795932171955505e-5, 8.298727911047038e-5,
                    7.557866515052782e-5, 2.9004209879272438e-5, 0.00013638234757643237,
                    0.00011363521234126938, 4.538671675621483e-5, 8.758563019880325e-5,
                    8.322303709200721e-5, 9.55625881801634e-5, 4.533909259796564e-5,
                    8.089553574838298e-5, 6.473872021104262e-5, 0.00014143789697986715,
                    9.482701447854161e-5, 0.00014501493468937741, 0.00012951790350431198,
                    0.0003091146121678253, 6.462457113884715e-5, 0.00015554788180833698,
                    5.6048685532744947e-5, 8.147384058785701e-5, 6.299888316283672e-5,
                    3.9659341828291246e-5, 0.00010645380586093791, 1.9509939588601343e-5,
                    3.861554680963842e-5, 7.028570048175864e-5, 6.186465484433992e-5,
                    0.00010378441403209112, 4.614672034976439e-5, 7.60799569702231e-5,
                    8.167929121050279e-5, 5.946400028670962e-5, 5.7740550153416075e-5,
                    6.0223296727590784e-5, 6.346449807887583e-5, 6.462457113884715e-5,
                    0.00019151289080336078, 0.00011068020197482885, 4.634578655488038e-5,
                    9.102516244003805e-5, 8.933868732031045e-5, 4.640196028612527e-5,
                    0.00011905170186594181, 0.00012145519617744478, 6.258118400084196e-5,
                    8.165476968821751e-5, 6.322963166399466e-5, 6.207466969208685e-5,
                    4.7943144845230616e-5, 8.035178751150333e-5, 5.6440917957540704e-5,
                    0.00014061202738889893, 0.0001294819329152457, 0.00013483523519254166,
                    0.0001940696756497559, 0.00015554788180833698, 0.00011068020197482885,
                    0.0016063027844326408, 7.708196029821096e-5, 0.0001703009780881628,
                    0.00014912149185036686, 6.547256278872712e-5, 0.0001654680012292181,
                    0.00017050531422915994, 8.841219621948885e-5, 0.00022153472888950386,
                    0.00012990021359002497, 0.00014129727038990952, 7.831698457775564e-5,
                    0.00013131201167802922, 7.924758416859014e-5, 4.838719782907777e-5,
                    4.770763048129992e-5, 2.8161995584634702e-5, 3.9795932171955505e-5,
                    5.6048685532744947e-5, 4.634578655488038e-5, 7.708196029821096e-5,
                    0.00017038019135706006, 3.810151442169038e-5, 5.2689983146667074e-5,
                    4.11015060609133e-5, 7.581164954969934e-5, 9.07454189777724e-5,
                    2.705979698106481e-5, 2.1117137713201673e-5, 8.602294175872132e-5,
                    5.0400884510642164e-5, 4.1280345306639854e-5, 4.155580109655336e-5,
                    4.731766566444615e-5, 7.493255671005544e-5, 7.33809863356177e-5,
                    8.055088060370197e-5, 8.298727911047038e-5, 8.147384058785701e-5,
                    9.102516244003805e-5, 0.0001703009780881628, 3.810151442169038e-5,
                    0.0002690410104742605, 0.00010738820942048427, 4.019994507408333e-5,
                    0.00015092922872084164, 0.00016031260355240458, 7.155483508889765e-5,
                    0.00011239492308541925, 0.00011651181247814105, 8.603031543600261e-5,
                    5.5849969528630834e-5, 0.00016879478952117933, 6.13336233669999e-5,
                    6.685574128774655e-5, 5.975191491054725e-5, 6.270539103500007e-5,
                    7.557866515052782e-5, 6.299888316283672e-5, 8.933868732031045e-5,
                    0.00014912149185036686, 5.2689983146667074e-5, 0.00010738820942048427,
                    0.00024075963524820054, 4.162966575025704e-5, 0.0001576162573762967,
                    0.00014777039761158504, 5.870633627797361e-5, 7.836556266445383e-5,
                    0.00010989905397086097, 6.627628165847167e-5, 4.9693697245045066e-5,
                    8.84855020014497e-5, 6.185752467316506e-5, 3.665879854666671e-5,
                    3.8702812742629385e-5, 3.691781365933895e-5, 2.9004209879272438e-5,
                    3.9659341828291246e-5, 4.640196028612527e-5, 6.547256278872712e-5,
                    4.11015060609133e-5, 4.019994507408333e-5, 4.162966575025704e-5,
                    0.00011254732252706105, 6.104290522572821e-5, 5.288598352293413e-5,
                    3.6731306676202795e-5, 4.558901778558713e-5, 4.977022996279756e-5,
                    3.5926730956174164e-5, 3.276188613732063e-5, 4.756433408422542e-5,
                    3.041691456045089e-5, 0.00010451485946468614, 0.00010115624397393562,
                    0.00011123457681759122, 0.00013638234757643237, 0.00010645380586093791,
                    0.00011905170186594181, 0.0001654680012292181, 7.581164954969934e-5,
                    0.00015092922872084164, 0.0001576162573762967, 6.104290522572821e-5,
                    0.0007824998303617657, 0.00028557001618924414, 7.699615261691006e-5,
                    0.0001659899635486911, 0.00018309623528740737, 9.80806952047804e-5,
                    7.970050645874633e-5, 0.00012088357522047374, 0.00011615591475021857,
                    3.2701783009225266e-5, 4.205544432195544e-5, 5.026810801799405e-5,
                    0.00011363521234126938, 1.9509939588601343e-5, 0.00012145519617744478,
                    0.00017050531422915994, 9.07454189777724e-5, 0.00016031260355240458,
                    0.00014777039761158504, 5.288598352293413e-5, 0.00028557001618924414,
                    0.002041486594000836, 6.850343175918947e-5, 0.0002113867771454737,
                    0.00023669319836548577, 6.250194930587221e-5, 5.191193470157643e-5,
                    0.0001088778242161827, 8.965904718911991e-5, 3.823956289326478e-5,
                    4.30885858391718e-5, 2.776333771140034e-5, 4.538671675621483e-5,
                    3.861554680963842e-5, 6.258118400084196e-5, 8.841219621948885e-5,
                    2.705979698106481e-5, 7.155483508889765e-5, 5.870633627797361e-5,
                    3.6731306676202795e-5, 7.699615261691006e-5, 6.850343175918947e-5,
                    0.00013364641145961864, 0.0001283160801805021, 5.765505151078092e-5,
                    4.8643781543110985e-5, 3.564674881167914e-5, 6.597924396617415e-5,
                    2.5987170873033158e-5, 3.5099513429086156e-5, 4.73563495574156e-5,
                    3.061524357365738e-5, 8.758563019880325e-5, 7.028570048175864e-5,
                    8.165476968821751e-5, 0.00022153472888950386, 2.1117137713201673e-5,
                    0.00011239492308541925, 7.836556266445383e-5, 4.558901778558713e-5,
                    0.0001659899635486911, 0.0002113867771454737, 0.0001283160801805021,
                    0.0009593985028265283, 0.00011306306977048046, 4.216556086454668e-5,
                    2.7266340668152328e-5, 8.453285942406469e-5, 3.2188720984409305e-5,
                    5.995607130288032e-5, 7.371008242848842e-5, 4.579680075700509e-5,
                    8.322303709200721e-5, 6.186465484433992e-5, 6.322963166399466e-5,
                    0.00012990021359002497, 8.602294175872132e-5, 0.00011651181247814105,
                    0.00010989905397086097, 4.977022996279756e-5, 0.00018309623528740737,
                    0.00023669319836548577, 5.765505151078092e-5, 0.00011306306977048046,
                    0.0005073871321777784, 6.820579394749378e-5, 4.887568247621808e-5,
                    9.124394716565725e-5, 7.062897757304846e-5, 9.124933703984123e-5,
                    7.749327161953223e-5, 9.107311382990216e-5, 9.55625881801634e-5,
                    0.00010378441403209112, 6.207466969208685e-5, 0.00014129727038990952,
                    5.0400884510642164e-5, 8.603031543600261e-5, 6.627628165847167e-5,
                    3.5926730956174164e-5, 9.80806952047804e-5, 6.250194930587221e-5,
                    4.8643781543110985e-5, 4.216556086454668e-5, 6.820579394749378e-5,
                    0.0001539547144702604, 5.361064426073471e-5, 7.87693798368873e-5,
                    6.616876460522331e-5, 5.143808062416295e-5, 4.376831412412267e-5,
                    4.593173718707674e-5, 4.533909259796564e-5, 4.614672034976439e-5,
                    4.7943144845230616e-5, 7.831698457775564e-5, 4.1280345306639854e-5,
                    5.5849969528630834e-5, 4.9693697245045066e-5, 3.276188613732063e-5,
                    7.970050645874633e-5, 5.191193470157643e-5, 3.564674881167914e-5,
                    2.7266340668152328e-5, 4.887568247621808e-5, 5.361064426073471e-5,
                    0.00011932849102967798, 5.36292209348795e-5, 4.2387405233347054e-5,
                    7.073015248047412e-5, 7.098954933063334e-5, 6.972256509913439e-5,
                    8.089553574838298e-5, 7.60799569702231e-5, 8.035178751150333e-5,
                    0.00013131201167802922, 4.155580109655336e-5, 0.00016879478952117933,
                    8.84855020014497e-5, 4.756433408422542e-5, 0.00012088357522047374,
                    0.0001088778242161827, 6.597924396617415e-5, 8.453285942406469e-5,
                    9.124394716565725e-5, 7.87693798368873e-5, 5.36292209348795e-5,
                    0.00017798467979133594, 5.587559721826643e-5, 6.961691875836e-5,
                    5.825055881964274e-5, 6.943181291117024e-5, 6.473872021104262e-5,
                    8.167929121050279e-5, 5.6440917957540704e-5, 7.924758416859014e-5,
                    4.731766566444615e-5, 6.13336233669999e-5, 6.185752467316506e-5,
                    3.041691456045089e-5, 0.00011615591475021857, 8.965904718911991e-5,
                    2.5987170873033158e-5, 3.2188720984409305e-5, 7.062897757304846e-5,
                    6.616876460522331e-5, 4.2387405233347054e-5, 5.587559721826643e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorSB0(; normalise = normalise, mean_w = w, ve = ve, std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.0001417629563641093, 0.0001965230093640919,
                    0.00019253489820235343, 0.00022481564799635545, 0.00010991277038129118,
                    0.0002904341316971352, 9.331693584681004e-5, 0.0001367164622392419,
                    0.0001233001804466349, 7.966704450924141e-5, 0.00019738084978992957,
                    5.35435482508092e-5, 7.010250640484566e-5, 4.809238383181649e-5,
                    0.00012817538882320365, 0.00014605312859657308, 9.311566661185276e-5,
                    0.00012386004036466316, 0.00012517897745952252, 0.0001417629563641093,
                    0.00020060062616370064, 0.00015437762983613396, 0.0001547901239086932,
                    0.00017100577470413023, 0.00010785617603303555, 0.00026942704794022447,
                    8.942551799013034e-5, 0.0001381685211874238, 0.00011728737437955366,
                    7.468303822845322e-5, 0.0002110828367953653, 0.00010501982085280977,
                    7.972174991147541e-5, 7.891009389257399e-5, 0.0001429065866393038,
                    0.00013530088565956222, 7.836479192202866e-5, 0.00012778179809329082,
                    0.00010588875131090237, 0.0001965230093640919, 0.00015437762983613396,
                    0.00025023180181571545, 0.00021077588088097034, 0.0002368518411277482,
                    0.00010698848428209451, 0.0002794352226469044, 5.826067158533716e-5,
                    0.000146592466594874, 0.00011670272259889115, 7.251013021423783e-5,
                    0.0002254109741673368, 8.892659696192147e-5, 5.097661294223563e-5,
                    5.1136946841348e-5, 9.051159968460476e-5, 0.00015288215818958875,
                    8.855076776433685e-5, 0.000125608747770954, 0.00012950689551971263,
                    0.00019253489820235343, 0.0001547901239086932, 0.00021077588088097034,
                    0.00039197799320071677, 0.00023332498151282797, 0.00011782521037402131,
                    0.0003698556760063338, 8.114243838630746e-5, 0.00015384088104893927,
                    0.00014525883540906896, 5.108459849074695e-5, 0.0002938270830262514,
                    0.0002217391872723519, 8.079178348777915e-5, 0.00015461315970371025,
                    0.000170408439228923, 0.00016328297775516836, 8.374846199795183e-5,
                    0.0001436543835261241, 0.00011504265633552953, 0.00022481564799635545,
                    0.00017100577470413023, 0.0002368518411277482, 0.00023332498151282797,
                    0.00030911461216782526, 0.00012894250894028792, 0.0003076928928029709,
                    0.00011481495824622353, 0.0001523471166577615, 0.00012075104205508548,
                    7.866293093464938e-5, 0.00022113600705725038, 2.185060245343079e-5,
                    7.814122920243395e-5, 0.00011579825223456303, 0.0001352276145306051,
                    0.00016899343091256823, 0.00010324095948506487, 0.00014306450219792876,
                    0.0001562907391384897, 0.00010991277038129118, 0.00010785617603303555,
                    0.00010698848428209451, 0.00011782521037402131, 0.00012894250894028792,
                    0.0001915128908033608, 0.00022776731915996826, 9.636634171799292e-5,
                    0.00016390959717625653, 0.00015602450561486218, 8.482546698913631e-5,
                    0.00022559093783413583, 0.0002440026507934781, 0.00011217163791610825,
                    0.0001440320824858827, 0.00012534883931577384, 0.00010648200539248643,
                    8.684790076139595e-5, 0.0001424039297923303, 0.0001029164446713477,
                    0.0002904341316971352, 0.00026942704794022447, 0.0002794352226469044,
                    0.0003698556760063338, 0.0003076928928029709, 0.00022776731915996826,
                    0.0016063027844326404, 0.00017246297308683536, 0.0002853772775269783,
                    0.00030813102058828147, 0.00012578354942843208, 0.0003594973881859668,
                    0.00035013483863542976, 0.00018626596605150585, 0.0004174740379878913,
                    0.00026747097867371744, 0.00027232117963326764, 0.0001654058490697318,
                    0.00025454099538862204, 0.00016769653504938235, 9.331693584681004e-5,
                    8.942551799013034e-5, 5.826067158533716e-5, 8.114243838630746e-5,
                    0.00011481495824622353, 9.636634171799292e-5, 0.00017246297308683536,
                    0.00017038019135706003, 7.974607221889397e-5, 0.0001033438599775137,
                    7.877319256230218e-5, 0.00014630891490104685, 0.00016951887628600845,
                    5.292793497703961e-5, 4.3418178270273316e-5, 0.00018293287323999308,
                    9.546732243370022e-5, 8.257663545248458e-5, 8.589193800046138e-5,
                    8.902180143078731e-5, 0.0001367164622392419, 0.0001381685211874238,
                    0.000146592466594874, 0.00015384088104893927, 0.0001523471166577615,
                    0.00016390959717625653, 0.0002853772775269783, 7.974607221889397e-5,
                    0.00026904101047426043, 0.00017846899110668908, 7.687031609913374e-5,
                    0.000293113306466808, 0.0002826001463020693, 0.00012319020454406223,
                    0.000197194656706551, 0.0002076939958810677, 0.00013733177684545738,
                    9.655040312032232e-5, 0.0002079902205227442, 0.00010977621279825628,
                    0.0001233001804466349, 0.00011728737437955366, 0.00011670272259889115,
                    0.00014525883540906896, 0.00012075104205508548, 0.00015602450561486218,
                    0.00030813102058828147, 0.0001033438599775137, 0.00017846899110668908,
                    0.00024075963524820054, 7.614228822439095e-5, 0.00028046733869534695,
                    0.0002662404796927306, 0.00011144865611531442, 0.00012454291261083746,
                    0.00020547798894396375, 0.00012307788876552762, 8.540396834968491e-5,
                    0.00015696881547621656, 0.00010529078722302967, 7.966704450924141e-5,
                    7.468303822845322e-5, 7.251013021423783e-5, 5.108459849074695e-5,
                    7.866293093464938e-5, 8.482546698913631e-5, 0.00012578354942843208,
                    7.877319256230218e-5, 7.687031609913374e-5, 7.614228822439095e-5,
                    0.00011254732252706103, 0.00011650991687827651, 9.459781352221501e-5,
                    6.28520424392026e-5, 6.905827126819106e-5, 9.66763199304773e-5,
                    6.479990286279753e-5, 6.570896842808087e-5, 8.612572333013698e-5,
                    5.4261649924940195e-5, 0.00019738084978992957, 0.0002110828367953653,
                    0.0002254109741673368, 0.0002938270830262514, 0.00022113600705725038,
                    0.00022559093783413583, 0.0003594973881859668, 0.00014630891490104685,
                    0.000293113306466808, 0.00028046733869534695, 0.00011650991687827651,
                    0.0007824998303617654, 0.0005809753433959342, 0.0001586415496535629,
                    0.0002900148531822182, 0.00039829486852362237, 0.00018454254852570014,
                    0.00017416855524404577, 0.00024191077537986372, 0.00022786988669360408,
                    5.35435482508092e-5, 0.00010501982085280977, 8.892659696192147e-5,
                    0.0002217391872723519, 2.185060245343079e-5, 0.0002440026507934781,
                    0.00035013483863542976, 0.00016951887628600845, 0.0002826001463020693,
                    0.0002662404796927306, 9.459781352221501e-5, 0.0005809753433959342,
                    0.0020414865940008354, 0.00012453174350447515, 0.00032405063924209084,
                    0.0004746786048396232, 0.00011197129291790964, 9.436900898874144e-5,
                    0.00017792806962690043, 0.000140228215307278, 7.010250640484566e-5,
                    7.972174991147541e-5, 5.097661294223563e-5, 8.079178348777915e-5,
                    7.814122920243395e-5, 0.00011217163791610825, 0.00018626596605150585,
                    5.292793497703961e-5, 0.00012319020454406223, 0.00011144865611531442,
                    6.28520424392026e-5, 0.0001586415496535629, 0.00012453174350447515,
                    0.00013364641145961862, 0.00022086203706559216, 0.0001105334205256477,
                    8.03857835674942e-5, 6.872200568250179e-5, 0.00011467241041519043,
                    4.885216808422985e-5, 4.809238383181649e-5, 7.891009389257399e-5,
                    5.1136946841348e-5, 0.00015461315970371025, 0.00011579825223456303,
                    0.0001440320824858827, 0.0004174740379878913, 4.3418178270273316e-5,
                    0.000197194656706551, 0.00012454291261083746, 6.905827126819106e-5,
                    0.0002900148531822182, 0.00032405063924209084, 0.00022086203706559216,
                    0.0009593985028265281, 0.00017531703553020248, 7.38530559610806e-5,
                    4.434141254187418e-5, 0.00015982579342376234, 5.744692343424724e-5,
                    0.00012817538882320365, 0.0001429065866393038, 9.051159968460476e-5,
                    0.000170408439228923, 0.0001352276145306051, 0.00012534883931577384,
                    0.00026747097867371744, 0.00018293287323999308, 0.0002076939958810677,
                    0.00020547798894396375, 9.66763199304773e-5, 0.00039829486852362237,
                    0.0004746786048396232, 0.0001105334205256477, 0.00017531703553020248,
                    0.0005073871321777783, 0.00012762119063196027, 9.633485349075413e-5,
                    0.00016957597801172704, 0.0001371970193012587, 0.00014605312859657308,
                    0.00013530088565956222, 0.00015288215818958875, 0.00016328297775516836,
                    0.00016899343091256823, 0.00010648200539248643, 0.00027232117963326764,
                    9.546732243370022e-5, 0.00013733177684545738, 0.00012307788876552762,
                    6.479990286279753e-5, 0.00018454254852570014, 0.00011197129291790964,
                    8.03857835674942e-5, 7.38530559610806e-5, 0.00012762119063196027,
                    0.00015395471447026042, 9.65214640111722e-5, 0.0001283105032572819,
                    0.00011845509539478898, 9.311566661185276e-5, 7.836479192202866e-5,
                    8.855076776433685e-5, 8.374846199795183e-5, 0.00010324095948506487,
                    8.684790076139595e-5, 0.0001654058490697318, 8.257663545248458e-5,
                    9.655040312032232e-5, 8.540396834968491e-5, 6.570896842808087e-5,
                    0.00017416855524404577, 9.436900898874144e-5, 6.872200568250179e-5,
                    4.434141254187418e-5, 9.633485349075413e-5, 9.65214640111722e-5,
                    0.000119328491029678, 9.417097196959674e-5, 7.574601504837566e-5,
                    0.00012386004036466316, 0.00012778179809329082, 0.000125608747770954,
                    0.0001436543835261241, 0.00014306450219792876, 0.0001424039297923303,
                    0.00025454099538862204, 8.589193800046138e-5, 0.0002079902205227442,
                    0.00015696881547621656, 8.612572333013698e-5, 0.00024191077537986372,
                    0.00017792806962690043, 0.00011467241041519043, 0.00015982579342376234,
                    0.00016957597801172704, 0.0001283105032572819, 9.417097196959674e-5,
                    0.00017798467979133597, 9.902167298955152e-5, 0.00012517897745952252,
                    0.00010588875131090237, 0.00012950689551971263, 0.00011504265633552953,
                    0.0001562907391384897, 0.0001029164446713477, 0.00016769653504938235,
                    8.902180143078731e-5, 0.00010977621279825628, 0.00010529078722302967,
                    5.4261649924940195e-5, 0.00022786988669360408, 0.000140228215307278,
                    4.885216808422985e-5, 5.744692343424724e-5, 0.0001371970193012587,
                    0.00011845509539478898, 7.574601504837566e-5, 9.902167298955152e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(; ce = CorSB1(; normalise = normalise, mean_w = w, ve = ve, std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.0001417629563641093, 0.0001965230093640919,
                    0.00019253489820235343, 0.00022481564799635545, 0.00010991277038129118,
                    0.0002904341316971352, 9.331693584681004e-5, 0.0001367164622392419,
                    0.0001233001804466349, 7.966704450924141e-5, 0.00019738084978992957,
                    5.35435482508092e-5, 7.010250640484566e-5, 4.809238383181649e-5,
                    0.00012817538882320365, 0.00014605312859657308, 9.311566661185276e-5,
                    0.00012386004036466316, 0.00012517897745952252, 0.0001417629563641093,
                    0.00020060062616370064, 0.00015437762983613396, 0.0001547901239086932,
                    0.00017100577470413023, 0.00010785617603303555, 0.00026942704794022447,
                    8.942551799013034e-5, 0.0001381685211874238, 0.00011728737437955366,
                    7.468303822845322e-5, 0.0002110828367953653, 0.00010501982085280977,
                    7.972174991147541e-5, 7.891009389257399e-5, 0.0001429065866393038,
                    0.00013530088565956222, 7.836479192202866e-5, 0.00012778179809329082,
                    0.00010588875131090237, 0.0001965230093640919, 0.00015437762983613396,
                    0.00025023180181571545, 0.00021077588088097034, 0.0002368518411277482,
                    0.00010698848428209451, 0.0002794352226469044, 5.826067158533716e-5,
                    0.000146592466594874, 0.00011670272259889115, 7.251013021423783e-5,
                    0.0002254109741673368, 8.892659696192147e-5, 5.097661294223563e-5,
                    5.1136946841348e-5, 9.051159968460476e-5, 0.00015288215818958875,
                    8.855076776433685e-5, 0.000125608747770954, 0.00012950689551971263,
                    0.00019253489820235343, 0.0001547901239086932, 0.00021077588088097034,
                    0.00039197799320071677, 0.00023332498151282797, 0.00011782521037402131,
                    0.0003698556760063338, 8.114243838630746e-5, 0.00015384088104893927,
                    0.00014525883540906896, 5.108459849074695e-5, 0.0002938270830262514,
                    0.0002217391872723519, 8.079178348777915e-5, 0.00015461315970371025,
                    0.000170408439228923, 0.00016328297775516836, 8.374846199795183e-5,
                    0.0001436543835261241, 0.00011504265633552953, 0.00022481564799635545,
                    0.00017100577470413023, 0.0002368518411277482, 0.00023332498151282797,
                    0.00030911461216782526, 0.00012894250894028792, 0.0003076928928029709,
                    0.00011481495824622353, 0.0001523471166577615, 0.00012075104205508548,
                    7.866293093464938e-5, 0.00022113600705725038, 2.185060245343079e-5,
                    7.814122920243395e-5, 0.00011579825223456303, 0.0001352276145306051,
                    0.00016899343091256823, 0.00010324095948506487, 0.00014306450219792876,
                    0.0001562907391384897, 0.00010991277038129118, 0.00010785617603303555,
                    0.00010698848428209451, 0.00011782521037402131, 0.00012894250894028792,
                    0.0001915128908033608, 0.00022776731915996826, 9.636634171799292e-5,
                    0.00016390959717625653, 0.00015602450561486218, 8.482546698913631e-5,
                    0.00022559093783413583, 0.0002440026507934781, 0.00011217163791610825,
                    0.0001440320824858827, 0.00012534883931577384, 0.00010648200539248643,
                    8.684790076139595e-5, 0.0001424039297923303, 0.0001029164446713477,
                    0.0002904341316971352, 0.00026942704794022447, 0.0002794352226469044,
                    0.0003698556760063338, 0.0003076928928029709, 0.00022776731915996826,
                    0.0016063027844326404, 0.00017246297308683536, 0.0002853772775269783,
                    0.00030813102058828147, 0.00012578354942843208, 0.0003594973881859668,
                    0.00035013483863542976, 0.00018626596605150585, 0.0004174740379878913,
                    0.00026747097867371744, 0.00027232117963326764, 0.0001654058490697318,
                    0.00025454099538862204, 0.00016769653504938235, 9.331693584681004e-5,
                    8.942551799013034e-5, 5.826067158533716e-5, 8.114243838630746e-5,
                    0.00011481495824622353, 9.636634171799292e-5, 0.00017246297308683536,
                    0.00017038019135706003, 7.974607221889397e-5, 0.0001033438599775137,
                    7.877319256230218e-5, 0.00014630891490104685, 0.00016951887628600845,
                    5.292793497703961e-5, 4.3418178270273316e-5, 0.00018293287323999308,
                    9.546732243370022e-5, 8.257663545248458e-5, 8.589193800046138e-5,
                    8.902180143078731e-5, 0.0001367164622392419, 0.0001381685211874238,
                    0.000146592466594874, 0.00015384088104893927, 0.0001523471166577615,
                    0.00016390959717625653, 0.0002853772775269783, 7.974607221889397e-5,
                    0.00026904101047426043, 0.00017846899110668908, 7.687031609913374e-5,
                    0.000293113306466808, 0.0002826001463020693, 0.00012319020454406223,
                    0.000197194656706551, 0.0002076939958810677, 0.00013733177684545738,
                    9.655040312032232e-5, 0.0002079902205227442, 0.00010977621279825628,
                    0.0001233001804466349, 0.00011728737437955366, 0.00011670272259889115,
                    0.00014525883540906896, 0.00012075104205508548, 0.00015602450561486218,
                    0.00030813102058828147, 0.0001033438599775137, 0.00017846899110668908,
                    0.00024075963524820054, 7.614228822439095e-5, 0.00028046733869534695,
                    0.0002662404796927306, 0.00011144865611531442, 0.00012454291261083746,
                    0.00020547798894396375, 0.00012307788876552762, 8.540396834968491e-5,
                    0.00015696881547621656, 0.00010529078722302967, 7.966704450924141e-5,
                    7.468303822845322e-5, 7.251013021423783e-5, 5.108459849074695e-5,
                    7.866293093464938e-5, 8.482546698913631e-5, 0.00012578354942843208,
                    7.877319256230218e-5, 7.687031609913374e-5, 7.614228822439095e-5,
                    0.00011254732252706103, 0.00011650991687827651, 9.459781352221501e-5,
                    6.28520424392026e-5, 6.905827126819106e-5, 9.66763199304773e-5,
                    6.479990286279753e-5, 6.570896842808087e-5, 8.612572333013698e-5,
                    5.4261649924940195e-5, 0.00019738084978992957, 0.0002110828367953653,
                    0.0002254109741673368, 0.0002938270830262514, 0.00022113600705725038,
                    0.00022559093783413583, 0.0003594973881859668, 0.00014630891490104685,
                    0.000293113306466808, 0.00028046733869534695, 0.00011650991687827651,
                    0.0007824998303617654, 0.0005809753433959342, 0.0001586415496535629,
                    0.0002900148531822182, 0.00039829486852362237, 0.00018454254852570014,
                    0.00017416855524404577, 0.00024191077537986372, 0.00022786988669360408,
                    5.35435482508092e-5, 0.00010501982085280977, 8.892659696192147e-5,
                    0.0002217391872723519, 2.185060245343079e-5, 0.0002440026507934781,
                    0.00035013483863542976, 0.00016951887628600845, 0.0002826001463020693,
                    0.0002662404796927306, 9.459781352221501e-5, 0.0005809753433959342,
                    0.0020414865940008354, 0.00012453174350447515, 0.00032405063924209084,
                    0.0004746786048396232, 0.00011197129291790964, 9.436900898874144e-5,
                    0.00017792806962690043, 0.000140228215307278, 7.010250640484566e-5,
                    7.972174991147541e-5, 5.097661294223563e-5, 8.079178348777915e-5,
                    7.814122920243395e-5, 0.00011217163791610825, 0.00018626596605150585,
                    5.292793497703961e-5, 0.00012319020454406223, 0.00011144865611531442,
                    6.28520424392026e-5, 0.0001586415496535629, 0.00012453174350447515,
                    0.00013364641145961862, 0.00022086203706559216, 0.0001105334205256477,
                    8.03857835674942e-5, 6.872200568250179e-5, 0.00011467241041519043,
                    4.885216808422985e-5, 4.809238383181649e-5, 7.891009389257399e-5,
                    5.1136946841348e-5, 0.00015461315970371025, 0.00011579825223456303,
                    0.0001440320824858827, 0.0004174740379878913, 4.3418178270273316e-5,
                    0.000197194656706551, 0.00012454291261083746, 6.905827126819106e-5,
                    0.0002900148531822182, 0.00032405063924209084, 0.00022086203706559216,
                    0.0009593985028265281, 0.00017531703553020248, 7.38530559610806e-5,
                    4.434141254187418e-5, 0.00015982579342376234, 5.744692343424724e-5,
                    0.00012817538882320365, 0.0001429065866393038, 9.051159968460476e-5,
                    0.000170408439228923, 0.0001352276145306051, 0.00012534883931577384,
                    0.00026747097867371744, 0.00018293287323999308, 0.0002076939958810677,
                    0.00020547798894396375, 9.66763199304773e-5, 0.00039829486852362237,
                    0.0004746786048396232, 0.0001105334205256477, 0.00017531703553020248,
                    0.0005073871321777783, 0.00012762119063196027, 9.633485349075413e-5,
                    0.00016957597801172704, 0.0001371970193012587, 0.00014605312859657308,
                    0.00013530088565956222, 0.00015288215818958875, 0.00016328297775516836,
                    0.00016899343091256823, 0.00010648200539248643, 0.00027232117963326764,
                    9.546732243370022e-5, 0.00013733177684545738, 0.00012307788876552762,
                    6.479990286279753e-5, 0.00018454254852570014, 0.00011197129291790964,
                    8.03857835674942e-5, 7.38530559610806e-5, 0.00012762119063196027,
                    0.00015395471447026042, 9.65214640111722e-5, 0.0001283105032572819,
                    0.00011845509539478898, 9.311566661185276e-5, 7.836479192202866e-5,
                    8.855076776433685e-5, 8.374846199795183e-5, 0.00010324095948506487,
                    8.684790076139595e-5, 0.0001654058490697318, 8.257663545248458e-5,
                    9.655040312032232e-5, 8.540396834968491e-5, 6.570896842808087e-5,
                    0.00017416855524404577, 9.436900898874144e-5, 6.872200568250179e-5,
                    4.434141254187418e-5, 9.633485349075413e-5, 9.65214640111722e-5,
                    0.000119328491029678, 9.417097196959674e-5, 7.574601504837566e-5,
                    0.00012386004036466316, 0.00012778179809329082, 0.000125608747770954,
                    0.0001436543835261241, 0.00014306450219792876, 0.0001424039297923303,
                    0.00025454099538862204, 8.589193800046138e-5, 0.0002079902205227442,
                    0.00015696881547621656, 8.612572333013698e-5, 0.00024191077537986372,
                    0.00017792806962690043, 0.00011467241041519043, 0.00015982579342376234,
                    0.00016957597801172704, 0.0001283105032572819, 9.417097196959674e-5,
                    0.00017798467979133597, 9.902167298955152e-5, 0.00012517897745952252,
                    0.00010588875131090237, 0.00012950689551971263, 0.00011504265633552953,
                    0.0001562907391384897, 0.0001029164446713477, 0.00016769653504938235,
                    8.902180143078731e-5, 0.00010977621279825628, 0.00010529078722302967,
                    5.4261649924940195e-5, 0.00022786988669360408, 0.000140228215307278,
                    4.885216808422985e-5, 5.744692343424724e-5, 0.0001371970193012587,
                    0.00011845509539478898, 7.574601504837566e-5, 9.902167298955152e-5,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(;
                    ce = CorGerberSB0(; normalise = normalise, mean_w = w, ve = ve,
                                      std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.0001910530604986571, 0.0002122023214575412,
                    0.0002420620403804177, 0.0002411751564510944, 0.00016135851891625692,
                    0.0004294305635579487, 0.00014207698691017726, 0.00019073585746200045,
                    0.00017978014133096697, 0.00011349082646792543, 0.00030835146139832347,
                    0.0001644853123613226, 0.00011320284167452103, 0.00013087335435629988,
                    0.00020507290577825315, 0.00017195955387012426, 0.00013544436010787966,
                    0.00016856534074927208, 0.00015850493778401614, 0.0001910530604986571,
                    0.00020060062616370064, 0.00020110430349856525, 0.00023158351886100296,
                    0.00023124528785101149, 0.00016055829946395178, 0.00042644881171364254,
                    0.00014121451008042475, 0.0002004478308667307, 0.00018298794011891922,
                    0.00011757502890411386, 0.00031474807511798437, 0.00019488990004485005,
                    0.00012189761110456343, 0.00016739525190633873, 0.0002318755983133053,
                    0.00016801578393819898, 0.00012801780745342378, 0.00017254180403276112,
                    0.00015300573094597937, 0.0002122023214575412, 0.00020110430349856525,
                    0.00025023180181571545, 0.0002770485378362801, 0.00025803310744571087,
                    0.00016961540881659364, 0.0004457039517204051, 0.00012290643352254582,
                    0.0002081497849776988, 0.0001834963951089517, 0.00010721965751972253,
                    0.0003384026572626814, 0.0001788346941806031, 0.00010752764055480359,
                    0.0001218369601535662, 0.00018273457283056932, 0.00018015952585217048,
                    0.00013598014471855133, 0.0001753348187877304, 0.00017101696459062595,
                    0.0002420620403804177, 0.00023158351886100296, 0.0002770485378362801,
                    0.00039197799320071677, 0.00030475410571361914, 0.00019815979815198087,
                    0.0006149213857297749, 0.00014661884762917683, 0.0002621958294838224,
                    0.0002314193946118555, 0.00010275712589304275, 0.00045156257543355174,
                    0.0003643529243642499, 0.00014134337789138438, 0.0002785740823113877,
                    0.0002850039359876637, 0.0002146582858344541, 0.00014427869120355096,
                    0.00021777987135757556, 0.00019839994018339783, 0.0002411751564510944,
                    0.00023124528785101149, 0.00025803310744571087, 0.00030475410571361914,
                    0.00030911461216782526, 0.00019065267998917646, 0.0005136844367444188,
                    0.0001623225037571418, 0.0002250463213701043, 0.00020089055190662713,
                    0.0001302204789546221, 0.00036448597371622907, 0.00013062641461257318,
                    0.00013734255246310696, 0.00019599935417984377, 0.00023199300793179078,
                    0.00020599284313622276, 0.0001545790999309875, 0.00020194571320368522,
                    0.0001915896795366737, 0.00016135851891625692, 0.00016055829946395178,
                    0.00016961540881659364, 0.00019815979815198087, 0.00019065267998917646,
                    0.0001915128908033608, 0.0003932920662418927, 0.00014037834087237048,
                    0.00021289390358431772, 0.0001990988483714766, 0.00012512083950914064,
                    0.0003437943789182223, 0.00038454282664142646, 0.00014212417747249645,
                    0.0002555180715189266, 0.00023201628404240798, 0.00015331374534574874,
                    0.00013102147771916134, 0.0001770801560952936, 0.00014599743788026965,
                    0.0004294305635579487, 0.00042644881171364254, 0.0004457039517204051,
                    0.0006149213857297749, 0.0005136844367444188, 0.0003932920662418927,
                    0.0016063027844326404, 0.0002962747943069687, 0.0004953845694257847,
                    0.000477986501622057, 0.00023635104476144877, 0.0006842173741643438,
                    0.0006436758575829034, 0.00032878762930092635, 0.0006958061604832528,
                    0.0004961713881339543, 0.0004005333839223991, 0.00028010646011045773,
                    0.00042037101260633, 0.00029719581540736206, 0.00014207698691017726,
                    0.00014121451008042475, 0.00012290643352254582, 0.00014661884762917683,
                    0.0001623225037571418, 0.00014037834087237048, 0.0002962747943069687,
                    0.00017038019135706003, 0.00014503045386348847, 0.0001603178262698147,
                    0.00011405560066103939, 0.0002606012214349791, 0.0002966269299306914,
                    9.527088181686779e-5, 9.045791387404487e-5, 0.00024455948358343283,
                    0.0001331271285101701, 0.00011862339624969743, 0.0001358849208428323,
                    0.00013380532911153164, 0.00019073585746200045, 0.0002004478308667307,
                    0.0002081497849776988, 0.0002621958294838224, 0.0002250463213701043,
                    0.00021289390358431772, 0.0004953845694257847, 0.00014503045386348847,
                    0.00026904101047426043, 0.00024060573948750968, 0.00012811797803314597,
                    0.0004347481082867094, 0.0004722049380478785, 0.00016936664924538353,
                    0.0003354323484268802, 0.0002976194882792848, 0.00018199720314265242,
                    0.0001459509351229501, 0.00021268353927966972, 0.00017001267606918058,
                    0.00017978014133096697, 0.00018298794011891922, 0.0001834963951089517,
                    0.0002314193946118555, 0.00020089055190662713, 0.0001990988483714766,
                    0.000477986501622057, 0.0001603178262698147, 0.00024060573948750968,
                    0.00024075963524820054, 0.00012422054929315377, 0.00038797440453863753,
                    0.00047125828318021014, 0.00015127387015219352, 0.00025617108726380667,
                    0.0002961178084178705, 0.0001729869556336571, 0.00014079595495615778,
                    0.00019459974746092703, 0.00016117697721580656, 0.00011349082646792543,
                    0.00011757502890411386, 0.00010721965751972253, 0.00010275712589304275,
                    0.0001302204789546221, 0.00012512083950914064, 0.00023635104476144877,
                    0.00011405560066103939, 0.00012811797803314597, 0.00012422054929315377,
                    0.00011254732252706103, 0.00020357269590053062, 0.00018396212135542603,
                    9.782611839246189e-5, 0.00013499183020073945, 0.00015965433836378088,
                    0.00010385034408329573, 9.783145527980975e-5, 0.00011906118822137501,
                    9.387925588174353e-5, 0.00030835146139832347, 0.00031474807511798437,
                    0.0003384026572626814, 0.00045156257543355174, 0.00036448597371622907,
                    0.0003437943789182223, 0.0006842173741643438, 0.0002606012214349791,
                    0.0004347481082867094, 0.00038797440453863753, 0.00020357269590053062,
                    0.0007824998303617654, 0.0009205059713353445, 0.0002559346276121239,
                    0.000495419068519461, 0.000546752658225701, 0.0002959891675786782,
                    0.0002446049043885933, 0.00034430195217441476, 0.00030449502751546447,
                    0.0001644853123613226, 0.00019488990004485005, 0.0001788346941806031,
                    0.0003643529243642499, 0.00013062641461257318, 0.00038454282664142646,
                    0.0006436758575829034, 0.0002966269299306914, 0.0004722049380478785,
                    0.00047125828318021014, 0.00018396212135542603, 0.0009205059713353445,
                    0.0020414865940008354, 0.00025783345875375765, 0.0006677198364922412,
                    0.0007622397657284015, 0.00022549134045599095, 0.000193973184350942,
                    0.0003330875436243117, 0.0002742610018120931, 0.00011320284167452103,
                    0.00012189761110456343, 0.00010752764055480359, 0.00014134337789138438,
                    0.00013734255246310696, 0.00014212417747249645, 0.00032878762930092635,
                    9.527088181686779e-5, 0.00016936664924538353, 0.00015127387015219352,
                    9.782611839246189e-5, 0.0002559346276121239, 0.00025783345875375765,
                    0.00013364641145961862, 0.0002909844613922176, 0.00018623623497908277,
                    0.00011159939733046563, 9.756059438378623e-5, 0.00014103550285655714,
                    9.068938695706269e-5, 0.00013087335435629988, 0.00016739525190633873,
                    0.0001218369601535662, 0.0002785740823113877, 0.00019599935417984377,
                    0.0002555180715189266, 0.0006958061604832528, 9.045791387404487e-5,
                    0.0003354323484268802, 0.00025617108726380667, 0.00013499183020073945,
                    0.000495419068519461, 0.0006677198364922412, 0.0002909844613922176,
                    0.0009593985028265281, 0.0003487244338201354, 0.000155166701402572,
                    0.00010562856881877236, 0.00026000953560348453, 0.00010593455051694614,
                    0.00020507290577825315, 0.0002318755983133053, 0.00018273457283056932,
                    0.0002850039359876637, 0.00023199300793179078, 0.00023201628404240798,
                    0.0004961713881339543, 0.00024455948358343283, 0.0002976194882792848,
                    0.0002961178084178705, 0.00015965433836378088, 0.000546752658225701,
                    0.0007622397657284015, 0.00018623623497908277, 0.0003487244338201354,
                    0.0005073871321777783, 0.00020724730089531577, 0.00016775311250111149,
                    0.0002440299569942427, 0.00021286395715858732, 0.00017195955387012426,
                    0.00016801578393819898, 0.00018015952585217048, 0.0002146582858344541,
                    0.00020599284313622276, 0.00015331374534574874, 0.0004005333839223991,
                    0.0001331271285101701, 0.00018199720314265242, 0.0001729869556336571,
                    0.00010385034408329573, 0.0002959891675786782, 0.00022549134045599095,
                    0.00011159939733046563, 0.000155166701402572, 0.00020724730089531577,
                    0.00015395471447026042, 0.00012361398984516293, 0.00015719930515406734,
                    0.00014168365473252563, 0.00013544436010787966, 0.00012801780745342378,
                    0.00013598014471855133, 0.00014427869120355096, 0.0001545790999309875,
                    0.00013102147771916134, 0.00028010646011045773, 0.00011862339624969743,
                    0.0001459509351229501, 0.00014079595495615778, 9.783145527980975e-5,
                    0.0002446049043885933, 0.000193973184350942, 9.756059438378623e-5,
                    0.00010562856881877236, 0.00016775311250111149, 0.00012361398984516293,
                    0.000119328491029678, 0.00012834994696635916, 0.00011382591728453307,
                    0.00016856534074927208, 0.00017254180403276112, 0.0001753348187877304,
                    0.00021777987135757556, 0.00020194571320368522, 0.0001770801560952936,
                    0.00042037101260633, 0.0001358849208428323, 0.00021268353927966972,
                    0.00019459974746092703, 0.00011906118822137501, 0.00034430195217441476,
                    0.0003330875436243117, 0.00014103550285655714, 0.00026000953560348453,
                    0.0002440299569942427, 0.00015719930515406734, 0.00012834994696635916,
                    0.00017798467979133597, 0.00014359016130443476, 0.00015850493778401614,
                    0.00015300573094597937, 0.00017101696459062595, 0.00019839994018339783,
                    0.0001915896795366737, 0.00014599743788026965, 0.00029719581540736206,
                    0.00013380532911153164, 0.00017001267606918058, 0.00016117697721580656,
                    9.387925588174353e-5, 0.00030449502751546447, 0.0002742610018120931,
                    9.068938695706269e-5, 0.00010593455051694614, 0.00021286395715858732,
                    0.00014168365473252563, 0.00011382591728453307, 0.00014359016130443476,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    c1 = PortCovCor(;
                    ce = CorGerberSB1(; normalise = normalise, mean_w = w, ve = ve,
                                      std_w = w))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1)
    covt = reshape([0.00019864619425184141, 0.0001910530604986571, 0.0002122023214575412,
                    0.0002420620403804177, 0.0002411751564510944, 0.00016135851891625692,
                    0.0004294305635579487, 0.00014207698691017726, 0.00019073585746200045,
                    0.00017978014133096697, 0.00011349082646792543, 0.00030835146139832347,
                    0.0001644853123613226, 0.00011320284167452103, 0.00013087335435629988,
                    0.00020507290577825315, 0.00017195955387012426, 0.00013544436010787966,
                    0.00016856534074927208, 0.00015850493778401614, 0.0001910530604986571,
                    0.00020060062616370064, 0.00020110430349856525, 0.00023158351886100296,
                    0.00023124528785101149, 0.00016055829946395178, 0.00042644881171364254,
                    0.00014121451008042475, 0.0002004478308667307, 0.00018298794011891922,
                    0.00011757502890411386, 0.00031474807511798437, 0.00019488990004485005,
                    0.00012189761110456343, 0.00016739525190633873, 0.0002318755983133053,
                    0.00016801578393819898, 0.00012801780745342378, 0.00017254180403276112,
                    0.00015300573094597937, 0.0002122023214575412, 0.00020110430349856525,
                    0.00025023180181571545, 0.0002770485378362801, 0.00025803310744571087,
                    0.00016961540881659364, 0.0004457039517204051, 0.00012290643352254582,
                    0.0002081497849776988, 0.0001834963951089517, 0.00010721965751972253,
                    0.0003384026572626814, 0.0001788346941806031, 0.00010752764055480359,
                    0.0001218369601535662, 0.00018273457283056932, 0.00018015952585217048,
                    0.00013598014471855133, 0.0001753348187877304, 0.00017101696459062595,
                    0.0002420620403804177, 0.00023158351886100296, 0.0002770485378362801,
                    0.00039197799320071677, 0.00030475410571361914, 0.00019815979815198087,
                    0.0006149213857297749, 0.00014661884762917683, 0.0002621958294838224,
                    0.0002314193946118555, 0.00010275712589304275, 0.00045156257543355174,
                    0.0003643529243642499, 0.00014134337789138438, 0.0002785740823113877,
                    0.0002850039359876637, 0.0002146582858344541, 0.00014427869120355096,
                    0.00021777987135757556, 0.00019839994018339783, 0.0002411751564510944,
                    0.00023124528785101149, 0.00025803310744571087, 0.00030475410571361914,
                    0.00030911461216782526, 0.00019065267998917646, 0.0005136844367444188,
                    0.0001623225037571418, 0.0002250463213701043, 0.00020089055190662713,
                    0.0001302204789546221, 0.00036448597371622907, 0.00013062641461257318,
                    0.00013734255246310696, 0.00019599935417984377, 0.00023199300793179078,
                    0.00020599284313622276, 0.0001545790999309875, 0.00020194571320368522,
                    0.0001915896795366737, 0.00016135851891625692, 0.00016055829946395178,
                    0.00016961540881659364, 0.00019815979815198087, 0.00019065267998917646,
                    0.0001915128908033608, 0.0003932920662418927, 0.00014037834087237048,
                    0.00021289390358431772, 0.0001990988483714766, 0.00012512083950914064,
                    0.0003437943789182223, 0.00038454282664142646, 0.00014212417747249645,
                    0.0002555180715189266, 0.00023201628404240798, 0.00015331374534574874,
                    0.00013102147771916134, 0.0001770801560952936, 0.00014599743788026965,
                    0.0004294305635579487, 0.00042644881171364254, 0.0004457039517204051,
                    0.0006149213857297749, 0.0005136844367444188, 0.0003932920662418927,
                    0.0016063027844326404, 0.0002962747943069687, 0.0004953845694257847,
                    0.000477986501622057, 0.00023635104476144877, 0.0006842173741643438,
                    0.0006436758575829034, 0.00032878762930092635, 0.0006958061604832528,
                    0.0004961713881339543, 0.0004005333839223991, 0.00028010646011045773,
                    0.00042037101260633, 0.00029719581540736206, 0.00014207698691017726,
                    0.00014121451008042475, 0.00012290643352254582, 0.00014661884762917683,
                    0.0001623225037571418, 0.00014037834087237048, 0.0002962747943069687,
                    0.00017038019135706003, 0.00014503045386348847, 0.0001603178262698147,
                    0.00011405560066103939, 0.0002606012214349791, 0.0002966269299306914,
                    9.527088181686779e-5, 9.045791387404487e-5, 0.00024455948358343283,
                    0.0001331271285101701, 0.00011862339624969743, 0.0001358849208428323,
                    0.00013380532911153164, 0.00019073585746200045, 0.0002004478308667307,
                    0.0002081497849776988, 0.0002621958294838224, 0.0002250463213701043,
                    0.00021289390358431772, 0.0004953845694257847, 0.00014503045386348847,
                    0.00026904101047426043, 0.00024060573948750968, 0.00012811797803314597,
                    0.0004347481082867094, 0.0004722049380478785, 0.00016936664924538353,
                    0.0003354323484268802, 0.0002976194882792848, 0.00018199720314265242,
                    0.0001459509351229501, 0.00021268353927966972, 0.00017001267606918058,
                    0.00017978014133096697, 0.00018298794011891922, 0.0001834963951089517,
                    0.0002314193946118555, 0.00020089055190662713, 0.0001990988483714766,
                    0.000477986501622057, 0.0001603178262698147, 0.00024060573948750968,
                    0.00024075963524820054, 0.00012422054929315377, 0.00038797440453863753,
                    0.00047125828318021014, 0.00015127387015219352, 0.00025617108726380667,
                    0.0002961178084178705, 0.0001729869556336571, 0.00014079595495615778,
                    0.00019459974746092703, 0.00016117697721580656, 0.00011349082646792543,
                    0.00011757502890411386, 0.00010721965751972253, 0.00010275712589304275,
                    0.0001302204789546221, 0.00012512083950914064, 0.00023635104476144877,
                    0.00011405560066103939, 0.00012811797803314597, 0.00012422054929315377,
                    0.00011254732252706103, 0.00020357269590053062, 0.00018396212135542603,
                    9.782611839246189e-5, 0.00013499183020073945, 0.00015965433836378088,
                    0.00010385034408329573, 9.783145527980975e-5, 0.00011906118822137501,
                    9.387925588174353e-5, 0.00030835146139832347, 0.00031474807511798437,
                    0.0003384026572626814, 0.00045156257543355174, 0.00036448597371622907,
                    0.0003437943789182223, 0.0006842173741643438, 0.0002606012214349791,
                    0.0004347481082867094, 0.00038797440453863753, 0.00020357269590053062,
                    0.0007824998303617654, 0.0009205059713353445, 0.0002559346276121239,
                    0.000495419068519461, 0.000546752658225701, 0.0002959891675786782,
                    0.0002446049043885933, 0.00034430195217441476, 0.00030449502751546447,
                    0.0001644853123613226, 0.00019488990004485005, 0.0001788346941806031,
                    0.0003643529243642499, 0.00013062641461257318, 0.00038454282664142646,
                    0.0006436758575829034, 0.0002966269299306914, 0.0004722049380478785,
                    0.00047125828318021014, 0.00018396212135542603, 0.0009205059713353445,
                    0.0020414865940008354, 0.00025783345875375765, 0.0006677198364922412,
                    0.0007622397657284015, 0.00022549134045599095, 0.000193973184350942,
                    0.0003330875436243117, 0.0002742610018120931, 0.00011320284167452103,
                    0.00012189761110456343, 0.00010752764055480359, 0.00014134337789138438,
                    0.00013734255246310696, 0.00014212417747249645, 0.00032878762930092635,
                    9.527088181686779e-5, 0.00016936664924538353, 0.00015127387015219352,
                    9.782611839246189e-5, 0.0002559346276121239, 0.00025783345875375765,
                    0.00013364641145961862, 0.0002909844613922176, 0.00018623623497908277,
                    0.00011159939733046563, 9.756059438378623e-5, 0.00014103550285655714,
                    9.068938695706269e-5, 0.00013087335435629988, 0.00016739525190633873,
                    0.0001218369601535662, 0.0002785740823113877, 0.00019599935417984377,
                    0.0002555180715189266, 0.0006958061604832528, 9.045791387404487e-5,
                    0.0003354323484268802, 0.00025617108726380667, 0.00013499183020073945,
                    0.000495419068519461, 0.0006677198364922412, 0.0002909844613922176,
                    0.0009593985028265281, 0.0003487244338201354, 0.000155166701402572,
                    0.00010562856881877236, 0.00026000953560348453, 0.00010593455051694614,
                    0.00020507290577825315, 0.0002318755983133053, 0.00018273457283056932,
                    0.0002850039359876637, 0.00023199300793179078, 0.00023201628404240798,
                    0.0004961713881339543, 0.00024455948358343283, 0.0002976194882792848,
                    0.0002961178084178705, 0.00015965433836378088, 0.000546752658225701,
                    0.0007622397657284015, 0.00018623623497908277, 0.0003487244338201354,
                    0.0005073871321777783, 0.00020724730089531577, 0.00016775311250111149,
                    0.0002440299569942427, 0.00021286395715858732, 0.00017195955387012426,
                    0.00016801578393819898, 0.00018015952585217048, 0.0002146582858344541,
                    0.00020599284313622276, 0.00015331374534574874, 0.0004005333839223991,
                    0.0001331271285101701, 0.00018199720314265242, 0.0001729869556336571,
                    0.00010385034408329573, 0.0002959891675786782, 0.00022549134045599095,
                    0.00011159939733046563, 0.000155166701402572, 0.00020724730089531577,
                    0.00015395471447026042, 0.00012361398984516293, 0.00015719930515406734,
                    0.00014168365473252563, 0.00013544436010787966, 0.00012801780745342378,
                    0.00013598014471855133, 0.00014427869120355096, 0.0001545790999309875,
                    0.00013102147771916134, 0.00028010646011045773, 0.00011862339624969743,
                    0.0001459509351229501, 0.00014079595495615778, 9.783145527980975e-5,
                    0.0002446049043885933, 0.000193973184350942, 9.756059438378623e-5,
                    0.00010562856881877236, 0.00016775311250111149, 0.00012361398984516293,
                    0.000119328491029678, 0.00012834994696635916, 0.00011382591728453307,
                    0.00016856534074927208, 0.00017254180403276112, 0.0001753348187877304,
                    0.00021777987135757556, 0.00020194571320368522, 0.0001770801560952936,
                    0.00042037101260633, 0.0001358849208428323, 0.00021268353927966972,
                    0.00019459974746092703, 0.00011906118822137501, 0.00034430195217441476,
                    0.0003330875436243117, 0.00014103550285655714, 0.00026000953560348453,
                    0.0002440299569942427, 0.00015719930515406734, 0.00012834994696635916,
                    0.00017798467979133597, 0.00014359016130443476, 0.00015850493778401614,
                    0.00015300573094597937, 0.00017101696459062595, 0.00019839994018339783,
                    0.0001915896795366737, 0.00014599743788026965, 0.00029719581540736206,
                    0.00013380532911153164, 0.00017001267606918058, 0.00016117697721580656,
                    9.387925588174353e-5, 0.00030449502751546447, 0.0002742610018120931,
                    9.068938695706269e-5, 0.00010593455051694614, 0.00021286395715858732,
                    0.00014168365473252563, 0.00011382591728453307, 0.00014359016130443476,
                    0.0001504967210740102], (20, 20))
    @test isapprox(portfolio.cov, covt)

    portfolio = Portfolio(; prices = prices)

    c1 = PortCovCor(; ce = CorMutualInfo())
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1, cor_type = c1)
    @test isapprox(cov2cor(portfolio.cov), portfolio.cor)

    c1 = PortCovCor(; ce = CorLTD())
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1, cor_type = c1)
    @test isapprox(cov2cor(portfolio.cov), portfolio.cor)
end

@testset "Shrunken Cov and Cor Unweighted" begin
    portfolio = Portfolio(; prices = prices)
    c1 = PortCovCor(; ce = CovFull(; ce = AnalyticalNonlinearShrinkage()))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1, cor_type = c1)
    covt = reshape([0.00021220452773731868, 9.720753544484786e-5, 0.00013997545949848914,
                    0.0001169268959904978, 0.00015744832592123553, 6.129768102476998e-5,
                    8.193980246950358e-5, 4.1617054642318785e-5, 8.96343936634366e-5,
                    7.085130750125325e-5, 4.0028773941249504e-5, 0.00010282615389146573,
                    3.5061202428480264e-5, 5.286040513979295e-5, 2.2077229705627697e-5,
                    4.9302123727525766e-5, 9.737343765711497e-5, 5.7829664830276705e-5,
                    7.802984634702094e-5, 8.269123896101322e-5, 9.720753544484786e-5,
                    0.00021272037955248328, 0.00010767979743434735, 9.337689161408247e-5,
                    0.00010738771651156175, 5.7491517516342865e-5, 0.0001293738967189528,
                    4.4776993578710497e-5, 9.367350743069854e-5, 7.562774523376787e-5,
                    4.124926124119486e-5, 9.14801669665215e-5, 7.025885679086854e-5,
                    5.807421686745851e-5, 5.2022839512009786e-5, 7.361910467771506e-5,
                    9.142980086521271e-5, 5.059696033202489e-5, 8.503921257659654e-5,
                    7.128269644023235e-5, 0.00013997545949848914, 0.00010767979743434735,
                    0.00025854624304401174, 0.00011806525769382235, 0.0001531955816512729,
                    6.618520411901245e-5, 0.00011644761615565733, 3.887455854705103e-5,
                    9.340089194295937e-5, 7.52588342788745e-5, 3.861128952856251e-5,
                    0.00013788109509346982, 5.732658374074827e-5, 5.1671053584188844e-5,
                    4.080589969543096e-5, 5.5447513208905026e-5, 0.00010076578866139493,
                    5.4111638081624834e-5, 8.04155014024116e-5, 8.77366060888299e-5,
                    0.0001169268959904978, 9.337689161408247e-5, 0.00011806525769382235,
                    0.00040287323573480347, 0.0001307039376627393, 6.427520586174728e-5,
                    0.00019915550850745282, 3.369450211649492e-5, 9.695185643980224e-5,
                    8.074033019625103e-5, 2.793555075930166e-5, 0.00011170678399060517,
                    9.871525580305679e-5, 5.537476260586081e-5, 9.387251766432063e-5,
                    7.673085642865588e-5, 9.967467491019703e-5, 5.160639530888748e-5,
                    8.361219216581586e-5, 6.821312698403149e-5, 0.00015744832592123553,
                    0.00010738771651156175, 0.0001531955816512729, 0.0001307039376627393,
                    0.00033179853410144125, 5.115996965132674e-5, 0.0001202309012663359,
                    3.7008399397084546e-5, 8.587894183062002e-5, 6.471498088670144e-5,
                    3.7107247467590306e-5, 0.00011974761736902723, 1.8617430223774752e-5,
                    5.050643748290056e-5, 7.524490830931296e-5, 5.616041992056509e-5,
                    0.0001038300369296303, 4.6297053113202835e-5, 7.356237936976104e-5,
                    9.929491722136169e-5, 6.129768102476998e-5, 5.7491517516342865e-5,
                    6.618520411901245e-5, 6.427520586174728e-5, 5.115996965132674e-5,
                    0.0001813191294918142, 9.36124090190433e-5, 3.723677225618142e-5,
                    9.929758142538044e-5, 8.57675050051969e-5, 5.1576805459966e-5,
                    0.00010590343817075594, 0.0001137520524066665, 6.902332277974822e-5,
                    9.937798893233115e-5, 4.695732113784261e-5, 6.4750269108014e-5,
                    5.5513930359269884e-5, 9.087708668777154e-5, 6.046995343981899e-5,
                    8.193980246950358e-5, 0.0001293738967189528, 0.00011644761615565733,
                    0.00019915550850745282, 0.0001202309012663359, 9.36124090190433e-5,
                    0.001639062029641279, 4.4686263953343495e-5, 0.0001662113094222391,
                    0.00013726719170547663, 6.387018575384846e-5, 0.00010408082599191342,
                    0.0001351151087976095, 8.881792176577753e-5, 0.00023735633253480894,
                    0.00011852609044937817, 0.00012962795788792525, 7.355993245659252e-5,
                    0.00012488696180257972, 5.3161609722500226e-5, 4.1617054642318785e-5,
                    4.4776993578710497e-5, 3.887455854705103e-5, 3.369450211649492e-5,
                    3.7008399397084546e-5, 3.723677225618142e-5, 4.4686263953343495e-5,
                    0.00016347076473854376, 4.259280565890393e-5, 4.955207577062591e-5,
                    4.0359190561193335e-5, 6.3712201276703e-5, 0.0001107020192289614,
                    3.394189156620799e-5, 1.9564025156243382e-5, 5.747474071837917e-5,
                    4.575302091275726e-5, 4.3259900566035604e-5, 4.762981140438622e-5,
                    4.7912026990676504e-5, 8.96343936634366e-5, 9.367350743069854e-5,
                    9.340089194295937e-5, 9.695185643980224e-5, 8.587894183062002e-5,
                    9.929758142538044e-5, 0.0001662113094222391, 4.259280565890393e-5,
                    0.00027547483019151053, 0.0001258738821427569, 4.725699250116263e-5,
                    0.00014065608097036154, 0.00014617430778457924, 9.069378341048216e-5,
                    0.00013336627839542861, 0.00011742517852127088, 0.00010868567392520397,
                    7.742998005181547e-5, 0.0001999787952892537, 7.755594677401873e-5,
                    7.085130750125325e-5, 7.562774523376787e-5, 7.52588342788745e-5,
                    8.074033019625103e-5, 6.471498088670144e-5, 8.57675050051969e-5,
                    0.00013726719170547663, 4.955207577062591e-5, 0.0001258738821427569,
                    0.00024233143488135693, 4.712607110108594e-5, 0.00012721935243381944,
                    0.00014389539526766694, 6.544584711774788e-5, 0.00010226896379743992,
                    9.930792923798458e-5, 7.672822758210388e-5, 5.993151293716665e-5,
                    0.00010810954472151735, 6.897383992551304e-5, 4.0028773941249504e-5,
                    4.124926124119486e-5, 3.861128952856251e-5, 2.793555075930166e-5,
                    3.7107247467590306e-5, 5.1576805459966e-5, 6.387018575384846e-5,
                    4.0359190561193335e-5, 4.725699250116263e-5, 4.712607110108594e-5,
                    0.00010990150618021834, 4.8632443342109685e-5, 5.813596948770104e-5,
                    4.6509832040738064e-5, 6.191052271389858e-5, 3.9873465861076694e-5,
                    4.205853837845296e-5, 3.6643824705006415e-5, 5.1696894359262214e-5,
                    3.557749664776791e-5, 0.00010282615389146573, 9.14801669665215e-5,
                    0.00013788109509346982, 0.00011170678399060517, 0.00011974761736902723,
                    0.00010590343817075594, 0.00010408082599191342, 6.3712201276703e-5,
                    0.00014065608097036154, 0.00012721935243381944, 4.8632443342109685e-5,
                    0.0007001293602492102, 0.00022807126961007455, 7.502278836515323e-5,
                    0.00012700347695081455, 0.00013536542928565276, 9.302789048744815e-5,
                    6.799287300362591e-5, 0.00012096069315506866, 0.00010767783212136054,
                    3.5061202428480264e-5, 7.025885679086854e-5, 5.732658374074827e-5,
                    9.871525580305679e-5, 1.8617430223774752e-5, 0.0001137520524066665,
                    0.0001351151087976095, 0.0001107020192289614, 0.00014617430778457924,
                    0.00014389539526766694, 5.813596948770104e-5, 0.00022807126961007455,
                    0.0019319376279814723, 7.706206059280238e-5, 0.00021777135318044207,
                    0.00023102257061919108, 5.850208160270112e-5, 5.503729831406785e-5,
                    9.85595026827703e-5, 9.359095604497874e-5, 5.286040513979295e-5,
                    5.807421686745851e-5, 5.1671053584188844e-5, 5.537476260586081e-5,
                    5.050643748290056e-5, 6.902332277974822e-5, 8.881792176577753e-5,
                    3.394189156620799e-5, 9.069378341048216e-5, 6.544584711774788e-5,
                    4.6509832040738064e-5, 7.502278836515323e-5, 7.706206059280238e-5,
                    0.00014724606195376267, 0.00015388152258146494, 4.665816973361869e-5,
                    6.28726061574891e-5, 5.0147358432513704e-5, 8.717490526384529e-5,
                    3.995454911591493e-5, 2.2077229705627697e-5, 5.2022839512009786e-5,
                    4.080589969543096e-5, 9.387251766432063e-5, 7.524490830931296e-5,
                    9.937798893233115e-5, 0.00023735633253480894, 1.9564025156243382e-5,
                    0.00013336627839542861, 0.00010226896379743992, 6.191052271389858e-5,
                    0.00012700347695081455, 0.00021777135318044207, 0.00015388152258146494,
                    0.0010007858843878083, 0.00011243079611637621, 6.514358575185254e-5,
                    3.641253200575091e-5, 0.00011467940864824689, 3.325501958385645e-5,
                    4.9302123727525766e-5, 7.361910467771506e-5, 5.5447513208905026e-5,
                    7.673085642865588e-5, 5.616041992056509e-5, 4.695732113784261e-5,
                    0.00011852609044937817, 5.747474071837917e-5, 0.00011742517852127088,
                    9.930792923798458e-5, 3.9873465861076694e-5, 0.00013536542928565276,
                    0.00023102257061919108, 4.665816973361869e-5, 0.00011243079611637621,
                    0.0005082415475682544, 7.409749752896972e-5, 4.884876556534134e-5,
                    9.169839188882468e-5, 7.579156210882258e-5, 9.737343765711497e-5,
                    9.142980086521271e-5, 0.00010076578866139493, 9.967467491019703e-5,
                    0.0001038300369296303, 6.4750269108014e-5, 0.00012962795788792525,
                    4.575302091275726e-5, 0.00010868567392520397, 7.672822758210388e-5,
                    4.205853837845296e-5, 9.302789048744815e-5, 5.850208160270112e-5,
                    6.28726061574891e-5, 6.514358575185254e-5, 7.409749752896972e-5,
                    0.00016659380476233396, 5.988948724028629e-5, 9.745074286220319e-5,
                    7.560614697601135e-5, 5.7829664830276705e-5, 5.059696033202489e-5,
                    5.4111638081624834e-5, 5.160639530888748e-5, 4.6297053113202835e-5,
                    5.5513930359269884e-5, 7.355993245659252e-5, 4.3259900566035604e-5,
                    7.742998005181547e-5, 5.993151293716665e-5, 3.6643824705006415e-5,
                    6.799287300362591e-5, 5.503729831406785e-5, 5.0147358432513704e-5,
                    3.641253200575091e-5, 4.884876556534134e-5, 5.988948724028629e-5,
                    0.0001257849797685846, 7.208609093716458e-5, 4.429813817803967e-5,
                    7.802984634702094e-5, 8.503921257659654e-5, 8.04155014024116e-5,
                    8.361219216581586e-5, 7.356237936976104e-5, 9.087708668777154e-5,
                    0.00012488696180257972, 4.762981140438622e-5, 0.0001999787952892537,
                    0.00010810954472151735, 5.1696894359262214e-5, 0.00012096069315506866,
                    9.85595026827703e-5, 8.717490526384529e-5, 0.00011467940864824689,
                    9.169839188882468e-5, 9.745074286220319e-5, 7.208609093716458e-5,
                    0.00018516583615149366, 7.049586715651903e-5, 8.269123896101322e-5,
                    7.128269644023235e-5, 8.77366060888299e-5, 6.821312698403149e-5,
                    9.929491722136169e-5, 6.046995343981899e-5, 5.3161609722500226e-5,
                    4.7912026990676504e-5, 7.755594677401873e-5, 6.897383992551304e-5,
                    3.557749664776791e-5, 0.00010767783212136054, 9.359095604497874e-5,
                    3.995454911591493e-5, 3.325501958385645e-5, 7.579156210882258e-5,
                    7.560614697601135e-5, 4.429813817803967e-5, 7.049586715651903e-5,
                    0.00016046807743037806], (20, 20))
    cort = reshape([1.0, 0.45752840281833124, 0.5975929469512664, 0.39990136767830886,
                    0.5933671412470112, 0.3124963212719126, 0.13893763270422677,
                    0.2234467130695842, 0.3707288636361882, 0.3124393094386776,
                    0.262115765262957, 0.26677008277621106, 0.05475867520386929,
                    0.2990414019517496, 0.04790674541629446, 0.15012506963526046,
                    0.5178855052732115, 0.35396389064607703, 0.39364342184974177,
                    0.4481133178825172, 0.45752840281833124, 1.0, 0.45915631799047374,
                    0.3189705996410918, 0.40421537309921296, 0.2927368598618992,
                    0.219101027789969, 0.24012110542190246, 0.38696462959782935,
                    0.3330977705983282, 0.26978003277498847, 0.23704633978330036,
                    0.10959733117862795, 0.32813833350981536, 0.1127506146206671,
                    0.22389835328690239, 0.4856840046196488, 0.3093182077794744,
                    0.42848364545035134, 0.3858204518234596, 0.5975929469512664,
                    0.45915631799047374, 1.0, 0.36582113709277875, 0.5230460090853346,
                    0.3056820830885531, 0.17888082610636993, 0.18909337242783641,
                    0.3499781619020066, 0.3006654285404838, 0.22905689453067613,
                    0.3240756965618236, 0.08111298712783906, 0.26482339997977483,
                    0.08022011059766367, 0.15296000002004403, 0.48552832284456904,
                    0.30005935638605746, 0.36752782812519164, 0.43074216862040016,
                    0.39990136767830886, 0.3189705996410918, 0.36582113709277875, 1.0,
                    0.35749274431785194, 0.23781402054841194, 0.24508143812507627,
                    0.13129699544453033, 0.29102544303713906, 0.25840531127375227,
                    0.13276121170081306, 0.21033240865384858, 0.11189315414482458,
                    0.22735568847212484, 0.1478371807183841, 0.16957067732406905,
                    0.38474341551707414, 0.22924766683437459, 0.3061293514190903,
                    0.26828069678965294, 0.5933671412470112, 0.40421537309921296,
                    0.5230460090853346, 0.35749274431785194, 1.0, 0.20857931364127444,
                    0.1630351233442463, 0.15890699818691295, 0.2840589589604817,
                    0.22822473887065917, 0.1943209776903107, 0.24845085995906963,
                    0.023253372715177138, 0.22850076610156828, 0.1305777858616531,
                    0.13675966634703843, 0.4416277487080384, 0.22662182086578325,
                    0.2967823751815248, 0.4303238947013493, 0.3124963212719126,
                    0.2927368598618992, 0.3056820830885531, 0.23781402054841194,
                    0.20857931364127444, 1.0, 0.17171724575826564, 0.2162868764617346,
                    0.44429957303798095, 0.4091627481982095, 0.36536824963983394,
                    0.2972344215281678, 0.19219446575661342, 0.42242752182195764,
                    0.23329090377893266, 0.15468436466848257, 0.37255495298666697,
                    0.36759176326108367, 0.49596628300767126, 0.3545059239681433,
                    0.13893763270422677, 0.219101027789969, 0.17888082610636993,
                    0.24508143812507627, 0.1630351233442463, 0.17171724575826564, 1.0,
                    0.08632891935264778, 0.24735569516948996, 0.21780316028718547,
                    0.15048688833159923, 0.09715919104482719, 0.07592934786449333,
                    0.18079277378608696, 0.1853243743151929, 0.1298617294646921,
                    0.24806846600886517, 0.16200530453917195, 0.22669345173967292,
                    0.10365878243249618, 0.2234467130695842, 0.24012110542190246,
                    0.18909337242783641, 0.13129699544453033, 0.15890699818691295,
                    0.2162868764617346, 0.08632891935264778, 1.0, 0.20071287858256673,
                    0.24896421498788954, 0.30110681018863744, 0.18832735981058976,
                    0.19698762530943995, 0.21877321560107052, 0.048369052469982396,
                    0.19939850195861072, 0.27724920127094144, 0.30168316633325726,
                    0.27376529012234, 0.2958217983537089, 0.3707288636361882,
                    0.38696462959782935, 0.3499781619020066, 0.29102544303713906,
                    0.2840589589604817, 0.44429957303798095, 0.24735569516948996,
                    0.20071287858256673, 1.0, 0.4871803776964893, 0.27159595335120673,
                    0.3202789569808124, 0.20037038527706186, 0.4503132368665542,
                    0.2540004492017467, 0.3138232998761884, 0.5073432856402429,
                    0.4159621298319911, 0.8854469686128625, 0.36887550513170075,
                    0.3124393094386776, 0.3330977705983282, 0.3006654285404838,
                    0.25840531127375227, 0.22822473887065917, 0.4091627481982095,
                    0.21780316028718547, 0.24896421498788954, 0.4871803776964893, 1.0,
                    0.2887716371481902, 0.3088582159501017, 0.2103030004629519,
                    0.3464618119042514, 0.2076674323033683, 0.2829723274043363,
                    0.3818746818238709, 0.3432700966573608, 0.5103624706563592,
                    0.34977213116748684, 0.262115765262957, 0.26978003277498847,
                    0.22905689453067613, 0.13276121170081306, 0.1943209776903107,
                    0.36536824963983394, 0.15048688833159923, 0.30110681018863744,
                    0.27159595335120673, 0.2887716371481902, 1.0, 0.17532147756382388,
                    0.1261672236664096, 0.36561255824905703, 0.18667753733333828,
                    0.16871243060729213, 0.31083000134299393, 0.3116625233652154,
                    0.3623950037547665, 0.26790402562589744, 0.26677008277621106,
                    0.23704633978330036, 0.3240756965618236, 0.21033240865384858,
                    0.24845085995906963, 0.2972344215281678, 0.09715919104482719,
                    0.18832735981058976, 0.3202789569808124, 0.3088582159501017,
                    0.17532147756382388, 1.0, 0.19610329204396013, 0.2336588377010105,
                    0.15172455762885256, 0.22692562347189446, 0.27239216046283027,
                    0.22911834054576247, 0.33595003552030905, 0.3212497759488899,
                    0.05475867520386929, 0.10959733117862795, 0.08111298712783906,
                    0.11189315414482458, 0.023253372715177138, 0.19219446575661342,
                    0.07592934786449333, 0.19698762530943995, 0.20037038527706186,
                    0.2103030004629519, 0.1261672236664096, 0.19610329204396013, 1.0,
                    0.1444848204895608, 0.15661509328961812, 0.23314321392552975,
                    0.10312057956065247, 0.11164677026207158, 0.16478645936260858,
                    0.16809043781878544, 0.2990414019517496, 0.32813833350981536,
                    0.26482339997977483, 0.22735568847212484, 0.22850076610156828,
                    0.42242752182195764, 0.18079277378608696, 0.21877321560107052,
                    0.4503132368665542, 0.3464618119042514, 0.36561255824905703,
                    0.2336588377010105, 0.1444848204895608, 1.0, 0.4008612209327899,
                    0.1705574805340934, 0.40143034168392183, 0.36847822163556077,
                    0.5279456422429019, 0.2599262044519267, 0.04790674541629446,
                    0.1127506146206671, 0.08022011059766367, 0.1478371807183841,
                    0.1305777858616531, 0.23329090377893266, 0.1853243743151929,
                    0.048369052469982396, 0.2540004492017467, 0.2076674323033683,
                    0.18667753733333828, 0.15172455762885256, 0.15661509328961812,
                    0.4008612209327899, 1.0, 0.1576447883989164, 0.15954075796840103,
                    0.1026280085363613, 0.26640012782733147, 0.08298360499623693,
                    0.15012506963526046, 0.22389835328690239, 0.15296000002004403,
                    0.16957067732406905, 0.13675966634703843, 0.15468436466848257,
                    0.1298617294646921, 0.19939850195861072, 0.3138232998761884,
                    0.2829723274043363, 0.16871243060729213, 0.22692562347189446,
                    0.23314321392552975, 0.1705574805340934, 0.1576447883989164, 1.0,
                    0.25464727615577876, 0.1931986639883187, 0.29891396601230724,
                    0.26539421450741957, 0.5178855052732115, 0.4856840046196488,
                    0.48552832284456904, 0.38474341551707414, 0.4416277487080384,
                    0.37255495298666697, 0.24806846600886517, 0.27724920127094144,
                    0.5073432856402429, 0.3818746818238709, 0.31083000134299393,
                    0.27239216046283027, 0.10312057956065247, 0.40143034168392183,
                    0.15954075796840103, 0.25464727615577876, 1.0, 0.41372025068719814,
                    0.5548496293674846, 0.46241653812587147, 0.35396389064607703,
                    0.3093182077794744, 0.30005935638605746, 0.22924766683437459,
                    0.22662182086578325, 0.36759176326108367, 0.16200530453917195,
                    0.30168316633325726, 0.4159621298319911, 0.3432700966573608,
                    0.3116625233652154, 0.22911834054576247, 0.11164677026207158,
                    0.36847822163556077, 0.1026280085363613, 0.1931986639883187,
                    0.41372025068719814, 1.0, 0.4723420965421923, 0.3118004636750392,
                    0.39364342184974177, 0.42848364545035134, 0.36752782812519164,
                    0.3061293514190903, 0.2967823751815248, 0.49596628300767126,
                    0.22669345173967292, 0.27376529012234, 0.8854469686128625,
                    0.5103624706563592, 0.3623950037547665, 0.33595003552030905,
                    0.16478645936260858, 0.5279456422429019, 0.26640012782733147,
                    0.29891396601230724, 0.5548496293674846, 0.4723420965421923, 1.0,
                    0.40896759924977594, 0.4481133178825172, 0.3858204518234596,
                    0.43074216862040016, 0.26828069678965294, 0.4303238947013493,
                    0.3545059239681433, 0.10365878243249618, 0.2958217983537089,
                    0.36887550513170075, 0.34977213116748684, 0.26790402562589744,
                    0.3212497759488899, 0.16809043781878544, 0.2599262044519267,
                    0.08298360499623693, 0.26539421450741957, 0.46241653812587147,
                    0.3118004636750392, 0.40896759924977594, 1.0], (20, 20))
    distt = reshape([0.0, 0.5208030324324489, 0.44855716082163577, 0.5477675749447438,
                     0.4509062312460257, 0.5863035385907573, 0.656148751159283,
                     0.6231184826862447, 0.5609238523916645, 0.5863278479491326,
                     0.607406056414094, 0.6054873727931033, 0.6874741176204856,
                     0.5920129213320645, 0.6899613230405403, 0.651872276740137,
                     0.4909758113832027, 0.5683467732616783, 0.5506162811569679,
                     0.5253030944690327, 0.5208030324324489, 0.0, 0.520021000542058,
                     0.5835363743413551, 0.5457951203981156, 0.5946692947084543,
                     0.6248595731082429, 0.6163922836060237, 0.5536403933972713,
                     0.577452261837146, 0.604243314909239, 0.6176381061012588,
                     0.6672340926621526, 0.5795954047825882, 0.6660515690918132,
                     0.6229372547508688, 0.5071074813983477, 0.5876571246145688,
                     0.5345635390436055, 0.5541568136261343, 0.44855716082163577,
                     0.520021000542058, 0.0, 0.563106944952387, 0.48834106468464505,
                     0.5892019674574445, 0.6407492387407222, 0.6367521604094342,
                     0.5700972891086193, 0.5913267165702545, 0.6208635540395828,
                     0.581345122727531, 0.6778226216615084, 0.6062906068958289,
                     0.6781518596163901, 0.6507841423928352, 0.5071842254819401,
                     0.5915828951271084, 0.5623487227134104, 0.5335062470953831,
                     0.5477675749447438, 0.5835363743413551, 0.563106944952387, 0.0,
                     0.5667924027728971, 0.6173272954647268, 0.6143771487754585,
                     0.6590534896939207, 0.5953883425810674, 0.608931313337657,
                     0.6584978315450959, 0.6283580155238538, 0.6663733359968628,
                     0.6215481926318647, 0.6527491169207416, 0.6443715243071853,
                     0.554642490476039, 0.6207867319642171, 0.5890121597135791,
                     0.604863332997772, 0.4509062312460257, 0.5457951203981156,
                     0.48834106468464505, 0.5667924027728971, 0.0, 0.6290551193491416,
                     0.646902186058972, 0.6484955673761722, 0.5983063768001802,
                     0.6211985435950976, 0.6346963928957251, 0.613004543229873,
                     0.6988371152438968, 0.6210874471032367, 0.6593262523737193,
                     0.6569780565791226, 0.5283806635806999, 0.6218432998490121,
                     0.5929661140480437, 0.5337022134573974, 0.5863035385907573,
                     0.5946692947084543, 0.5892019674574445, 0.6173272954647268,
                     0.6290551193491416, 0.0, 0.6435381706789949, 0.6259844740639601,
                     0.5271149907572441, 0.5435242643165945, 0.5633079754273704,
                     0.5927754964874274, 0.6355334508282733, 0.5373883503473267,
                     0.6191563196080079, 0.6501213868699897, 0.5601093853049299,
                     0.5623202987350343, 0.5020128071037275, 0.5681082977883076,
                     0.656148751159283, 0.6248595731082429, 0.6407492387407222,
                     0.6143771487754585, 0.646902186058972, 0.6435381706789949, 0.0,
                     0.675896101722503, 0.613451018758022, 0.6253786212019141,
                     0.6517335006229159, 0.6718782661149164, 0.6797318045139225,
                     0.6400028227335849, 0.6382302193114986, 0.6595977071425082,
                     0.6131604740975787, 0.6473000445932428, 0.6218145013829796,
                     0.6694554569078901, 0.6231184826862447, 0.6163922836060237,
                     0.6367521604094342, 0.6590534896939207, 0.6484955673761722,
                     0.6259844740639601, 0.675896101722503, 0.0, 0.6321736792280399,
                     0.6127951472605304, 0.5911400806117627, 0.6370528393270884,
                     0.633645158858868, 0.6249907136905833, 0.6897937907556205,
                     0.6326932503359701, 0.6011450734760531, 0.5908962826362774,
                     0.6025921962146789, 0.5933709639198278, 0.5609238523916645,
                     0.5536403933972713, 0.5700972891086193, 0.5953883425810674,
                     0.5983063768001802, 0.5271149907572441, 0.613451018758022,
                     0.6321736792280399, 0.0, 0.5063692438841002, 0.6034915271355487,
                     0.582975575397112, 0.6323091074478281, 0.524255073000465,
                     0.6107370755072322, 0.5857374412327642, 0.49631477630620524,
                     0.5403877636327497, 0.2393251254957756, 0.5617492745292597,
                     0.5863278479491326, 0.577452261837146, 0.5913267165702545,
                     0.608931313337657, 0.6211985435950976, 0.5435242643165945,
                     0.6253786212019141, 0.6127951472605304, 0.5063692438841002, 0.0,
                     0.5963339512604535, 0.5878527809111301, 0.6283697158270154,
                     0.571637204919234, 0.6294174162257634, 0.5987602494302973,
                     0.5559340420302255, 0.5730313705822043, 0.4947916376332773,
                     0.5701876308867605, 0.607406056414094, 0.604243314909239,
                     0.6208635540395828, 0.6584978315450959, 0.6346963928957251,
                     0.5633079754273704, 0.6517335006229159, 0.5911400806117627,
                     0.6034915271355487, 0.5963339512604535, 0.0, 0.6421364817685474,
                     0.660996511463408, 0.5631995391293139, 0.6376999540013555,
                     0.644704416532378, 0.5870136278899349, 0.5866589625305253,
                     0.5646259807364666, 0.6050189973769843, 0.6054873727931033,
                     0.6176381061012588, 0.581345122727531, 0.6283580155238538,
                     0.613004543229873, 0.5927754964874274, 0.6718782661149164,
                     0.6370528393270884, 0.582975575397112, 0.5878527809111301,
                     0.6421364817685474, 0.0, 0.6339939699855354, 0.6190077391676898,
                     0.6512585670726901, 0.6217211499249907, 0.6031616033606456,
                     0.6208388113891711, 0.5762160898828195, 0.5825591060360785,
                     0.6874741176204856, 0.6672340926621526, 0.6778226216615084,
                     0.6663733359968628, 0.6988371152438968, 0.6355334508282733,
                     0.6797318045139225, 0.633645158858868, 0.6323091074478281,
                     0.6283697158270154, 0.660996511463408, 0.6339939699855354, 0.0,
                     0.6540317956760356, 0.6493785131609999, 0.6192159502445291,
                     0.6696564120649289, 0.6664657642137097, 0.6462250152374912,
                     0.6449455644398272, 0.5920129213320645, 0.5795954047825882,
                     0.6062906068958289, 0.6215481926318647, 0.6210874471032367,
                     0.5373883503473267, 0.6400028227335849, 0.6249907136905833,
                     0.524255073000465, 0.571637204919234, 0.5631995391293139,
                     0.6190077391676898, 0.6540317956760356, 0.0, 0.5473293245694086,
                     0.6439885555915985, 0.5470693092817757, 0.5619260531264052,
                     0.4858262846723601, 0.6083065820571373, 0.6899613230405403,
                     0.6660515690918132, 0.6781518596163901, 0.6527491169207416,
                     0.6593262523737193, 0.6191563196080079, 0.6382302193114986,
                     0.6897937907556205, 0.6107370755072322, 0.6294174162257634,
                     0.6376999540013555, 0.6512585670726901, 0.6493785131609999,
                     0.5473293245694086, 0.0, 0.648981976483586, 0.6482512020936015,
                     0.6698402762836968, 0.6056401044236868, 0.6771323338180518,
                     0.651872276740137, 0.6229372547508688, 0.6507841423928352,
                     0.6443715243071853, 0.6569780565791226, 0.6501213868699897,
                     0.6595977071425082, 0.6326932503359701, 0.5857374412327642,
                     0.5987602494302973, 0.644704416532378, 0.6217211499249907,
                     0.6192159502445291, 0.6439885555915985, 0.648981976483586, 0.0,
                     0.6104722450055454, 0.6351383062025472, 0.5920667335645927,
                     0.6060551895217879, 0.4909758113832027, 0.5071074813983477,
                     0.5071842254819401, 0.554642490476039, 0.5283806635806999,
                     0.5601093853049299, 0.6131604740975787, 0.6011450734760531,
                     0.49631477630620524, 0.5559340420302255, 0.5870136278899349,
                     0.6031616033606456, 0.6696564120649289, 0.5470693092817757,
                     0.6482512020936015, 0.6104722450055454, 0.0, 0.5414239324747299,
                     0.47177874614723553, 0.5184512811605969, 0.5683467732616783,
                     0.5876571246145688, 0.5915828951271084, 0.6207867319642171,
                     0.6218432998490121, 0.5623202987350343, 0.6473000445932428,
                     0.5908962826362774, 0.5403877636327497, 0.5730313705822043,
                     0.5866589625305253, 0.6208388113891711, 0.6664657642137097,
                     0.5619260531264052, 0.6698402762836968, 0.6351383062025472,
                     0.5414239324747299, 0.0, 0.5136428250534644, 0.5866001774313407,
                     0.5506162811569679, 0.5345635390436055, 0.5623487227134104,
                     0.5890121597135791, 0.5929661140480437, 0.5020128071037275,
                     0.6218145013829796, 0.6025921962146789, 0.2393251254957756,
                     0.4947916376332773, 0.5646259807364666, 0.5762160898828195,
                     0.6462250152374912, 0.4858262846723601, 0.6056401044236868,
                     0.5920667335645927, 0.47177874614723553, 0.5136428250534644, 0.0,
                     0.5436140178243309, 0.5253030944690327, 0.5541568136261343,
                     0.5335062470953831, 0.604863332997772, 0.5337022134573974,
                     0.5681082977883076, 0.6694554569078901, 0.5933709639198278,
                     0.5617492745292597, 0.5701876308867605, 0.6050189973769843,
                     0.5825591060360785, 0.6449455644398272, 0.6083065820571373,
                     0.6771323338180518, 0.6060551895217879, 0.5184512811605969,
                     0.5866001774313407, 0.5436140178243309, 0.0], (20, 20))
    @test isapprox(portfolio.cov, covt)
    @test isapprox(portfolio.cor, cort)
    @test isapprox(portfolio.dist, distt)

    c1 = PortCovCor(; ce = CovFull(; ce = AnalyticalNonlinearShrinkage(), absolute = true))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, set_cov = false, cor_type = c1)
    cort = reshape([1.0, 0.45752840281833124, 0.5975929469512664, 0.39990136767830886,
                    0.5933671412470112, 0.3124963212719126, 0.13893763270422677,
                    0.2234467130695842, 0.3707288636361882, 0.3124393094386776,
                    0.262115765262957, 0.26677008277621106, 0.05475867520386929,
                    0.2990414019517496, 0.04790674541629446, 0.15012506963526046,
                    0.5178855052732115, 0.35396389064607703, 0.39364342184974177,
                    0.4481133178825172, 0.45752840281833124, 1.0, 0.45915631799047374,
                    0.3189705996410918, 0.40421537309921296, 0.2927368598618992,
                    0.219101027789969, 0.24012110542190246, 0.38696462959782935,
                    0.3330977705983282, 0.26978003277498847, 0.23704633978330036,
                    0.10959733117862795, 0.32813833350981536, 0.1127506146206671,
                    0.22389835328690239, 0.4856840046196488, 0.3093182077794744,
                    0.42848364545035134, 0.3858204518234596, 0.5975929469512664,
                    0.45915631799047374, 1.0, 0.36582113709277875, 0.5230460090853346,
                    0.3056820830885531, 0.17888082610636993, 0.18909337242783641,
                    0.3499781619020066, 0.3006654285404838, 0.22905689453067613,
                    0.3240756965618236, 0.08111298712783906, 0.26482339997977483,
                    0.08022011059766367, 0.15296000002004403, 0.48552832284456904,
                    0.30005935638605746, 0.36752782812519164, 0.43074216862040016,
                    0.39990136767830886, 0.3189705996410918, 0.36582113709277875, 1.0,
                    0.35749274431785194, 0.23781402054841194, 0.24508143812507627,
                    0.13129699544453033, 0.29102544303713906, 0.25840531127375227,
                    0.13276121170081306, 0.21033240865384858, 0.11189315414482458,
                    0.22735568847212484, 0.1478371807183841, 0.16957067732406905,
                    0.38474341551707414, 0.22924766683437459, 0.3061293514190903,
                    0.26828069678965294, 0.5933671412470112, 0.40421537309921296,
                    0.5230460090853346, 0.35749274431785194, 1.0, 0.20857931364127444,
                    0.1630351233442463, 0.15890699818691295, 0.2840589589604817,
                    0.22822473887065917, 0.1943209776903107, 0.24845085995906963,
                    0.023253372715177138, 0.22850076610156828, 0.1305777858616531,
                    0.13675966634703843, 0.4416277487080384, 0.22662182086578325,
                    0.2967823751815248, 0.4303238947013493, 0.3124963212719126,
                    0.2927368598618992, 0.3056820830885531, 0.23781402054841194,
                    0.20857931364127444, 1.0, 0.17171724575826564, 0.2162868764617346,
                    0.44429957303798095, 0.4091627481982095, 0.36536824963983394,
                    0.2972344215281678, 0.19219446575661342, 0.42242752182195764,
                    0.23329090377893266, 0.15468436466848257, 0.37255495298666697,
                    0.36759176326108367, 0.49596628300767126, 0.3545059239681433,
                    0.13893763270422677, 0.219101027789969, 0.17888082610636993,
                    0.24508143812507627, 0.1630351233442463, 0.17171724575826564, 1.0,
                    0.08632891935264778, 0.24735569516948996, 0.21780316028718547,
                    0.15048688833159923, 0.09715919104482719, 0.07592934786449333,
                    0.18079277378608696, 0.1853243743151929, 0.1298617294646921,
                    0.24806846600886517, 0.16200530453917195, 0.22669345173967292,
                    0.10365878243249618, 0.2234467130695842, 0.24012110542190246,
                    0.18909337242783641, 0.13129699544453033, 0.15890699818691295,
                    0.2162868764617346, 0.08632891935264778, 1.0, 0.20071287858256673,
                    0.24896421498788954, 0.30110681018863744, 0.18832735981058976,
                    0.19698762530943995, 0.21877321560107052, 0.048369052469982396,
                    0.19939850195861072, 0.27724920127094144, 0.30168316633325726,
                    0.27376529012234, 0.2958217983537089, 0.3707288636361882,
                    0.38696462959782935, 0.3499781619020066, 0.29102544303713906,
                    0.2840589589604817, 0.44429957303798095, 0.24735569516948996,
                    0.20071287858256673, 1.0, 0.4871803776964893, 0.27159595335120673,
                    0.3202789569808124, 0.20037038527706186, 0.4503132368665542,
                    0.2540004492017467, 0.3138232998761884, 0.5073432856402429,
                    0.4159621298319911, 0.8854469686128625, 0.36887550513170075,
                    0.3124393094386776, 0.3330977705983282, 0.3006654285404838,
                    0.25840531127375227, 0.22822473887065917, 0.4091627481982095,
                    0.21780316028718547, 0.24896421498788954, 0.4871803776964893, 1.0,
                    0.2887716371481902, 0.3088582159501017, 0.2103030004629519,
                    0.3464618119042514, 0.2076674323033683, 0.2829723274043363,
                    0.3818746818238709, 0.3432700966573608, 0.5103624706563592,
                    0.34977213116748684, 0.262115765262957, 0.26978003277498847,
                    0.22905689453067613, 0.13276121170081306, 0.1943209776903107,
                    0.36536824963983394, 0.15048688833159923, 0.30110681018863744,
                    0.27159595335120673, 0.2887716371481902, 1.0, 0.17532147756382388,
                    0.1261672236664096, 0.36561255824905703, 0.18667753733333828,
                    0.16871243060729213, 0.31083000134299393, 0.3116625233652154,
                    0.3623950037547665, 0.26790402562589744, 0.26677008277621106,
                    0.23704633978330036, 0.3240756965618236, 0.21033240865384858,
                    0.24845085995906963, 0.2972344215281678, 0.09715919104482719,
                    0.18832735981058976, 0.3202789569808124, 0.3088582159501017,
                    0.17532147756382388, 1.0, 0.19610329204396013, 0.2336588377010105,
                    0.15172455762885256, 0.22692562347189446, 0.27239216046283027,
                    0.22911834054576247, 0.33595003552030905, 0.3212497759488899,
                    0.05475867520386929, 0.10959733117862795, 0.08111298712783906,
                    0.11189315414482458, 0.023253372715177138, 0.19219446575661342,
                    0.07592934786449333, 0.19698762530943995, 0.20037038527706186,
                    0.2103030004629519, 0.1261672236664096, 0.19610329204396013, 1.0,
                    0.1444848204895608, 0.15661509328961812, 0.23314321392552975,
                    0.10312057956065247, 0.11164677026207158, 0.16478645936260858,
                    0.16809043781878544, 0.2990414019517496, 0.32813833350981536,
                    0.26482339997977483, 0.22735568847212484, 0.22850076610156828,
                    0.42242752182195764, 0.18079277378608696, 0.21877321560107052,
                    0.4503132368665542, 0.3464618119042514, 0.36561255824905703,
                    0.2336588377010105, 0.1444848204895608, 1.0, 0.4008612209327899,
                    0.1705574805340934, 0.40143034168392183, 0.36847822163556077,
                    0.5279456422429019, 0.2599262044519267, 0.04790674541629446,
                    0.1127506146206671, 0.08022011059766367, 0.1478371807183841,
                    0.1305777858616531, 0.23329090377893266, 0.1853243743151929,
                    0.048369052469982396, 0.2540004492017467, 0.2076674323033683,
                    0.18667753733333828, 0.15172455762885256, 0.15661509328961812,
                    0.4008612209327899, 1.0, 0.1576447883989164, 0.15954075796840103,
                    0.1026280085363613, 0.26640012782733147, 0.08298360499623693,
                    0.15012506963526046, 0.22389835328690239, 0.15296000002004403,
                    0.16957067732406905, 0.13675966634703843, 0.15468436466848257,
                    0.1298617294646921, 0.19939850195861072, 0.3138232998761884,
                    0.2829723274043363, 0.16871243060729213, 0.22692562347189446,
                    0.23314321392552975, 0.1705574805340934, 0.1576447883989164, 1.0,
                    0.25464727615577876, 0.1931986639883187, 0.29891396601230724,
                    0.26539421450741957, 0.5178855052732115, 0.4856840046196488,
                    0.48552832284456904, 0.38474341551707414, 0.4416277487080384,
                    0.37255495298666697, 0.24806846600886517, 0.27724920127094144,
                    0.5073432856402429, 0.3818746818238709, 0.31083000134299393,
                    0.27239216046283027, 0.10312057956065247, 0.40143034168392183,
                    0.15954075796840103, 0.25464727615577876, 1.0, 0.41372025068719814,
                    0.5548496293674846, 0.46241653812587147, 0.35396389064607703,
                    0.3093182077794744, 0.30005935638605746, 0.22924766683437459,
                    0.22662182086578325, 0.36759176326108367, 0.16200530453917195,
                    0.30168316633325726, 0.4159621298319911, 0.3432700966573608,
                    0.3116625233652154, 0.22911834054576247, 0.11164677026207158,
                    0.36847822163556077, 0.1026280085363613, 0.1931986639883187,
                    0.41372025068719814, 1.0, 0.4723420965421923, 0.3118004636750392,
                    0.39364342184974177, 0.42848364545035134, 0.36752782812519164,
                    0.3061293514190903, 0.2967823751815248, 0.49596628300767126,
                    0.22669345173967292, 0.27376529012234, 0.8854469686128625,
                    0.5103624706563592, 0.3623950037547665, 0.33595003552030905,
                    0.16478645936260858, 0.5279456422429019, 0.26640012782733147,
                    0.29891396601230724, 0.5548496293674846, 0.4723420965421923, 1.0,
                    0.40896759924977594, 0.4481133178825172, 0.3858204518234596,
                    0.43074216862040016, 0.26828069678965294, 0.4303238947013493,
                    0.3545059239681433, 0.10365878243249618, 0.2958217983537089,
                    0.36887550513170075, 0.34977213116748684, 0.26790402562589744,
                    0.3212497759488899, 0.16809043781878544, 0.2599262044519267,
                    0.08298360499623693, 0.26539421450741957, 0.46241653812587147,
                    0.3118004636750392, 0.40896759924977594, 1.0], (20, 20))
    distt = reshape([0.0, 0.736526711791004, 0.6343556203335268, 0.7746603335150776,
                     0.6376777075866686, 0.8291584159423864, 0.927934462823627,
                     0.881222609180232, 0.7932661195108561, 0.8291927945666933,
                     0.859001882848369, 0.8562884544496608, 0.9722352209193672,
                     0.8372327024479218, 0.9757526605568163, 0.9218866147009293,
                     0.6943446512552599, 0.8037637148776517, 0.7786890124756213,
                     0.7428907605546611, 0.736526711791004, 0.0, 0.7354207516854051,
                     0.8252450547315677, 0.7718708615440714, 0.840989381703539,
                     0.8836848828683396, 0.8717103272177619, 0.7829657530199968,
                     0.8166408203131116, 0.8545290909179228, 0.8734721862868329,
                     0.9436115031205227, 0.8196716821326602, 0.9419391622495228,
                     0.8809663141761425, 0.7171582777744054, 0.8310726756550991,
                     0.7559870068656264, 0.7836960815115388, 0.6343556203335268,
                     0.7354207516854051, 0.0, 0.7963534786181455, 0.6906185567407419,
                     0.833257413355229, 0.9061562635073656, 0.9005035411213904,
                     0.8062393181295449, 0.8362622623672051, 0.878033658505939,
                     0.8221461569807259, 0.9585859444369925, 0.857424399011496,
                     0.9590515572180343, 0.920347760349291, 0.7172668102982537,
                     0.8366245535566971, 0.795281190444492, 0.7544917702530624,
                     0.7746603335150776, 0.8252450547315677, 0.7963534786181455, 0.0,
                     0.8015655030514649, 0.8730326336693194, 0.8688604962103661,
                     0.9320423834544594, 0.842006268956984, 0.8611589218757753,
                     0.9312565641643483, 0.8886324275796779, 0.9423942093705666,
                     0.8790018836884681, 0.923126653976374, 0.9112789488822459,
                     0.7843829322996044, 0.8779250156850672, 0.8329889846696111,
                     0.8554059289076427, 0.6376777075866686, 0.7718708615440714,
                     0.6906185567407419, 0.8015655030514649, 0.0, 0.889618281263782,
                     0.9148578450534015, 0.917111226522218, 0.8461329925251221,
                     0.8785074052786014, 0.8975962468224169, 0.8669193388320107,
                     0.9883049262676084, 0.8783502911130796, 0.9324281281355399,
                     0.9291072777957138, 0.7472431005315215, 0.8794192283173121,
                     0.8385807205144149, 0.754768908539992, 0.8291584159423864,
                     0.840989381703539, 0.833257413355229, 0.8730326336693194,
                     0.889618281263782, 0.0, 0.9101004088790062, 0.8852757330562413,
                     0.7454531688590632, 0.7686593860753868, 0.7966377786423176,
                     0.8383111465749649, 0.8987800255031186, 0.7599818933224938,
                     0.8756192644186555, 0.9194104825003452, 0.7921142891106895,
                     0.7952409928687758, 0.7099533202910799, 0.8034264596289176,
                     0.927934462823627, 0.8836848828683396, 0.9061562635073656,
                     0.8688604962103661, 0.9148578450534015, 0.9101004088790062, 0.0,
                     0.9558614338110688, 0.8675507505791866, 0.8844189277219334,
                     0.9216903556338217, 0.9501793562034343, 0.9612859367199266,
                     0.9051006718668996, 0.9025938320666761, 0.932812023151132,
                     0.8671398583799126, 0.9154205019884731, 0.8793785011360734,
                     0.9467529865638153, 0.881222609180232, 0.8717103272177619,
                     0.9005035411213904, 0.9320423834544594, 0.917111226522218,
                     0.8852757330562413, 0.9558614338110688, 0.0, 0.8940285909395925,
                     0.8666232082122601, 0.8359983192634796, 0.9009287653246566,
                     0.8961095773902654, 0.883870343658463, 0.9755157341273475,
                     0.8947633754470448, 0.850147515863605, 0.835653536860069,
                     0.8521940564669881, 0.8391532646938169, 0.7932661195108561,
                     0.7829657530199968, 0.8062393181295449, 0.842006268956984,
                     0.8461329925251221, 0.7454531688590632, 0.8675507505791866,
                     0.8940285909395925, 0.0, 0.7161142522695039, 0.8534659024523437,
                     0.8244519652588546, 0.8942201153647451, 0.7414086343801546,
                     0.8637126552264088, 0.8283578333810887, 0.7018950878584043,
                     0.7642237042699008, 0.3384568382927688, 0.7944334426925261,
                     0.8291927945666933, 0.8166408203131116, 0.8362622623672051,
                     0.8611589218757753, 0.8785074052786014, 0.7686593860753868,
                     0.8844189277219334, 0.8666232082122601, 0.7161142522695039, 0.0,
                     0.8433435615760695, 0.8313493754432599, 0.8886489743070928,
                     0.8084170879538288, 0.8901306464203059, 0.8467748653542237,
                     0.7862094620240392, 0.8103887359425964, 0.6997410444897747,
                     0.8063670806974409, 0.859001882848369, 0.8545290909179228,
                     0.878033658505939, 0.9312565641643483, 0.8975962468224169,
                     0.7966377786423176, 0.9216903556338217, 0.8359983192634796,
                     0.8534659024523437, 0.8433435615760695, 0.0, 0.9081181214116235,
                     0.9347902311928545, 0.7964844265589522, 0.9018439236734157,
                     0.911749729581922, 0.8301626338597794, 0.8296610612983983,
                     0.7985017196257209, 0.8556260715839031, 0.8562884544496608,
                     0.8734721862868329, 0.8221461569807259, 0.8886324275796779,
                     0.8669193388320107, 0.8383111465749649, 0.9501793562034343,
                     0.9009287653246566, 0.8244519652588546, 0.8313493754432599,
                     0.9081181214116235, 0.0, 0.8966028708163051, 0.8754091399448544,
                     0.9210186981658665, 0.8792464822381182, 0.8529993197753265,
                     0.8779986671141577, 0.8148926091698776, 0.8238629886401683,
                     0.9722352209193672, 0.9436115031205227, 0.9585859444369925,
                     0.9423942093705666, 0.9883049262676084, 0.8987800255031186,
                     0.9612859367199266, 0.8961095773902654, 0.8942201153647451,
                     0.8886489743070928, 0.9347902311928545, 0.8966028708163051, 0.0,
                     0.9249406356682786, 0.9183599004259615, 0.8757035948735566,
                     0.9470371800723283, 0.9425249226083777, 0.91390018089362,
                     0.9120907642231746, 0.8372327024479218, 0.8196716821326602,
                     0.857424399011496, 0.8790018836884681, 0.8783502911130796,
                     0.7599818933224938, 0.9051006718668996, 0.883870343658463,
                     0.7414086343801546, 0.8084170879538288, 0.7964844265589522,
                     0.8754091399448544, 0.9249406356682786, 0.0, 0.7740405538905633,
                     0.9107373493306984, 0.7736728367443685, 0.7946834453821466,
                     0.6870621207409837, 0.8602754184260255, 0.9757526605568163,
                     0.9419391622495228, 0.9590515572180343, 0.923126653976374,
                     0.9324281281355399, 0.8756192644186555, 0.9025938320666761,
                     0.9755157341273475, 0.8637126552264088, 0.8901306464203059,
                     0.9018439236734157, 0.9210186981658665, 0.9183599004259615,
                     0.7740405538905633, 0.0, 0.9177991128787844, 0.9167656418254334,
                     0.9472972033441451, 0.8565044495930354, 0.9576097300068348,
                     0.9218866147009293, 0.8809663141761425, 0.920347760349291,
                     0.9112789488822459, 0.9291072777957138, 0.9194104825003452,
                     0.932812023151132, 0.8947633754470448, 0.8283578333810887,
                     0.8467748653542237, 0.911749729581922, 0.8792464822381182,
                     0.8757035948735566, 0.9107373493306984, 0.9177991128787844, 0.0,
                     0.8633381283391932, 0.8982212066143179, 0.8373088044369847,
                     0.857091468568309, 0.6943446512552599, 0.7171582777744054,
                     0.7172668102982537, 0.7843829322996044, 0.7472431005315215,
                     0.7921142891106895, 0.8671398583799126, 0.850147515863605,
                     0.7018950878584043, 0.7862094620240392, 0.8301626338597794,
                     0.8529993197753265, 0.9470371800723283, 0.7736728367443685,
                     0.9167656418254334, 0.8633381283391932, 0.0, 0.7656890682991379,
                     0.6671959012407941, 0.7332008332470228, 0.8037637148776517,
                     0.8310726756550991, 0.8366245535566971, 0.8779250156850672,
                     0.8794192283173121, 0.7952409928687758, 0.9154205019884731,
                     0.835653536860069, 0.7642237042699008, 0.8103887359425964,
                     0.8296610612983983, 0.8779986671141577, 0.9425249226083777,
                     0.7946834453821466, 0.9472972033441451, 0.8982212066143179,
                     0.7656890682991379, 0.0, 0.7264006494062404, 0.829577926613866,
                     0.7786890124756213, 0.7559870068656264, 0.795281190444492,
                     0.8329889846696111, 0.8385807205144149, 0.7099533202910799,
                     0.8793785011360734, 0.8521940564669881, 0.3384568382927688,
                     0.6997410444897747, 0.7985017196257209, 0.8148926091698776,
                     0.91390018089362, 0.6870621207409837, 0.8565044495930354,
                     0.8373088044369847, 0.6671959012407941, 0.7264006494062404, 0.0,
                     0.7687863167032983, 0.7428907605546611, 0.7836960815115388,
                     0.7544917702530624, 0.8554059289076427, 0.754768908539992,
                     0.8034264596289176, 0.9467529865638153, 0.8391532646938169,
                     0.7944334426925261, 0.8063670806974409, 0.8556260715839031,
                     0.8238629886401683, 0.9120907642231746, 0.8602754184260255,
                     0.9576097300068348, 0.857091468568309, 0.7332008332470228,
                     0.829577926613866, 0.7687863167032983, 0.0], (20, 20))
    @test isapprox(portfolio.cor, cort)
    @test isapprox(portfolio.dist, distt)

    c1 = PortCovCor(; ce = CovSemi(; ce = AnalyticalNonlinearShrinkage()))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, cov_type = c1, cor_type = c1)
    covt = reshape([9.702711967851512e-5, 6.310253682417088e-5, 8.151479546230023e-5,
                    8.060358192678713e-5, 8.256134332552538e-5, 4.932137535300489e-5,
                    0.00011356662488936767, 3.834942153713739e-5, 6.873613382944189e-5,
                    6.233093180018269e-5, 3.514094446645455e-5, 6.660804725656384e-5,
                    8.253873308534853e-5, 4.35148578811306e-5, 7.243727714544353e-5,
                    5.79296192438879e-5, 6.23722353667598e-5, 4.300459657719764e-5,
                    5.9008051474904215e-5, 5.407717606116375e-5, 6.310253682417088e-5,
                    0.00010622703834889306, 7.278123204164205e-5, 7.680966720993814e-5,
                    7.218050594059805e-5, 4.6616238619831036e-5, 0.0001206145987914887,
                    3.652361922524807e-5, 6.793553975058118e-5, 6.0368432468282765e-5,
                    3.384913890726057e-5, 6.974899316014692e-5, 9.501026184208764e-5,
                    4.408576072204745e-5, 8.316633079078799e-5, 6.493935923174103e-5,
                    5.9730556451288475e-5, 3.589597658417577e-5, 5.6791321297089797e-5,
                    4.837317237007176e-5, 8.151479546230023e-5, 7.278123204164205e-5,
                    0.0001277717745916105, 9.531788226542904e-5, 9.236869260844913e-5,
                    5.4714913614442134e-5, 0.0001315945004499207, 3.9132449598614595e-5,
                    7.557384491718634e-5, 6.855906328141259e-5, 3.633853416364586e-5,
                    8.061797319746748e-5, 9.935843829865127e-5, 4.154793133360204e-5,
                    7.99133394909862e-5, 6.761177758416566e-5, 6.998711781446583e-5,
                    4.6414231478540586e-5, 6.22144503808269e-5, 6.052674895991675e-5,
                    8.060358192678713e-5, 7.680966720993814e-5, 9.531788226542904e-5,
                    0.00018959868310034283, 9.795287241980111e-5, 6.298668408673795e-5,
                    0.00017543475237568029, 4.493946621738817e-5, 8.911143554529641e-5,
                    8.222125832380222e-5, 4.368341925260318e-5, 9.177554608898884e-5,
                    0.00013373516347490997, 5.440339258826366e-5, 0.00012484753710363734,
                    7.8500655364258e-5, 7.50411734109493e-5, 4.89850616730786e-5,
                    7.424898617422184e-5, 6.096857647347341e-5, 8.256134332552538e-5,
                    7.218050594059805e-5, 9.236869260844913e-5, 9.795287241980111e-5,
                    0.0001416921862377733, 5.304125697558659e-5, 0.0001413848211737812,
                    4.241617557211879e-5, 7.920180062454804e-5, 6.857369572856774e-5,
                    3.7428051343389347e-5, 8.261865137397292e-5, 0.00010309823304272171,
                    4.561557895158534e-5, 9.480409884080407e-5, 6.712689888166117e-5,
                    7.24608239258597e-5, 4.437112050898387e-5, 6.491676761854125e-5,
                    6.525452223195548e-5, 4.932137535300489e-5, 4.6616238619831036e-5,
                    5.4714913614442134e-5, 6.298668408673795e-5, 5.304125697558659e-5,
                    9.122351643804942e-5, 9.683536846295786e-5, 3.421920503796696e-5,
                    6.56505686296365e-5, 5.873592798497188e-5, 3.5700282125976214e-5,
                    7.61942027328263e-5, 0.00011361595055716498, 4.1299989880759533e-5,
                    7.987263690112363e-5, 5.0480584621393266e-5, 4.6692773304533e-5,
                    3.5840825270563485e-5, 5.53159071637849e-5, 4.0500965990497094e-5,
                    0.00011356662488936767, 0.0001206145987914887, 0.0001315945004499207,
                    0.00017543475237568029, 0.0001413848211737812, 9.683536846295786e-5,
                    0.0006561727019771395, 6.827749710970058e-5, 0.00015306938585683323,
                    0.00013824071220470242, 7.786572027826698e-5, 0.00015086318450115868,
                    0.00024647968277030825, 8.72302816519767e-5, 0.00021324152646832502,
                    0.00014500974577098496, 0.00011809156562517255, 8.042557522000619e-5,
                    0.00012263137763837177, 8.875669772577406e-5, 3.834942153713739e-5,
                    3.652361922524807e-5, 3.9132449598614595e-5, 4.493946621738817e-5,
                    4.241617557211879e-5, 3.421920503796696e-5, 6.827749710970058e-5,
                    8.540749111700708e-5, 4.337086226947831e-5, 4.143484059043709e-5,
                    2.8964896642980867e-5, 5.333855057214711e-5, 9.994823982616275e-5,
                    3.143936476666482e-5, 5.2606567440918544e-5, 5.784186673079179e-5,
                    3.4307588862736854e-5, 3.108996644407767e-5, 4.077628054055044e-5,
                    3.478832085757041e-5, 6.873613382944189e-5, 6.793553975058118e-5,
                    7.557384491718634e-5, 8.911143554529641e-5, 7.920180062454804e-5,
                    6.56505686296365e-5, 0.00015306938585683323, 4.337086226947831e-5,
                    0.0001425616785459508, 8.425656610226644e-5, 4.066759362582844e-5,
                    9.211604517962747e-5, 0.00012943353532193655, 6.0424667367378044e-5,
                    0.00011294535376143315, 8.287148151974868e-5, 7.310789953882909e-5,
                    5.049153080437053e-5, 0.00010462641618988061, 5.553798586862097e-5,
                    6.233093180018269e-5, 6.0368432468282765e-5, 6.855906328141259e-5,
                    8.222125832380222e-5, 6.857369572856774e-5, 5.873592798497188e-5,
                    0.00013824071220470242, 4.143484059043709e-5, 8.425656610226644e-5,
                    0.00012315167871278148, 4.1661554503857944e-5, 9.032569841127039e-5,
                    0.0001361320345203131, 5.094896488557185e-5, 0.00010342441291556314,
                    7.737202195797922e-5, 5.751353899384951e-5, 4.454327229467042e-5,
                    6.988489406111819e-5, 5.141809291197229e-5, 3.514094446645455e-5,
                    3.384913890726057e-5, 3.633853416364586e-5, 4.368341925260318e-5,
                    3.7428051343389347e-5, 3.5700282125976214e-5, 7.786572027826698e-5,
                    2.8964896642980867e-5, 4.066759362582844e-5, 4.1661554503857944e-5,
                    5.502301989283115e-5, 4.443288113025783e-5, 7.474692538731236e-5,
                    3.180808059093893e-5, 5.9278592323535215e-5, 3.833841395433775e-5,
                    3.23251731250099e-5, 2.7048294763135435e-5, 3.5849134914646975e-5,
                    2.8276159680798242e-5, 6.660804725656384e-5, 6.974899316014692e-5,
                    8.061797319746748e-5, 9.177554608898884e-5, 8.261865137397292e-5,
                    7.61942027328263e-5, 0.00015086318450115868, 5.333855057214711e-5,
                    9.211604517962747e-5, 9.032569841127039e-5, 4.443288113025783e-5,
                    0.0003823454281440479, 0.00018221713934621293, 5.58389871561274e-5,
                    0.00013446506405194632, 0.0001036522018228198, 6.919801680151967e-5,
                    5.152839853549e-5, 7.725262084310087e-5, 6.823934972380049e-5,
                    8.253873308534853e-5, 9.501026184208764e-5, 9.935843829865127e-5,
                    0.00013373516347490997, 0.00010309823304272171, 0.00011361595055716498,
                    0.00024647968277030825, 9.994823982616275e-5, 0.00012943353532193655,
                    0.0001361320345203131, 7.474692538731236e-5, 0.00018221713934621293,
                    0.0008126911092365985, 8.603134022560592e-5, 0.0002577963235700947,
                    0.00017025704958351803, 8.469337088216578e-5, 6.986892098927478e-5,
                    9.547358675358466e-5, 9.197619407508661e-5, 4.35148578811306e-5,
                    4.408576072204745e-5, 4.154793133360204e-5, 5.440339258826366e-5,
                    4.561557895158534e-5, 4.1299989880759533e-5, 8.72302816519767e-5,
                    3.143936476666482e-5, 6.0424667367378044e-5, 5.094896488557185e-5,
                    3.180808059093893e-5, 5.58389871561274e-5, 8.603134022560592e-5,
                    7.288662227388117e-5, 9.528505022067757e-5, 4.809463366215335e-5,
                    4.3737103813393935e-5, 3.358309910239397e-5, 5.191025439527034e-5,
                    3.450228533879231e-5, 7.243727714544353e-5, 8.316633079078799e-5,
                    7.99133394909862e-5, 0.00012484753710363734, 9.480409884080407e-5,
                    7.987263690112363e-5, 0.00021324152646832502, 5.2606567440918544e-5,
                    0.00011294535376143315, 0.00010342441291556314, 5.9278592323535215e-5,
                    0.00013446506405194632, 0.0002577963235700947, 9.528505022067757e-5,
                    0.00046548107069750944, 0.00011508806007419709, 7.700774531284878e-5,
                    5.5389830380761596e-5, 8.990189665618808e-5, 6.481943225143917e-5,
                    5.79296192438879e-5, 6.493935923174103e-5, 6.761177758416566e-5,
                    7.8500655364258e-5, 6.712689888166117e-5, 5.0480584621393266e-5,
                    0.00014500974577098496, 5.784186673079179e-5, 8.287148151974868e-5,
                    7.737202195797922e-5, 3.833841395433775e-5, 0.0001036522018228198,
                    0.00017025704958351803, 4.809463366215335e-5, 0.00011508806007419709,
                    0.00022885530995881212, 5.7755352774896316e-5, 4.469030704640977e-5,
                    6.602119027274202e-5, 5.463346231626208e-5, 6.23722353667598e-5,
                    5.9730556451288475e-5, 6.998711781446583e-5, 7.50411734109493e-5,
                    7.24608239258597e-5, 4.6692773304533e-5, 0.00011809156562517255,
                    3.4307588862736854e-5, 7.310789953882909e-5, 5.751353899384951e-5,
                    3.23251731250099e-5, 6.919801680151967e-5, 8.469337088216578e-5,
                    4.3737103813393935e-5, 7.700774531284878e-5, 5.7755352774896316e-5,
                    8.469346416229814e-5, 3.983688120793793e-5, 6.098053445396394e-5,
                    4.833710244096374e-5, 4.300459657719764e-5, 3.589597658417577e-5,
                    4.6414231478540586e-5, 4.89850616730786e-5, 4.437112050898387e-5,
                    3.5840825270563485e-5, 8.042557522000619e-5, 3.108996644407767e-5,
                    5.049153080437053e-5, 4.454327229467042e-5, 2.7048294763135435e-5,
                    5.152839853549e-5, 6.986892098927478e-5, 3.358309910239397e-5,
                    5.5389830380761596e-5, 4.469030704640977e-5, 3.983688120793793e-5,
                    5.790504147200319e-5, 4.333284148567213e-5, 3.435305796233638e-5,
                    5.9008051474904215e-5, 5.6791321297089797e-5, 6.22144503808269e-5,
                    7.424898617422184e-5, 6.491676761854125e-5, 5.53159071637849e-5,
                    0.00012263137763837177, 4.077628054055044e-5, 0.00010462641618988061,
                    6.988489406111819e-5, 3.5849134914646975e-5, 7.725262084310087e-5,
                    9.547358675358466e-5, 5.191025439527034e-5, 8.990189665618808e-5,
                    6.602119027274202e-5, 6.098053445396394e-5, 4.333284148567213e-5,
                    9.309031579087817e-5, 4.702354906901931e-5, 5.407717606116375e-5,
                    4.837317237007176e-5, 6.052674895991675e-5, 6.096857647347341e-5,
                    6.525452223195548e-5, 4.0500965990497094e-5, 8.875669772577406e-5,
                    3.478832085757041e-5, 5.553798586862097e-5, 5.141809291197229e-5,
                    2.8276159680798242e-5, 6.823934972380049e-5, 9.197619407508661e-5,
                    3.450228533879231e-5, 6.481943225143917e-5, 5.463346231626208e-5,
                    4.833710244096374e-5, 3.435305796233638e-5, 4.702354906901931e-5,
                    8.652037673172765e-5], (20, 20))
    cort = reshape([1.0, 0.6215595057179937, 0.7321033771219764, 0.5942786305335763,
                    0.7041371049326947, 0.5242460952903587, 0.4500855498582797,
                    0.4212736209476922, 0.5844362308275415, 0.570212694416445,
                    0.4809441524389085, 0.34582165215116445, 0.2939330861372515,
                    0.5174484466810851, 0.34085097080034094, 0.38875286945239923,
                    0.6880496701823499, 0.5737333823977263, 0.6208868366197411,
                    0.5902122700878208, 0.6215595057179937, 1.0, 0.6247185518018805,
                    0.5412285385472829, 0.5883414338065458, 0.47355048625114404,
                    0.4568496119951978, 0.38344959863251804, 0.5520495922925367,
                    0.5278034130924834, 0.44274929376360406, 0.34609271310721357,
                    0.3233629245234297, 0.5010221083941988, 0.37400636418031935,
                    0.4164951664260278, 0.6297295536727926, 0.45768855025323635,
                    0.5711000320858884, 0.5045774438131186, 0.7321033771219764,
                    0.6247185518018805, 1.0, 0.6124057549238142, 0.6864902645396052,
                    0.5067979505483196, 0.4544762543614076, 0.3746032914678051,
                    0.5599543910677436, 0.5465466589451815, 0.4333888461605773,
                    0.364742576298499, 0.30833621654282917, 0.43053457050002697,
                    0.32768065578229544, 0.39538882820827476, 0.6727840658769578,
                    0.5396044369339867, 0.5704552136442572, 0.5756661370497191,
                    0.5942786305335763, 0.5412285385472829, 0.6124057549238142, 1.0,
                    0.5976219869087797, 0.4789362206530695, 0.4973806556155242,
                    0.35315248710533115, 0.5420188390573477, 0.5380793094673967,
                    0.42768769484865266, 0.3408641822784, 0.3406945609822915,
                    0.4627904757374142, 0.42025347069127306, 0.3768557338777063,
                    0.5921844643725198, 0.46750667107870936, 0.5588826376470462,
                    0.47602437976339174, 0.7041371049326947, 0.5883414338065458,
                    0.6864902645396052, 0.5976219869087797, 1.0, 0.46653846081303313,
                    0.4636825548775748, 0.3855765163293415, 0.5572636362764265,
                    0.5191160269955502, 0.42388891013650376, 0.3549581891172263,
                    0.30381941081596264, 0.44886560517024104, 0.3691502368874548,
                    0.37277187383688665, 0.661462714573318, 0.489856930693009,
                    0.5652384340822597, 0.5893570224901657, 0.5242460952903587,
                    0.47355048625114404, 0.5067979505483196, 0.4789362206530695,
                    0.46653846081303313, 1.0, 0.3957961134738778, 0.38767565488990685,
                    0.5756833744852563, 0.5541537314995466, 0.5039019422312525,
                    0.4079815971308765, 0.4172757509556774, 0.5064920446420104,
                    0.38760877954302614, 0.3493739134156813, 0.5312162068775046,
                    0.493135659289897, 0.6002668814955313, 0.4558823477901967,
                    0.4500855498582797, 0.4568496119951978, 0.4544762543614076,
                    0.4973806556155242, 0.4636825548775748, 0.3957961134738778, 1.0,
                    0.28841678459777975, 0.5004697819310957, 0.4863027382878672,
                    0.4097934518948187, 0.3011939475693957, 0.33752760093601025,
                    0.398872672482671, 0.38584394644221903, 0.37420330156408876,
                    0.5009390092195679, 0.41259779982622646, 0.49618116662402145,
                    0.37250564214243065, 0.4212736209476922, 0.38344959863251804,
                    0.3746032914678051, 0.35315248710533115, 0.3855765163293415,
                    0.38767565488990685, 0.28841678459777975, 1.0, 0.393050790675942,
                    0.40401503015472295, 0.42252439599201863, 0.29516528436936645,
                    0.37937124837400027, 0.39847572367214085, 0.26384020189576135,
                    0.41372695947606697, 0.40338269784645525, 0.4420934521097741,
                    0.457306500190819, 0.40469355110179, 0.5844362308275415,
                    0.5520495922925367, 0.5599543910677436, 0.5420188390573477,
                    0.5572636362764265, 0.5756833744852563, 0.5004697819310957,
                    0.393050790675942, 1.0, 0.6358902809106216, 0.45917143602658,
                    0.3945535299757354, 0.3802617645588489, 0.5927737398806162,
                    0.43844584384954927, 0.45879978540601885, 0.6653313043867796,
                    0.555723739268913, 0.908212965735903, 0.500068529998474,
                    0.570212694416445, 0.5278034130924834, 0.5465466589451815,
                    0.5380793094673967, 0.5191160269955502, 0.5541537314995466,
                    0.4863027382878672, 0.40401503015472295, 0.6358902809106216, 1.0,
                    0.5061078706319085, 0.41625859059432957, 0.4303060109262059,
                    0.5377634540928992, 0.4319683066026213, 0.46087513895085297,
                    0.5631511501301222, 0.5274772847842186, 0.6526959099940528,
                    0.4981230007813101, 0.4809441524389085, 0.44274929376360406,
                    0.4333888461605773, 0.42768769484865266, 0.42388891013650376,
                    0.5039019422312525, 0.4097934518948187, 0.42252439599201863,
                    0.45917143602658, 0.5061078706319085, 1.0, 0.3063404265565985,
                    0.3534747269204858, 0.502274742300278, 0.3704031389240152,
                    0.3416500072462695, 0.4735258581202969, 0.4791919247323375,
                    0.5009036738007585, 0.40981609743602093, 0.34582165215116445,
                    0.34609271310721357, 0.364742576298499, 0.3408641822784,
                    0.3549581891172263, 0.4079815971308765, 0.3011939475693957,
                    0.29516528436936645, 0.3945535299757354, 0.41625859059432957,
                    0.3063404265565985, 1.0, 0.326887654682534, 0.3344919490710425,
                    0.31873554634888596, 0.35040483048871124, 0.38453931527612273,
                    0.3463063905517877, 0.4094803063327712, 0.37518695338920144,
                    0.2939330861372515, 0.3233629245234297, 0.30833621654282917,
                    0.3406945609822915, 0.30381941081596264, 0.4172757509556774,
                    0.33752760093601025, 0.37937124837400027, 0.3802617645588489,
                    0.4303060109262059, 0.3534747269204858, 0.326887654682534, 1.0,
                    0.3534842125648164, 0.41914370979706933, 0.3947860989705566,
                    0.3228209534042863, 0.3220795075522375, 0.34711088459227263,
                    0.3468594087914197, 0.5174484466810851, 0.5010221083941988,
                    0.43053457050002697, 0.4627904757374142, 0.44886560517024104,
                    0.5064920446420104, 0.398872672482671, 0.39847572367214085,
                    0.5927737398806162, 0.5377634540928992, 0.502274742300278,
                    0.3344919490710425, 0.3534842125648164, 1.0, 0.5173087718038826,
                    0.372385028422437, 0.5566742860441405, 0.5169382523968307,
                    0.6301979602528923, 0.43447495745120857, 0.34085097080034094,
                    0.37400636418031935, 0.32768065578229544, 0.42025347069127306,
                    0.3691502368874548, 0.38760877954302614, 0.38584394644221903,
                    0.26384020189576135, 0.43844584384954927, 0.4319683066026213,
                    0.3704031389240152, 0.31873554634888596, 0.41914370979706933,
                    0.5173087718038826, 1.0, 0.35261335800972265, 0.3878452234768125,
                    0.33738116567606546, 0.43188248345450714, 0.3229944125335375,
                    0.38875286945239923, 0.4164951664260278, 0.39538882820827476,
                    0.3768557338777063, 0.37277187383688665, 0.3493739134156813,
                    0.37420330156408876, 0.41372695947606697, 0.45879978540601885,
                    0.46087513895085297, 0.3416500072462695, 0.35040483048871124,
                    0.3947860989705566, 0.372385028422437, 0.35261335800972265, 1.0,
                    0.41484589377146786, 0.3882170930243358, 0.45232500980660056,
                    0.3882567604349312, 0.6880496701823499, 0.6297295536727926,
                    0.6727840658769578, 0.5921844643725198, 0.661462714573318,
                    0.5312162068775046, 0.5009390092195679, 0.40338269784645525,
                    0.6653313043867796, 0.5631511501301222, 0.4735258581202969,
                    0.38453931527612273, 0.3228209534042863, 0.5566742860441405,
                    0.3878452234768125, 0.41484589377146786, 1.0, 0.5688558041369559,
                    0.6867742860786251, 0.5646722738060898, 0.5737333823977263,
                    0.45768855025323635, 0.5396044369339867, 0.46750667107870936,
                    0.489856930693009, 0.493135659289897, 0.41259779982622646,
                    0.4420934521097741, 0.555723739268913, 0.5274772847842186,
                    0.4791919247323375, 0.3463063905517877, 0.3220795075522375,
                    0.5169382523968307, 0.33738116567606546, 0.3882170930243358,
                    0.5688558041369559, 1.0, 0.590210223369784, 0.4853421534500108,
                    0.6208868366197411, 0.5711000320858884, 0.5704552136442572,
                    0.5588826376470462, 0.5652384340822597, 0.6002668814955313,
                    0.49618116662402145, 0.457306500190819, 0.908212965735903,
                    0.6526959099940528, 0.5009036738007585, 0.4094803063327712,
                    0.34711088459227263, 0.6301979602528923, 0.43188248345450714,
                    0.45232500980660056, 0.6867742860786251, 0.590210223369784, 1.0,
                    0.5239670191771545, 0.5902122700878208, 0.5045774438131186,
                    0.5756661370497191, 0.47602437976339174, 0.5893570224901657,
                    0.4558823477901967, 0.37250564214243065, 0.40469355110179,
                    0.500068529998474, 0.4981230007813101, 0.40981609743602093,
                    0.37518695338920144, 0.3468594087914197, 0.43447495745120857,
                    0.3229944125335375, 0.3882567604349312, 0.5646722738060898,
                    0.4853421534500108, 0.5239670191771545, 1.0], (20, 20))
    distt = reshape([0.0, 0.4349945369093768, 0.3659894963506628, 0.4504005825187306,
                     0.3846185740882162, 0.48772630886063617, 0.5243636382043096,
                     0.5379248920863896, 0.4558309824773095, 0.4635662334465028,
                     0.5094388322267412, 0.5719171040670298, 0.5941661862908173,
                     0.49119830685727883, 0.5740858076976207, 0.5528323120746474,
                     0.39493691256810254, 0.4616636316639387, 0.4353809615614002,
                     0.45265203518385905, 0.4349945369093768, 0.0, 0.43317516560747077,
                     0.478942304172808, 0.45368412259712937, 0.513054341054072,
                     0.521128769117961, 0.555225360267109, 0.4732601862123325,
                     0.48589946846416526, 0.5278497448310437, 0.5717986039213397,
                     0.5816515604193675, 0.49948868435921606, 0.5594611853469732,
                     0.5401411082180156, 0.43027342837270777, 0.520726151516689,
                     0.46308744741901153, 0.4977060157296079, 0.3659894963506628,
                     0.43317516560747077, 0.0, 0.4402239458935564, 0.3959228052666295,
                     0.49658939248219974, 0.5222660938825114, 0.5591943796803555,
                     0.4690658849949847, 0.47615824105795884, 0.5322645741731374,
                     0.5635855852049008, 0.5880747331152609, 0.5336035183073539,
                     0.5797927837674873, 0.5498232314988725, 0.4044848168491879,
                     0.4797893095234685, 0.46343542503553975, 0.4606158176562551,
                     0.4504005825187306, 0.478942304172808, 0.4402239458935564, 0.0,
                     0.4485409753251203, 0.5104232456241244, 0.5013079614291378,
                     0.568703575201822, 0.4785296025026311, 0.48058333852340496,
                     0.5349356527430881, 0.5740800544007778, 0.5741539162183379,
                     0.5182709350632089, 0.538398797040227, 0.5581864680025366,
                     0.4515614773358552, 0.5159909538554386, 0.4696367544991309,
                     0.5118474480920112, 0.3846185740882162, 0.45368412259712937,
                     0.3959228052666295, 0.4485409753251203, 0.0, 0.516459843156739,
                     0.5178404412183473, 0.5542668507454954, 0.470497802185926,
                     0.4903488416446244, 0.5367080630396269, 0.5679092404965663,
                     0.5899917750206511, 0.5249449470324288, 0.5616269950387647,
                     0.5600125561820527, 0.4114227056366007, 0.5050460718127561,
                     0.46624112105097526, 0.4531241427632356, 0.48772630886063617,
                     0.513054341054072, 0.49658939248219974, 0.5104232456241244,
                     0.516459843156739, 0.0, 0.5496380111155533, 0.5533192320487754,
                     0.46060646191447624, 0.4721473649722369, 0.4980452076713255,
                     0.5440672765702435, 0.539779699990803, 0.49674337205341235,
                     0.553349446758996, 0.5703622035971172, 0.48414036865484344,
                     0.5034204707350025, 0.44706437931491966, 0.5215925863208771,
                     0.5243636382043096, 0.521128769117961, 0.5222660938825114,
                     0.5013079614291378, 0.5178404412183473, 0.5496380111155533, 0.0,
                     0.5964826969000108, 0.49976505383475156, 0.506802358771214,
                     0.5432340877122777, 0.5911032280535289, 0.5755312324557156,
                     0.5482368682956889, 0.5541462142601811, 0.5593731752756433,
                     0.49953027474840406, 0.5419419711434857, 0.5019057846727704,
                     0.5601313943431351, 0.5379248920863896, 0.555225360267109,
                     0.5591943796803555, 0.568703575201822, 0.5542668507454954,
                     0.5533192320487754, 0.5964826969000108, 0.0, 0.5508852917459578,
                     0.5458868792365672, 0.537343281342561, 0.5936475029976264,
                     0.5570586825577714, 0.5484178499683701, 0.6066958867934736,
                     0.5414208347135955, 0.5461763919072047, 0.5281602729712951,
                     0.5209095409997695, 0.5455760482729287, 0.4558309824773095,
                     0.4732601862123325, 0.4690658849949847, 0.4785296025026311,
                     0.470497802185926, 0.46060646191447624, 0.49976505383475156,
                     0.5508852917459578, 0.0, 0.4266788716877005, 0.5200137324982005,
                     0.5502029034930044, 0.5566588881178272, 0.4512351161641699,
                     0.5298840232307682, 0.5201923752776376, 0.4090652121686837,
                     0.4713153194683401, 0.21422772260388823, 0.4999657338265924,
                     0.4635662334465028, 0.48589946846416526, 0.47615824105795884,
                     0.48058333852340496, 0.4903488416446244, 0.4721473649722369,
                     0.506802358771214, 0.5458868792365672, 0.4266788716877005, 0.0,
                     0.4969366807592751, 0.5402505943567626, 0.5337105906171405,
                     0.48074761877054617, 0.5329313714716833, 0.5191940201163467,
                     0.4673589893592921, 0.4860672356864744, 0.41671578444183466,
                     0.5009376204771857, 0.5094388322267412, 0.5278497448310437,
                     0.5322645741731374, 0.5349356527430881, 0.5367080630396269,
                     0.4980452076713255, 0.5432340877122777, 0.537343281342561,
                     0.5200137324982005, 0.4969366807592751, 0.0, 0.5889225642830309,
                     0.5685619021177527, 0.4988613322856974, 0.5610690069305133,
                     0.573737741809675, 0.513066341655591, 0.5102979890552493,
                     0.4995479587583366, 0.5432236659811404, 0.5719171040670298,
                     0.5717986039213397, 0.5635855852049008, 0.5740800544007778,
                     0.5679092404965663, 0.5440672765702435, 0.5911032280535289,
                     0.5936475029976264, 0.5502029034930044, 0.5402505943567626,
                     0.5889225642830309, 0.0, 0.5801346159804058, 0.5768483556919259,
                     0.5836370677275022, 0.5699101549855419, 0.5547344791537107,
                     0.5717051729030499, 0.5433781803068783, 0.5589333800243096,
                     0.5941661862908173, 0.5816515604193675, 0.5880747331152609,
                     0.5741539162183379, 0.5899917750206511, 0.539779699990803,
                     0.5755312324557156, 0.5570586825577714, 0.5566588881178272,
                     0.5337105906171405, 0.5685619021177527, 0.5801346159804058, 0.0,
                     0.5685577312090584, 0.5389138568467741, 0.5500972191483263,
                     0.5818844587182724, 0.582202925296568, 0.5713532687434839,
                     0.5714632933131315, 0.49119830685727883, 0.49948868435921606,
                     0.5336035183073539, 0.5182709350632089, 0.5249449470324288,
                     0.49674337205341235, 0.5482368682956889, 0.5484178499683701,
                     0.4512351161641699, 0.48074761877054617, 0.4988613322856974,
                     0.5768483556919259, 0.5685577312090584, 0.0, 0.4912693905568092,
                     0.560185224536297, 0.4708108505312189, 0.4914579064391829,
                     0.4300011858978459, 0.5317541925310939, 0.5740858076976207,
                     0.5594611853469732, 0.5797927837674873, 0.538398797040227,
                     0.5616269950387647, 0.553349446758996, 0.5541462142601811,
                     0.6066958867934736, 0.5298840232307682, 0.5329313714716833,
                     0.5610690069305133, 0.5836370677275022, 0.5389138568467741,
                     0.4912693905568092, 0.0, 0.5689405250069103, 0.5532426124781006,
                     0.5755948376783511, 0.532971629894825, 0.5818099292150584,
                     0.5528323120746474, 0.5401411082180156, 0.5498232314988725,
                     0.5581864680025366, 0.5600125561820527, 0.5703622035971172,
                     0.5593731752756433, 0.5414208347135955, 0.5201923752776376,
                     0.5191940201163467, 0.573737741809675, 0.5699101549855419,
                     0.5500972191483263, 0.560185224536297, 0.5689405250069103, 0.0,
                     0.5409039222581641, 0.5530745460494744, 0.523294845280077,
                     0.5530566153501234, 0.39493691256810254, 0.43027342837270777,
                     0.4044848168491879, 0.4515614773358552, 0.4114227056366007,
                     0.48414036865484344, 0.49953027474840406, 0.5461763919072047,
                     0.4090652121686837, 0.4673589893592921, 0.513066341655591,
                     0.5547344791537107, 0.5818844587182724, 0.4708108505312189,
                     0.5532426124781006, 0.5409039222581641, 0.0, 0.4642974239983699,
                     0.39574342314268146, 0.4665445992581579, 0.4616636316639387,
                     0.520726151516689, 0.4797893095234685, 0.5159909538554386,
                     0.5050460718127561, 0.5034204707350025, 0.5419419711434857,
                     0.5281602729712951, 0.4713153194683401, 0.4860672356864744,
                     0.5102979890552493, 0.5717051729030499, 0.582202925296568,
                     0.4914579064391829, 0.5755948376783511, 0.5530745460494744,
                     0.4642974239983699, 0.0, 0.45265316558608976, 0.5072759833414101,
                     0.4353809615614002, 0.46308744741901153, 0.46343542503553975,
                     0.4696367544991309, 0.46624112105097526, 0.44706437931491966,
                     0.5019057846727704, 0.5209095409997695, 0.21422772260388823,
                     0.41671578444183466, 0.4995479587583366, 0.5433781803068783,
                     0.5713532687434839, 0.4300011858978459, 0.532971629894825,
                     0.523294845280077, 0.39574342314268146, 0.45265316558608976, 0.0,
                     0.4878693374372105, 0.45265203518385905, 0.4977060157296079,
                     0.4606158176562551, 0.5118474480920112, 0.4531241427632356,
                     0.5215925863208771, 0.5601313943431351, 0.5455760482729287,
                     0.4999657338265924, 0.5009376204771857, 0.5432236659811404,
                     0.5589333800243096, 0.5714632933131315, 0.5317541925310939,
                     0.5818099292150584, 0.5530566153501234, 0.4665445992581579,
                     0.5072759833414101, 0.4878693374372105, 0.0], (20, 20))
    @test isapprox(portfolio.cov, covt)
    @test isapprox(portfolio.cor, cort)
    @test isapprox(portfolio.dist, distt)

    c1 = PortCovCor(; ce = CovSemi(; ce = AnalyticalNonlinearShrinkage(), absolute = true))
    asset_statistics!(portfolio; set_kurt = false, set_skurt = false, set_mu = false,
                      set_skew = false, set_sskew = false, set_cov = false, cor_type = c1)
    cort = reshape([1.0, 0.6215595057179937, 0.7321033771219764, 0.5942786305335763,
                    0.7041371049326947, 0.5242460952903587, 0.4500855498582797,
                    0.4212736209476922, 0.5844362308275415, 0.570212694416445,
                    0.4809441524389085, 0.34582165215116445, 0.2939330861372515,
                    0.5174484466810851, 0.34085097080034094, 0.38875286945239923,
                    0.6880496701823499, 0.5737333823977263, 0.6208868366197411,
                    0.5902122700878208, 0.6215595057179937, 1.0, 0.6247185518018805,
                    0.5412285385472829, 0.5883414338065458, 0.47355048625114404,
                    0.4568496119951978, 0.38344959863251804, 0.5520495922925367,
                    0.5278034130924834, 0.44274929376360406, 0.34609271310721357,
                    0.3233629245234297, 0.5010221083941988, 0.37400636418031935,
                    0.4164951664260278, 0.6297295536727926, 0.45768855025323635,
                    0.5711000320858884, 0.5045774438131186, 0.7321033771219764,
                    0.6247185518018805, 1.0, 0.6124057549238142, 0.6864902645396052,
                    0.5067979505483196, 0.4544762543614076, 0.3746032914678051,
                    0.5599543910677436, 0.5465466589451815, 0.4333888461605773,
                    0.364742576298499, 0.30833621654282917, 0.43053457050002697,
                    0.32768065578229544, 0.39538882820827476, 0.6727840658769578,
                    0.5396044369339867, 0.5704552136442572, 0.5756661370497191,
                    0.5942786305335763, 0.5412285385472829, 0.6124057549238142, 1.0,
                    0.5976219869087797, 0.4789362206530695, 0.4973806556155242,
                    0.35315248710533115, 0.5420188390573477, 0.5380793094673967,
                    0.42768769484865266, 0.3408641822784, 0.3406945609822915,
                    0.4627904757374142, 0.42025347069127306, 0.3768557338777063,
                    0.5921844643725198, 0.46750667107870936, 0.5588826376470462,
                    0.47602437976339174, 0.7041371049326947, 0.5883414338065458,
                    0.6864902645396052, 0.5976219869087797, 1.0, 0.46653846081303313,
                    0.4636825548775748, 0.3855765163293415, 0.5572636362764265,
                    0.5191160269955502, 0.42388891013650376, 0.3549581891172263,
                    0.30381941081596264, 0.44886560517024104, 0.3691502368874548,
                    0.37277187383688665, 0.661462714573318, 0.489856930693009,
                    0.5652384340822597, 0.5893570224901657, 0.5242460952903587,
                    0.47355048625114404, 0.5067979505483196, 0.4789362206530695,
                    0.46653846081303313, 1.0, 0.3957961134738778, 0.38767565488990685,
                    0.5756833744852563, 0.5541537314995466, 0.5039019422312525,
                    0.4079815971308765, 0.4172757509556774, 0.5064920446420104,
                    0.38760877954302614, 0.3493739134156813, 0.5312162068775046,
                    0.493135659289897, 0.6002668814955313, 0.4558823477901967,
                    0.4500855498582797, 0.4568496119951978, 0.4544762543614076,
                    0.4973806556155242, 0.4636825548775748, 0.3957961134738778, 1.0,
                    0.28841678459777975, 0.5004697819310957, 0.4863027382878672,
                    0.4097934518948187, 0.3011939475693957, 0.33752760093601025,
                    0.398872672482671, 0.38584394644221903, 0.37420330156408876,
                    0.5009390092195679, 0.41259779982622646, 0.49618116662402145,
                    0.37250564214243065, 0.4212736209476922, 0.38344959863251804,
                    0.3746032914678051, 0.35315248710533115, 0.3855765163293415,
                    0.38767565488990685, 0.28841678459777975, 1.0, 0.393050790675942,
                    0.40401503015472295, 0.42252439599201863, 0.29516528436936645,
                    0.37937124837400027, 0.39847572367214085, 0.26384020189576135,
                    0.41372695947606697, 0.40338269784645525, 0.4420934521097741,
                    0.457306500190819, 0.40469355110179, 0.5844362308275415,
                    0.5520495922925367, 0.5599543910677436, 0.5420188390573477,
                    0.5572636362764265, 0.5756833744852563, 0.5004697819310957,
                    0.393050790675942, 1.0, 0.6358902809106216, 0.45917143602658,
                    0.3945535299757354, 0.3802617645588489, 0.5927737398806162,
                    0.43844584384954927, 0.45879978540601885, 0.6653313043867796,
                    0.555723739268913, 0.908212965735903, 0.500068529998474,
                    0.570212694416445, 0.5278034130924834, 0.5465466589451815,
                    0.5380793094673967, 0.5191160269955502, 0.5541537314995466,
                    0.4863027382878672, 0.40401503015472295, 0.6358902809106216, 1.0,
                    0.5061078706319085, 0.41625859059432957, 0.4303060109262059,
                    0.5377634540928992, 0.4319683066026213, 0.46087513895085297,
                    0.5631511501301222, 0.5274772847842186, 0.6526959099940528,
                    0.4981230007813101, 0.4809441524389085, 0.44274929376360406,
                    0.4333888461605773, 0.42768769484865266, 0.42388891013650376,
                    0.5039019422312525, 0.4097934518948187, 0.42252439599201863,
                    0.45917143602658, 0.5061078706319085, 1.0, 0.3063404265565985,
                    0.3534747269204858, 0.502274742300278, 0.3704031389240152,
                    0.3416500072462695, 0.4735258581202969, 0.4791919247323375,
                    0.5009036738007585, 0.40981609743602093, 0.34582165215116445,
                    0.34609271310721357, 0.364742576298499, 0.3408641822784,
                    0.3549581891172263, 0.4079815971308765, 0.3011939475693957,
                    0.29516528436936645, 0.3945535299757354, 0.41625859059432957,
                    0.3063404265565985, 1.0, 0.326887654682534, 0.3344919490710425,
                    0.31873554634888596, 0.35040483048871124, 0.38453931527612273,
                    0.3463063905517877, 0.4094803063327712, 0.37518695338920144,
                    0.2939330861372515, 0.3233629245234297, 0.30833621654282917,
                    0.3406945609822915, 0.30381941081596264, 0.4172757509556774,
                    0.33752760093601025, 0.37937124837400027, 0.3802617645588489,
                    0.4303060109262059, 0.3534747269204858, 0.326887654682534, 1.0,
                    0.3534842125648164, 0.41914370979706933, 0.3947860989705566,
                    0.3228209534042863, 0.3220795075522375, 0.34711088459227263,
                    0.3468594087914197, 0.5174484466810851, 0.5010221083941988,
                    0.43053457050002697, 0.4627904757374142, 0.44886560517024104,
                    0.5064920446420104, 0.398872672482671, 0.39847572367214085,
                    0.5927737398806162, 0.5377634540928992, 0.502274742300278,
                    0.3344919490710425, 0.3534842125648164, 1.0, 0.5173087718038826,
                    0.372385028422437, 0.5566742860441405, 0.5169382523968307,
                    0.6301979602528923, 0.43447495745120857, 0.34085097080034094,
                    0.37400636418031935, 0.32768065578229544, 0.42025347069127306,
                    0.3691502368874548, 0.38760877954302614, 0.38584394644221903,
                    0.26384020189576135, 0.43844584384954927, 0.4319683066026213,
                    0.3704031389240152, 0.31873554634888596, 0.41914370979706933,
                    0.5173087718038826, 1.0, 0.35261335800972265, 0.3878452234768125,
                    0.33738116567606546, 0.43188248345450714, 0.3229944125335375,
                    0.38875286945239923, 0.4164951664260278, 0.39538882820827476,
                    0.3768557338777063, 0.37277187383688665, 0.3493739134156813,
                    0.37420330156408876, 0.41372695947606697, 0.45879978540601885,
                    0.46087513895085297, 0.3416500072462695, 0.35040483048871124,
                    0.3947860989705566, 0.372385028422437, 0.35261335800972265, 1.0,
                    0.41484589377146786, 0.3882170930243358, 0.45232500980660056,
                    0.3882567604349312, 0.6880496701823499, 0.6297295536727926,
                    0.6727840658769578, 0.5921844643725198, 0.661462714573318,
                    0.5312162068775046, 0.5009390092195679, 0.40338269784645525,
                    0.6653313043867796, 0.5631511501301222, 0.4735258581202969,
                    0.38453931527612273, 0.3228209534042863, 0.5566742860441405,
                    0.3878452234768125, 0.41484589377146786, 1.0, 0.5688558041369559,
                    0.6867742860786251, 0.5646722738060898, 0.5737333823977263,
                    0.45768855025323635, 0.5396044369339867, 0.46750667107870936,
                    0.489856930693009, 0.493135659289897, 0.41259779982622646,
                    0.4420934521097741, 0.555723739268913, 0.5274772847842186,
                    0.4791919247323375, 0.3463063905517877, 0.3220795075522375,
                    0.5169382523968307, 0.33738116567606546, 0.3882170930243358,
                    0.5688558041369559, 1.0, 0.590210223369784, 0.4853421534500108,
                    0.6208868366197411, 0.5711000320858884, 0.5704552136442572,
                    0.5588826376470462, 0.5652384340822597, 0.6002668814955313,
                    0.49618116662402145, 0.457306500190819, 0.908212965735903,
                    0.6526959099940528, 0.5009036738007585, 0.4094803063327712,
                    0.34711088459227263, 0.6301979602528923, 0.43188248345450714,
                    0.45232500980660056, 0.6867742860786251, 0.590210223369784, 1.0,
                    0.5239670191771545, 0.5902122700878208, 0.5045774438131186,
                    0.5756661370497191, 0.47602437976339174, 0.5893570224901657,
                    0.4558823477901967, 0.37250564214243065, 0.40469355110179,
                    0.500068529998474, 0.4981230007813101, 0.40981609743602093,
                    0.37518695338920144, 0.3468594087914197, 0.43447495745120857,
                    0.3229944125335375, 0.3882567604349312, 0.5646722738060898,
                    0.4853421534500108, 0.5239670191771545, 1.0], (20, 20))
    distt = reshape([0.0, 0.6151751736554445, 0.5175873094252057, 0.6369626122987312,
                     0.5439328038161565, 0.6897491607168806, 0.7415621687638335,
                     0.7607406779266558, 0.6446423575692638, 0.6555816543982566,
                     0.7204553057345692, 0.8088129251247383, 0.8402778789559728,
                     0.6946593073722649, 0.8118799352118878, 0.7818229534540418,
                     0.5585251380355679, 0.6528909691535592, 0.6157216606391713,
                     0.6401466471927969, 0.6151751736554445, 0.0, 0.6126021940852967,
                     0.6773267021554052, 0.6416062392101983, 0.7255684073530599,
                     0.7369873730294177, 0.7852072346632333, 0.6692909738726971,
                     0.6871656182519005, 0.7464922680352396, 0.8086453406115603,
                     0.8225795253205432, 0.7063836716726974, 0.7911975959390174,
                     0.7638748808371514, 0.6084985179334519, 0.7364179857572488,
                     0.6549045487047036, 0.7038625975194884, 0.5175873094252057,
                     0.6126021940852967, 0.0, 0.622570674764067, 0.5599194008608693,
                     0.7022834537789427, 0.7385957931362678, 0.7908202757467685,
                     0.6633593362064458, 0.673389442339883, 0.7527357795663913,
                     0.7970303781547482, 0.8316632632605403, 0.7546293325202599,
                     0.8199508181700318, 0.7775674708935073, 0.5720279137621189,
                     0.6785245486097119, 0.6553966633694002, 0.6514091363730484,
                     0.6369626122987312, 0.6773267021554052, 0.622570674764067, 0.0,
                     0.6343327305848409, 0.7218474765121303, 0.7089565179786951,
                     0.8042683090204841, 0.6767430538562271, 0.6796474751903396,
                     0.7565132551061794, 0.8118717988214642, 0.8119762552055992,
                     0.7329457853501757, 0.7614108807396484, 0.789394873382323,
                     0.6386043654935974, 0.729721405004191, 0.6641666676015545,
                     0.723861602957781, 0.5439328038161565, 0.6416062392101983,
                     0.5599194008608693, 0.6343327305848409, 0.0, 0.7303845146133418,
                     0.7323369751162543, 0.7838516974981037, 0.6653843729180702,
                     0.6934579821477649, 0.7590198217856344, 0.8031449501072478,
                     0.8343743699227807, 0.7423842635924868, 0.794260513378668,
                     0.7919773520518838, 0.5818395701795144, 0.7142430043808558,
                     0.6593645167263251, 0.6408143081344503, 0.6897491607168806,
                     0.7255684073530599, 0.7022834537789427, 0.7218474765121303,
                     0.7303845146133418, 0.0, 0.7773055297153895, 0.7825115622852439,
                     0.6513959053561388, 0.6677172069824571, 0.7043422873637132,
                     0.7694273213690319, 0.763363772420674, 0.70250121377688,
                     0.782554292338221, 0.8066139637920476, 0.6846778754439896,
                     0.7119440572896883, 0.6322445084810692, 0.7376433096082436,
                     0.7415621687638335, 0.7369873730294177, 0.7385957931362678,
                     0.7089565179786951, 0.7323369751162543, 0.7773055297153895, 0.0,
                     0.8435539196768753, 0.7067745171332257, 0.7167267692169261,
                     0.7682490143860786, 0.8359462018758171, 0.8139240745081754,
                     0.7753240145367155, 0.7836810917444551, 0.7910731309025173,
                     0.7064424893651514, 0.7664216856103261, 0.7098019677177421,
                     0.792145414591014, 0.7607406779266558, 0.7852072346632333,
                     0.7908202757467685, 0.8042683090204841, 0.7838516974981037,
                     0.7825115622852439, 0.8435539196768753, 0.0, 0.7790694508989927,
                     0.7720006281378773, 0.7599181561247115, 0.8395443500081659,
                     0.7877999439108889, 0.7755799612727622, 0.8579975513393023,
                     0.7656846874033286, 0.7724100608831715, 0.7469314211426815,
                     0.7366773376514177, 0.7715610467734941, 0.6446423575692638,
                     0.6692909738726971, 0.6633593362064458, 0.6767430538562271,
                     0.6653843729180702, 0.6513959053561388, 0.7067745171332257,
                     0.7790694508989927, 0.0, 0.6034150471187957, 0.7354104731192098,
                     0.7781044081768619, 0.7872345491917584, 0.6381428210983681,
                     0.7493691721377727, 0.7356631121607099, 0.5785055709439801,
                     0.6665405169463345, 0.30296375074272, 0.7070583214993839,
                     0.6555816543982566, 0.6871656182519005, 0.673389442339883,
                     0.6796474751903396, 0.6934579821477649, 0.6677172069824571,
                     0.7167267692169261, 0.7720006281378773, 0.6034150471187957, 0.0,
                     0.7027745935704359, 0.7640297176194591, 0.7547807556329149,
                     0.6798798025438767, 0.7536787733493485, 0.7342512247515471,
                     0.6609454212488939, 0.6874028769330118, 0.5893251140125858,
                     0.7084327767817423, 0.7204553057345692, 0.7464922680352396,
                     0.7527357795663913, 0.7565132551061794, 0.7590198217856344,
                     0.7043422873637132, 0.7682490143860786, 0.7599181561247115,
                     0.7354104731192098, 0.7027745935704359, 0.0, 0.8328622775966033,
                     0.8040679530235701, 0.7054964618619444, 0.793471399028336,
                     0.8113876957125554, 0.7255853787664848, 0.7216703369736507,
                     0.7064674983318352, 0.7682342758325608, 0.8088129251247383,
                     0.8086453406115603, 0.7970303781547482, 0.8118717988214642,
                     0.8031449501072478, 0.7694273213690319, 0.8359462018758171,
                     0.8395443500081659, 0.7781044081768619, 0.7640297176194591,
                     0.8328622775966033, 0.0, 0.8204342419215973, 0.8157867680521409,
                     0.8253874566838983, 0.8059746705147058, 0.7845130239351525,
                     0.8085132091983485, 0.7684527920876004, 0.7904511664934138,
                     0.8402778789559728, 0.8225795253205432, 0.8316632632605403,
                     0.8119762552055992, 0.8343743699227807, 0.763363772420674,
                     0.8139240745081754, 0.7877999439108889, 0.7872345491917584,
                     0.7547807556329149, 0.8040679530235701, 0.8204342419215973, 0.0,
                     0.804062054467927, 0.7621392853035005, 0.7779549479432877,
                     0.8229088932535081, 0.8233592730076964, 0.8080155415632346,
                     0.8081711398018246, 0.6946593073722649, 0.7063836716726974,
                     0.7546293325202599, 0.7329457853501757, 0.7423842635924868,
                     0.70250121377688, 0.7753240145367155, 0.7755799612727622,
                     0.6381428210983681, 0.6798798025438767, 0.7054964618619444,
                     0.8157867680521409, 0.804062054467927, 0.0, 0.6947598349042045,
                     0.7922215419802487, 0.6658270901336619, 0.6950264366217801,
                     0.6081135089332481, 0.752013990926227, 0.8118799352118878,
                     0.7911975959390174, 0.8199508181700318, 0.7614108807396484,
                     0.794260513378668, 0.782554292338221, 0.7836810917444551,
                     0.8579975513393023, 0.7493691721377727, 0.7536787733493485,
                     0.793471399028336, 0.8253874566838983, 0.7621392853035005,
                     0.6947598349042045, 0.0, 0.8046034066484415, 0.7824032058492523,
                     0.8140140258766642, 0.7537357073573553, 0.822803492619266,
                     0.7818229534540418, 0.7638748808371514, 0.7775674708935073,
                     0.789394873382323, 0.7919773520518838, 0.8066139637920476,
                     0.7910731309025173, 0.7656846874033286, 0.7356631121607099,
                     0.7342512247515471, 0.8113876957125554, 0.8059746705147058,
                     0.7779549479432877, 0.7922215419802487, 0.8046034066484415, 0.0,
                     0.764953662798298, 0.7821655240265095, 0.7400506673150153,
                     0.7821401661883046, 0.5585251380355679, 0.6084985179334519,
                     0.5720279137621189, 0.6386043654935974, 0.5818395701795144,
                     0.6846778754439896, 0.7064424893651514, 0.7724100608831715,
                     0.5785055709439801, 0.6609454212488939, 0.7255853787664848,
                     0.7845130239351525, 0.8229088932535081, 0.6658270901336619,
                     0.7824032058492523, 0.764953662798298, 0.0, 0.656615713993386,
                     0.5596657162283347, 0.6597936997228074, 0.6528909691535592,
                     0.7364179857572488, 0.6785245486097119, 0.729721405004191,
                     0.7142430043808558, 0.7119440572896883, 0.7664216856103261,
                     0.7469314211426815, 0.6665405169463345, 0.6874028769330118,
                     0.7216703369736507, 0.8085132091983485, 0.8233592730076964,
                     0.6950264366217801, 0.8140140258766642, 0.7821655240265095,
                     0.656615713993386, 0.0, 0.6401482458229625, 0.7173965755075704,
                     0.6157216606391713, 0.6549045487047036, 0.6553966633694002,
                     0.6641666676015545, 0.6593645167263251, 0.6322445084810692,
                     0.7098019677177421, 0.7366773376514177, 0.30296375074272,
                     0.5893251140125858, 0.7064674983318352, 0.7684527920876004,
                     0.8080155415632346, 0.6081135089332481, 0.7537357073573553,
                     0.7400506673150153, 0.5596657162283347, 0.6401482458229625, 0.0,
                     0.689951433669679, 0.6401466471927969, 0.7038625975194884,
                     0.6514091363730484, 0.723861602957781, 0.6408143081344503,
                     0.7376433096082436, 0.792145414591014, 0.7715610467734941,
                     0.7070583214993839, 0.7084327767817423, 0.7682342758325608,
                     0.7904511664934138, 0.8081711398018246, 0.752013990926227,
                     0.822803492619266, 0.7821401661883046, 0.6597936997228074,
                     0.7173965755075704, 0.689951433669679, 0.0], (20, 20))
    @test isapprox(portfolio.cor, cort)
    @test isapprox(portfolio.dist, distt)
end
